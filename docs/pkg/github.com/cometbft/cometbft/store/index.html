<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#375EAB">

  <title>store - Go Documentation Server</title>

<link type="text/css" rel="stylesheet" href="../../../../../lib/godoc/style.css">

<script>window.initFuncs = [];</script>
<script src="../../../../../lib/godoc/jquery.js" defer></script>



<script>var goVersion = "go1.19.10";</script>
<script src="../../../../../lib/godoc/godocs.js" defer></script>
</head>
<body>

<div id='lowframe' style="position: fixed; bottom: 0; left: 0; height: 0; width: 100%; border-top: thin solid grey; background-color: white; overflow: auto;">
...
</div><!-- #lowframe -->

<div id="topbar" class="wide"><div class="container">
<div class="top-heading" id="heading-wide"><a href="http://localhost:6060/pkg/">Go Documentation Server</a></div>
<div class="top-heading" id="heading-narrow"><a href="http://localhost:6060/pkg/">GoDoc</a></div>
<a href="index.html#" id="menu-button"><span id="menu-button-arrow">&#9661;</span></a>
<form method="GET" action="http://localhost:6060/search">
<div id="menu">

<span class="search-box"><input type="search" id="search" name="q" placeholder="Search" aria-label="Search" required><button type="submit"><span><!-- magnifying glass: --><svg width="24" height="24" viewBox="0 0 24 24"><title>submit search</title><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/><path d="M0 0h24v24H0z" fill="none"/></svg></span></button></span>
</div>
</form>

</div></div>



<div id="page" class="wide">
<div class="container">


  <h1>
    Package store
    <span class="text-muted"></span>
  </h1>







<div id="nav"></div>


<!--
	Copyright 2009 The Go Authors. All rights reserved.
	Use of this source code is governed by a BSD-style
	license that can be found in the LICENSE file.
-->
<!--
	Note: Static (i.e., not template-generated) href and id
	attributes start with "pkg-" to make it impossible for
	them to conflict with generated attributes (some of which
	correspond to Go identifiers).
-->

	<script>
	document.ANALYSIS_DATA = null;
	document.CALLGRAPH = null;
	</script>

	
		
		<div id="short-nav">
			<dl>
			<dd><code>import "github.com/cometbft/cometbft/store"</code></dd>
			</dl>
			<dl>
			<dd><a href="index.html#pkg-overview" class="overviewLink">Overview</a></dd>
			<dd><a href="index.html#pkg-index" class="indexLink">Index</a></dd>
			
			
			</dl>
		</div>
		<!-- The package's Name is printed as title by the top-level template -->
		<div id="pkg-overview" class="toggleVisible">
			<div class="collapsed">
				<h2 class="toggleButton" title="Click to show Overview section">Overview ▹</h2>
			</div>
			<div class="expanded">
				<h2 class="toggleButton" title="Click to hide Overview section">Overview ▾</h2>
				
				
			</div>
		</div>

		<div id="pkg-index" class="toggleVisible">
		<div class="collapsed">
			<h2 class="toggleButton" title="Click to show Index section">Index ▹</h2>
		</div>
		<div class="expanded">
			<h2 class="toggleButton" title="Click to hide Index section">Index ▾</h2>

		<!-- Table of contents for API; must be named manual-nav to turn off auto nav. -->
			<div id="manual-nav">
			<dl>
			
			
			
				
				<dd><a href="index.html#LoadBlockStoreState">func LoadBlockStoreState(db dbm.DB) cmtstore.BlockStoreState</a></dd>
			
				
				<dd><a href="index.html#SaveBlockStoreState">func SaveBlockStoreState(bsj *cmtstore.BlockStoreState, db dbm.DB)</a></dd>
			
			
				
				<dd><a href="index.html#BlockStore">type BlockStore</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#NewBlockStore">func NewBlockStore(db dbm.DB) *BlockStore</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#BlockStore.Base">func (bs *BlockStore) Base() int64</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#BlockStore.Close">func (bs *BlockStore) Close() error</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#BlockStore.DeleteLatestBlock">func (bs *BlockStore) DeleteLatestBlock() error</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#BlockStore.Height">func (bs *BlockStore) Height() int64</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#BlockStore.LoadBaseMeta">func (bs *BlockStore) LoadBaseMeta() *types.BlockMeta</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#BlockStore.LoadBlock">func (bs *BlockStore) LoadBlock(height int64) *types.Block</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#BlockStore.LoadBlockByHash">func (bs *BlockStore) LoadBlockByHash(hash []byte) *types.Block</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#BlockStore.LoadBlockCommit">func (bs *BlockStore) LoadBlockCommit(height int64) *types.Commit</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#BlockStore.LoadBlockMeta">func (bs *BlockStore) LoadBlockMeta(height int64) *types.BlockMeta</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#BlockStore.LoadBlockMetaByHash">func (bs *BlockStore) LoadBlockMetaByHash(hash []byte) *types.BlockMeta</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#BlockStore.LoadBlockPart">func (bs *BlockStore) LoadBlockPart(height int64, index int) *types.Part</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#BlockStore.LoadSeenCommit">func (bs *BlockStore) LoadSeenCommit(height int64) *types.Commit</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#BlockStore.PruneBlocks">func (bs *BlockStore) PruneBlocks(height int64) (uint64, error)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#BlockStore.SaveBlock">func (bs *BlockStore) SaveBlock(block *types.Block, blockParts *types.PartSet, seenCommit *types.Commit)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#BlockStore.SaveSeenCommit">func (bs *BlockStore) SaveSeenCommit(height int64, seenCommit *types.Commit) error</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#BlockStore.Size">func (bs *BlockStore) Size() int64</a></dd>
				
			
			
			</dl>
			</div><!-- #manual-nav -->

		

		
			<h3>Package files</h3>
			<p>
			<span style="font-size:90%">
			
				<a href="http://localhost:6060/src/github.com/cometbft/cometbft/store/store.go">store.go</a>
			
			</span>
			</p>
		
		</div><!-- .expanded -->
		</div><!-- #pkg-index -->

		

		
		
		
			
			
			<h2 id="LoadBlockStoreState">func <a href="http://localhost:6060/src/github.com/cometbft/cometbft/store/store.go?s=13870:13930#L479">LoadBlockStoreState</a>
				<a class="permalink" href="index.html#LoadBlockStoreState">&#xb6;</a>
				
				
			</h2>
			<pre>func LoadBlockStoreState(db <a href="../../cometbft-db/index.html">dbm</a>.<a href="../../cometbft-db/index.html#DB">DB</a>) <a href="../proto/tendermint/store/index.html">cmtstore</a>.<a href="../proto/tendermint/store/index.html#BlockStoreState">BlockStoreState</a></pre>
			<p>LoadBlockStoreState returns the BlockStoreState as loaded from disk.
If no BlockStoreState was previously persisted, it returns the zero value.

			
			

		
			
			
			<h2 id="SaveBlockStoreState">func <a href="http://localhost:6060/src/github.com/cometbft/cometbft/store/store.go?s=13457:13523#L467">SaveBlockStoreState</a>
				<a class="permalink" href="index.html#SaveBlockStoreState">&#xb6;</a>
				
				
			</h2>
			<pre>func SaveBlockStoreState(bsj *<a href="../proto/tendermint/store/index.html">cmtstore</a>.<a href="../proto/tendermint/store/index.html#BlockStoreState">BlockStoreState</a>, db <a href="../../cometbft-db/index.html">dbm</a>.<a href="../../cometbft-db/index.html#DB">DB</a>)</pre>
			<p>SaveBlockStoreState persists the blockStore state to the database.

			
			

		
		
			
			
			<h2 id="BlockStore">type <a href="http://localhost:6060/src/github.com/cometbft/cometbft/store/store.go?s=1048:1595#L24">BlockStore</a>
				<a class="permalink" href="index.html#BlockStore">&#xb6;</a>
				
				
			</h2>
			<p>BlockStore is a simple low level store for blocks.
<p>There are three types of information stored:
<ul>
<li>BlockMeta:   Meta information about each block
<li>Block part:  Parts of each block, aggregated w/ PartSet
<li>Commit:      The commit part of each block, for gossiping precommit votes
</ul>
<p>Currently the precommit signatures are duplicated in the Block parts as
well as the Commit.  In the future this may change, perhaps by moving
the Commit data outside the Block. (TODO)
<p>The store can be assumed to contain all contiguous blocks between base and height (inclusive).
<p>// NOTE: BlockStore methods will panic if they encounter errors
// deserializing loaded data, indicating probable corruption on disk.

			<pre>type BlockStore struct {
    <span class="comment">// contains filtered or unexported fields</span>
}
</pre>

			

			

			
			
			

			
				
				<h3 id="NewBlockStore">func <a href="http://localhost:6060/src/github.com/cometbft/cometbft/store/store.go?s=1722:1763#L39">NewBlockStore</a>
					<a class="permalink" href="index.html#NewBlockStore">&#xb6;</a>
					
					
				</h3>
				<pre>func NewBlockStore(db <a href="../../cometbft-db/index.html">dbm</a>.<a href="../../cometbft-db/index.html#DB">DB</a>) *<a href="index.html#BlockStore">BlockStore</a></pre>
				<p>NewBlockStore returns a new BlockStore with the given DB,
initialized to the last height that was committed to the DB.

				
				
			

			
				
				<h3 id="BlockStore.Base">func (*BlockStore) <a href="http://localhost:6060/src/github.com/cometbft/cometbft/store/store.go?s=1964:1998#L49">Base</a>
					<a class="permalink" href="index.html#BlockStore.Base">&#xb6;</a>
					
					
				</h3>
				<pre>func (bs *<a href="index.html#BlockStore">BlockStore</a>) Base() <a href="../../../../builtin/index.html#int64">int64</a></pre>
				<p>Base returns the first known contiguous block height, or 0 for empty block stores.

				
				
				
			
				
				<h3 id="BlockStore.Close">func (*BlockStore) <a href="http://localhost:6060/src/github.com/cometbft/cometbft/store/store.go?s=12629:12664#L436">Close</a>
					<a class="permalink" href="index.html#BlockStore.Close">&#xb6;</a>
					
					
				</h3>
				<pre>func (bs *<a href="index.html#BlockStore">BlockStore</a>) Close() <a href="../../../../builtin/index.html#error">error</a></pre>
				
				
				
				
			
				
				<h3 id="BlockStore.DeleteLatestBlock">func (*BlockStore) <a href="http://localhost:6060/src/github.com/cometbft/cometbft/store/store.go?s=14785:14832#L517">DeleteLatestBlock</a>
					<a class="permalink" href="index.html#BlockStore.DeleteLatestBlock">&#xb6;</a>
					
					
				</h3>
				<pre>func (bs *<a href="index.html#BlockStore">BlockStore</a>) DeleteLatestBlock() <a href="../../../../builtin/index.html#error">error</a></pre>
				<p>DeleteLatestBlock removes the block pointed to by height,
lowering height by one.

				
				
				
			
				
				<h3 id="BlockStore.Height">func (*BlockStore) <a href="http://localhost:6060/src/github.com/cometbft/cometbft/store/store.go?s=2147:2183#L56">Height</a>
					<a class="permalink" href="index.html#BlockStore.Height">&#xb6;</a>
					
					
				</h3>
				<pre>func (bs *<a href="index.html#BlockStore">BlockStore</a>) Height() <a href="../../../../builtin/index.html#int64">int64</a></pre>
				<p>Height returns the last known contiguous block height, or 0 for empty block stores.

				
				
				
			
				
				<h3 id="BlockStore.LoadBaseMeta">func (*BlockStore) <a href="http://localhost:6060/src/github.com/cometbft/cometbft/store/store.go?s=2537:2590#L73">LoadBaseMeta</a>
					<a class="permalink" href="index.html#BlockStore.LoadBaseMeta">&#xb6;</a>
					
					
				</h3>
				<pre>func (bs *<a href="index.html#BlockStore">BlockStore</a>) LoadBaseMeta() *<a href="../types/index.html">types</a>.<a href="../types/index.html#BlockMeta">BlockMeta</a></pre>
				<p>LoadBase atomically loads the base block meta, or returns nil if no base is found.

				
				
				
			
				
				<h3 id="BlockStore.LoadBlock">func (*BlockStore) <a href="http://localhost:6060/src/github.com/cometbft/cometbft/store/store.go?s=2816:2874#L84">LoadBlock</a>
					<a class="permalink" href="index.html#BlockStore.LoadBlock">&#xb6;</a>
					
					
				</h3>
				<pre>func (bs *<a href="index.html#BlockStore">BlockStore</a>) LoadBlock(height <a href="../../../../builtin/index.html#int64">int64</a>) *<a href="../types/index.html">types</a>.<a href="../types/index.html#Block">Block</a></pre>
				<p>LoadBlock returns the block with the given height.
If no block is found for that height, it returns nil.

				
				
				
			
				
				<h3 id="BlockStore.LoadBlockByHash">func (*BlockStore) <a href="http://localhost:6060/src/github.com/cometbft/cometbft/store/store.go?s=3882:3945#L119">LoadBlockByHash</a>
					<a class="permalink" href="index.html#BlockStore.LoadBlockByHash">&#xb6;</a>
					
					
				</h3>
				<pre>func (bs *<a href="index.html#BlockStore">BlockStore</a>) LoadBlockByHash(hash []<a href="../../../../builtin/index.html#byte">byte</a>) *<a href="../types/index.html">types</a>.<a href="../types/index.html#Block">Block</a></pre>
				<p>LoadBlockByHash returns the block with the given hash.
If no block is found for that hash, it returns nil.
Panics if it fails to parse height associated with the given hash.

				
				
				
			
				
				<h3 id="BlockStore.LoadBlockCommit">func (*BlockStore) <a href="http://localhost:6060/src/github.com/cometbft/cometbft/store/store.go?s=6272:6337#L211">LoadBlockCommit</a>
					<a class="permalink" href="index.html#BlockStore.LoadBlockCommit">&#xb6;</a>
					
					
				</h3>
				<pre>func (bs *<a href="index.html#BlockStore">BlockStore</a>) LoadBlockCommit(height <a href="../../../../builtin/index.html#int64">int64</a>) *<a href="../types/index.html">types</a>.<a href="../types/index.html#Commit">Commit</a></pre>
				<p>LoadBlockCommit returns the Commit for the given height.
This commit consists of the +2/3 and other Precommit-votes for block at `height`,
and it comes from the block.LastCommit for `height+1`.
If no commit is found for the given height, it returns nil.

				
				
				
			
				
				<h3 id="BlockStore.LoadBlockMeta">func (*BlockStore) <a href="http://localhost:6060/src/github.com/cometbft/cometbft/store/store.go?s=5019:5085#L164">LoadBlockMeta</a>
					<a class="permalink" href="index.html#BlockStore.LoadBlockMeta">&#xb6;</a>
					
					
				</h3>
				<pre>func (bs *<a href="index.html#BlockStore">BlockStore</a>) LoadBlockMeta(height <a href="../../../../builtin/index.html#int64">int64</a>) *<a href="../types/index.html">types</a>.<a href="../types/index.html#BlockMeta">BlockMeta</a></pre>
				<p>LoadBlockMeta returns the BlockMeta for the given height.
If no block is found for the given height, it returns nil.

				
				
				
			
				
				<h3 id="BlockStore.LoadBlockMetaByHash">func (*BlockStore) <a href="http://localhost:6060/src/github.com/cometbft/cometbft/store/store.go?s=5631:5702#L190">LoadBlockMetaByHash</a>
					<a class="permalink" href="index.html#BlockStore.LoadBlockMetaByHash">&#xb6;</a>
					
					
				</h3>
				<pre>func (bs *<a href="index.html#BlockStore">BlockStore</a>) LoadBlockMetaByHash(hash []<a href="../../../../builtin/index.html#byte">byte</a>) *<a href="../types/index.html">types</a>.<a href="../types/index.html#BlockMeta">BlockMeta</a></pre>
				<p>LoadBlockMetaByHash returns the blockmeta who&apos;s header corresponds to the given
hash. If none is found, returns nil.

				
				
				
			
				
				<h3 id="BlockStore.LoadBlockPart">func (*BlockStore) <a href="http://localhost:6060/src/github.com/cometbft/cometbft/store/store.go?s=4408:4480#L139">LoadBlockPart</a>
					<a class="permalink" href="index.html#BlockStore.LoadBlockPart">&#xb6;</a>
					
					
				</h3>
				<pre>func (bs *<a href="index.html#BlockStore">BlockStore</a>) LoadBlockPart(height <a href="../../../../builtin/index.html#int64">int64</a>, index <a href="../../../../builtin/index.html#int">int</a>) *<a href="../types/index.html">types</a>.<a href="../types/index.html#Part">Part</a></pre>
				<p>LoadBlockPart returns the Part at the given index
from the block at the given height.
If no part is found for the given height and index, it returns nil.

				
				
				
			
				
				<h3 id="BlockStore.LoadSeenCommit">func (*BlockStore) <a href="http://localhost:6060/src/github.com/cometbft/cometbft/store/store.go?s=6964:7028#L234">LoadSeenCommit</a>
					<a class="permalink" href="index.html#BlockStore.LoadSeenCommit">&#xb6;</a>
					
					
				</h3>
				<pre>func (bs *<a href="index.html#BlockStore">BlockStore</a>) LoadSeenCommit(height <a href="../../../../builtin/index.html#int64">int64</a>) *<a href="../types/index.html">types</a>.<a href="../types/index.html#Commit">Commit</a></pre>
				<p>LoadSeenCommit returns the locally seen Commit for the given height.
This is useful when we&apos;ve seen a commit, but there has not yet been
a new block at `height + 1` that includes this commit in its block.LastCommit.

				
				
				
			
				
				<h3 id="BlockStore.PruneBlocks">func (*BlockStore) <a href="http://localhost:6060/src/github.com/cometbft/cometbft/store/store.go?s=7533:7596#L256">PruneBlocks</a>
					<a class="permalink" href="index.html#BlockStore.PruneBlocks">&#xb6;</a>
					
					
				</h3>
				<pre>func (bs *<a href="index.html#BlockStore">BlockStore</a>) PruneBlocks(height <a href="../../../../builtin/index.html#int64">int64</a>) (<a href="../../../../builtin/index.html#uint64">uint64</a>, <a href="../../../../builtin/index.html#error">error</a>)</pre>
				<p>PruneBlocks removes block up to (but not including) a height. It returns number of blocks pruned.

				
				
				
			
				
				<h3 id="BlockStore.SaveBlock">func (*BlockStore) <a href="http://localhost:6060/src/github.com/cometbft/cometbft/store/store.go?s=9777:9881#L340">SaveBlock</a>
					<a class="permalink" href="index.html#BlockStore.SaveBlock">&#xb6;</a>
					
					
				</h3>
				<pre>func (bs *<a href="index.html#BlockStore">BlockStore</a>) SaveBlock(block *<a href="../types/index.html">types</a>.<a href="../types/index.html#Block">Block</a>, blockParts *<a href="../types/index.html">types</a>.<a href="../types/index.html#PartSet">PartSet</a>, seenCommit *<a href="../types/index.html">types</a>.<a href="../types/index.html#Commit">Commit</a>)</pre>
				<p>SaveBlock persists the given block, blockParts, and seenCommit to the underlying db.
blockParts: Must be parts of the block
seenCommit: The +2/3 precommits that were seen which committed at height.
<pre>If all the nodes restart after committing a block,
we need this to reload the precommits to catch-up nodes to the
most recent height.  Otherwise they&apos;d stall at H-1.
</pre>

				
				
				
			
				
				<h3 id="BlockStore.SaveSeenCommit">func (*BlockStore) <a href="http://localhost:6060/src/github.com/cometbft/cometbft/store/store.go?s=12329:12411#L427">SaveSeenCommit</a>
					<a class="permalink" href="index.html#BlockStore.SaveSeenCommit">&#xb6;</a>
					
					
				</h3>
				<pre>func (bs *<a href="index.html#BlockStore">BlockStore</a>) SaveSeenCommit(height <a href="../../../../builtin/index.html#int64">int64</a>, seenCommit *<a href="../types/index.html">types</a>.<a href="../types/index.html#Commit">Commit</a>) <a href="../../../../builtin/index.html#error">error</a></pre>
				<p>SaveSeenCommit saves a seen commit, used by e.g. the state sync reactor when bootstrapping node.

				
				
				
			
				
				<h3 id="BlockStore.Size">func (*BlockStore) <a href="http://localhost:6060/src/github.com/cometbft/cometbft/store/store.go?s=2304:2338#L63">Size</a>
					<a class="permalink" href="index.html#BlockStore.Size">&#xb6;</a>
					
					
				</h3>
				<pre>func (bs *<a href="index.html#BlockStore">BlockStore</a>) Size() <a href="../../../../builtin/index.html#int64">int64</a></pre>
				<p>Size returns the number of blocks in the block store.

				
				
				
			
		
	

	







<div id="footer">
Build version go1.19.10.<br>
Except as <a href="https://developers.google.com/site-policies#restrictions">noted</a>,
the content of this page is licensed under the
Creative Commons Attribution 3.0 License,
and code is licensed under a <a href="http://localhost:6060/LICENSE">BSD license</a>.<br>
<a href="https://golang.org/doc/tos.html">Terms of Service</a> |
<a href="https://www.google.com/intl/en/policies/privacy/">Privacy Policy</a>
</div>

</div><!-- .container -->
</div><!-- #page -->
</body>
</html>
