<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#375EAB">

  <title>altair - Go Documentation Server</title>

<link type="text/css" rel="stylesheet" href="../../../../../../../lib/godoc/style.css">

<script>window.initFuncs = [];</script>
<script src="../../../../../../../lib/godoc/jquery.js" defer></script>



<script>var goVersion = "go1.19.10";</script>
<script src="../../../../../../../lib/godoc/godocs.js" defer></script>
</head>
<body>

<div id='lowframe' style="position: fixed; bottom: 0; left: 0; height: 0; width: 100%; border-top: thin solid grey; background-color: white; overflow: auto;">
...
</div><!-- #lowframe -->

<div id="topbar" class="wide"><div class="container">
<div class="top-heading" id="heading-wide"><a href="http://localhost:6060/pkg/">Go Documentation Server</a></div>
<div class="top-heading" id="heading-narrow"><a href="http://localhost:6060/pkg/">GoDoc</a></div>
<a href="index.html#" id="menu-button"><span id="menu-button-arrow">&#9661;</span></a>
<form method="GET" action="http://localhost:6060/search">
<div id="menu">

<span class="search-box"><input type="search" id="search" name="q" placeholder="Search" aria-label="Search" required><button type="submit"><span><!-- magnifying glass: --><svg width="24" height="24" viewBox="0 0 24 24"><title>submit search</title><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/><path d="M0 0h24v24H0z" fill="none"/></svg></span></button></span>
</div>
</form>

</div></div>



<div id="page" class="wide">
<div class="container">


  <h1>
    Package altair
    <span class="text-muted"></span>
  </h1>







<div id="nav"></div>


<!--
	Copyright 2009 The Go Authors. All rights reserved.
	Use of this source code is governed by a BSD-style
	license that can be found in the LICENSE file.
-->
<!--
	Note: Static (i.e., not template-generated) href and id
	attributes start with "pkg-" to make it impossible for
	them to conflict with generated attributes (some of which
	correspond to Go identifiers).
-->

	<script>
	document.ANALYSIS_DATA = null;
	document.CALLGRAPH = null;
	</script>

	
		
		<div id="short-nav">
			<dl>
			<dd><code>import "github.com/prysmaticlabs/prysm/beacon-chain/core/altair"</code></dd>
			</dl>
			<dl>
			<dd><a href="index.html#pkg-overview" class="overviewLink">Overview</a></dd>
			<dd><a href="index.html#pkg-index" class="indexLink">Index</a></dd>
			
			
			</dl>
		</div>
		<!-- The package's Name is printed as title by the top-level template -->
		<div id="pkg-overview" class="toggleVisible">
			<div class="collapsed">
				<h2 class="toggleButton" title="Click to show Overview section">Overview ▹</h2>
			</div>
			<div class="expanded">
				<h2 class="toggleButton" title="Click to hide Overview section">Overview ▾</h2>
				
				
			</div>
		</div>

		<div id="pkg-index" class="toggleVisible">
		<div class="collapsed">
			<h2 class="toggleButton" title="Click to show Index section">Index ▹</h2>
		</div>
		<div class="expanded">
			<h2 class="toggleButton" title="Click to hide Index section">Index ▾</h2>

		<!-- Table of contents for API; must be named manual-nav to turn off auto nav. -->
			<div id="manual-nav">
			<dl>
			
			
			
				
				<dd><a href="index.html#AddValidatorFlag">func AddValidatorFlag(flag, flagPosition uint8) (uint8, error)</a></dd>
			
				
				<dd><a href="index.html#ApplySyncRewardsPenalties">func ApplySyncRewardsPenalties(ctx context.Context, s state.BeaconStateAltair, votedIndices, didntVoteIndices []types.ValidatorIndex) (state.BeaconStateAltair, error)</a></dd>
			
				
				<dd><a href="index.html#AttestationParticipationFlagIndices">func AttestationParticipationFlagIndices(beaconState state.BeaconStateAltair, data *ethpb.AttestationData, delay types.Slot) (map[uint8]bool, error)</a></dd>
			
				
				<dd><a href="index.html#AttestationsDelta">func AttestationsDelta(beaconState state.BeaconState, bal *precompute.Balance, vals []*precompute.Validator) (rewards, penalties []uint64, err error)</a></dd>
			
				
				<dd><a href="index.html#BaseReward">func BaseReward(s state.ReadOnlyBeaconState, index types.ValidatorIndex) (uint64, error)</a></dd>
			
				
				<dd><a href="index.html#BaseRewardPerIncrement">func BaseRewardPerIncrement(activeBalance uint64) (uint64, error)</a></dd>
			
				
				<dd><a href="index.html#BaseRewardWithTotalBalance">func BaseRewardWithTotalBalance(s state.ReadOnlyBeaconState, index types.ValidatorIndex, totalBalance uint64) (uint64, error)</a></dd>
			
				
				<dd><a href="index.html#EpochParticipation">func EpochParticipation(beaconState state.BeaconState, indices []uint64, epochParticipation []byte, participatedFlags map[uint8]bool, totalBalance uint64) (uint64, []byte, error)</a></dd>
			
				
				<dd><a href="index.html#FilterSyncCommitteeVotes">func FilterSyncCommitteeVotes(s state.BeaconStateAltair, sync *ethpb.SyncAggregate) (votedKeys []bls.PublicKey, votedIndices []types.ValidatorIndex, didntVoteIndices []types.ValidatorIndex, err error)</a></dd>
			
				
				<dd><a href="index.html#HasValidatorFlag">func HasValidatorFlag(flag, flagPosition uint8) (bool, error)</a></dd>
			
				
				<dd><a href="index.html#InitializePrecomputeValidators">func InitializePrecomputeValidators(ctx context.Context, beaconState state.BeaconStateAltair) ([]*precompute.Validator, *precompute.Balance, error)</a></dd>
			
				
				<dd><a href="index.html#IsSyncCommitteeAggregator">func IsSyncCommitteeAggregator(sig []byte) (bool, error)</a></dd>
			
				
				<dd><a href="index.html#MatchingStatus">func MatchingStatus(beaconState state.BeaconState, data *ethpb.AttestationData, cp *ethpb.Checkpoint) (matchedSrc, matchedTgt, matchedHead bool, err error)</a></dd>
			
				
				<dd><a href="index.html#NextSyncCommittee">func NextSyncCommittee(ctx context.Context, s state.BeaconStateAltair) (*ethpb.SyncCommittee, error)</a></dd>
			
				
				<dd><a href="index.html#NextSyncCommitteeIndices">func NextSyncCommitteeIndices(ctx context.Context, s state.BeaconStateAltair) ([]types.ValidatorIndex, error)</a></dd>
			
				
				<dd><a href="index.html#ProcessAttestationNoVerifySignature">func ProcessAttestationNoVerifySignature(ctx context.Context, beaconState state.BeaconStateAltair, att *ethpb.Attestation, totalBalance uint64) (state.BeaconStateAltair, error)</a></dd>
			
				
				<dd><a href="index.html#ProcessAttestationsNoVerifySignature">func ProcessAttestationsNoVerifySignature(ctx context.Context, beaconState state.BeaconState, b block.SignedBeaconBlock) (state.BeaconState, error)</a></dd>
			
				
				<dd><a href="index.html#ProcessDeposit">func ProcessDeposit(ctx context.Context, beaconState state.BeaconStateAltair, deposit *ethpb.Deposit, verifySignature bool) (state.BeaconStateAltair, error)</a></dd>
			
				
				<dd><a href="index.html#ProcessDeposits">func ProcessDeposits(ctx context.Context, beaconState state.BeaconStateAltair, deposits []*ethpb.Deposit) (state.BeaconStateAltair, error)</a></dd>
			
				
				<dd><a href="index.html#ProcessEpoch">func ProcessEpoch(ctx context.Context, state state.BeaconState) (state.BeaconStateAltair, error)</a></dd>
			
				
				<dd><a href="index.html#ProcessEpochParticipation">func ProcessEpochParticipation(ctx context.Context, beaconState state.BeaconState, bal *precompute.Balance, vals []*precompute.Validator) ([]*precompute.Validator, *precompute.Balance, error)</a></dd>
			
				
				<dd><a href="index.html#ProcessInactivityScores">func ProcessInactivityScores(ctx context.Context, beaconState state.BeaconState, vals []*precompute.Validator) (state.BeaconState, []*precompute.Validator, error)</a></dd>
			
				
				<dd><a href="index.html#ProcessParticipationFlagUpdates">func ProcessParticipationFlagUpdates(beaconState state.BeaconStateAltair) (state.BeaconStateAltair, error)</a></dd>
			
				
				<dd><a href="index.html#ProcessRewardsAndPenaltiesPrecompute">func ProcessRewardsAndPenaltiesPrecompute(beaconState state.BeaconStateAltair, bal *precompute.Balance, vals []*precompute.Validator) (state.BeaconStateAltair, error)</a></dd>
			
				
				<dd><a href="index.html#ProcessSyncAggregate">func ProcessSyncAggregate(ctx context.Context, s state.BeaconStateAltair, sync *ethpb.SyncAggregate) (state.BeaconStateAltair, error)</a></dd>
			
				
				<dd><a href="index.html#ProcessSyncCommitteeUpdates">func ProcessSyncCommitteeUpdates(ctx context.Context, beaconState state.BeaconStateAltair) (state.BeaconStateAltair, error)</a></dd>
			
				
				<dd><a href="index.html#RewardProposer">func RewardProposer(ctx context.Context, beaconState state.BeaconState, proposerRewardNumerator uint64) error</a></dd>
			
				
				<dd><a href="index.html#SetParticipationAndRewardProposer">func SetParticipationAndRewardProposer(ctx context.Context, beaconState state.BeaconState, targetEpoch types.Epoch, indices []uint64, participatedFlags map[uint8]bool, totalBalance uint64) (state.BeaconState, error)</a></dd>
			
				
				<dd><a href="index.html#SyncRewards">func SyncRewards(activeBalance uint64) (proposerReward, participantReward uint64, err error)</a></dd>
			
				
				<dd><a href="index.html#SyncSubCommitteePubkeys">func SyncSubCommitteePubkeys(syncCommittee *ethpb.SyncCommittee, subComIdx types.CommitteeIndex) ([][]byte, error)</a></dd>
			
				
				<dd><a href="index.html#TranslateParticipation">func TranslateParticipation(ctx context.Context, state *statealtair.BeaconState, atts []*ethpb.PendingAttestation) (*statealtair.BeaconState, error)</a></dd>
			
				
				<dd><a href="index.html#UpgradeToAltair">func UpgradeToAltair(ctx context.Context, state state.BeaconState) (state.BeaconStateAltair, error)</a></dd>
			
				
				<dd><a href="index.html#ValidateNilSyncContribution">func ValidateNilSyncContribution(s *ethpb.SignedContributionAndProof) error</a></dd>
			
				
				<dd><a href="index.html#ValidateSyncMessageTime">func ValidateSyncMessageTime(slot types.Slot, genesisTime time.Time, clockDisparity time.Duration) error</a></dd>
			
				
				<dd><a href="index.html#VerifySyncCommitteeSig">func VerifySyncCommitteeSig(s state.BeaconStateAltair, syncKeys []bls.PublicKey, syncSig []byte) error</a></dd>
			
			
			
			</dl>
			</div><!-- #manual-nav -->

		

		
			<h3>Package files</h3>
			<p>
			<span style="font-size:90%">
			
				<a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/attestation.go">attestation.go</a>
			
				<a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/block.go">block.go</a>
			
				<a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/deposit.go">deposit.go</a>
			
				<a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/epoch_precompute.go">epoch_precompute.go</a>
			
				<a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/epoch_spec.go">epoch_spec.go</a>
			
				<a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/reward.go">reward.go</a>
			
				<a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/sync_committee.go">sync_committee.go</a>
			
				<a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/transition.go">transition.go</a>
			
				<a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/upgrade.go">upgrade.go</a>
			
			</span>
			</p>
		
		</div><!-- .expanded -->
		</div><!-- #pkg-index -->

		

		
		
		
			
			
			<h2 id="AddValidatorFlag">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/attestation.go?s=5542:5604#L143">AddValidatorFlag</a>
				<a class="permalink" href="index.html#AddValidatorFlag">&#xb6;</a>
				
				
			</h2>
			<pre>func AddValidatorFlag(flag, flagPosition <a href="../../../../../../builtin/index.html#uint8">uint8</a>) (<a href="../../../../../../builtin/index.html#uint8">uint8</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>AddValidatorFlag adds new validator flag to existing one.

			
			

		
			
			
			<h2 id="ApplySyncRewardsPenalties">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/block.go?s=5523:5689#L119">ApplySyncRewardsPenalties</a>
				<a class="permalink" href="index.html#ApplySyncRewardsPenalties">&#xb6;</a>
				
				
			</h2>
			<pre>func ApplySyncRewardsPenalties(ctx <a href="../../../../../../context/index.html">context</a>.<a href="../../../../../../context/index.html#Context">Context</a>, s <a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconStateAltair">BeaconStateAltair</a>, votedIndices, didntVoteIndices []<a href="../../../../eth2-types/index.html">types</a>.<a href="../../../../eth2-types/index.html#ValidatorIndex">ValidatorIndex</a>) (<a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconStateAltair">BeaconStateAltair</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>ApplySyncRewardsPenalties applies rewards and penalties for proposer and sync committee participants.

			
			

		
			
			
			<h2 id="AttestationParticipationFlagIndices">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/attestation.go?s=10760:10908#L259">AttestationParticipationFlagIndices</a>
				<a class="permalink" href="index.html#AttestationParticipationFlagIndices">&#xb6;</a>
				
				
			</h2>
			<pre>func AttestationParticipationFlagIndices(beaconState <a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconStateAltair">BeaconStateAltair</a>, data *<a href="../../../proto/prysm/v1alpha1/index.html">ethpb</a>.<a href="../../../proto/prysm/v1alpha1/index.html#AttestationData">AttestationData</a>, delay <a href="../../../../eth2-types/index.html">types</a>.<a href="../../../../eth2-types/index.html#Slot">Slot</a>) (map[<a href="../../../../../../builtin/index.html#uint8">uint8</a>]<a href="../../../../../../builtin/index.html#bool">bool</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>AttestationParticipationFlagIndices retrieves a map of attestation scoring based on Altair&apos;s participation flag indices.
This is used to facilitate process attestation during state transition and during upgrade to altair state.
<p>Spec code:
def get_attestation_participation_flag_indices(state: BeaconState,
<pre>                                           data: AttestationData,
                                           inclusion_delay: uint64) -&gt; Sequence[int]:
&quot;&quot;&quot;
Return the flag indices that are satisfied by an attestation.
&quot;&quot;&quot;
if data.target.epoch == get_current_epoch(state):
    justified_checkpoint = state.current_justified_checkpoint
else:
    justified_checkpoint = state.previous_justified_checkpoint

# Matching roots
is_matching_source = data.source == justified_checkpoint
is_matching_target = is_matching_source and data.target.root == get_block_root(state, data.target.epoch)
is_matching_head = is_matching_target and data.beacon_block_root == get_block_root_at_slot(state, data.slot)
assert is_matching_source

participation_flag_indices = []
if is_matching_source and inclusion_delay &lt;= integer_squareroot(SLOTS_PER_EPOCH):
    participation_flag_indices.append(TIMELY_SOURCE_FLAG_INDEX)
if is_matching_target and inclusion_delay &lt;= SLOTS_PER_EPOCH:
    participation_flag_indices.append(TIMELY_TARGET_FLAG_INDEX)
if is_matching_head and inclusion_delay == MIN_ATTESTATION_INCLUSION_DELAY:
    participation_flag_indices.append(TIMELY_HEAD_FLAG_INDEX)

return participation_flag_indices
</pre>

			
			

		
			
			
			<h2 id="AttestationsDelta">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/epoch_precompute.go?s=9216:9365#L247">AttestationsDelta</a>
				<a class="permalink" href="index.html#AttestationsDelta">&#xb6;</a>
				
				
			</h2>
			<pre>func AttestationsDelta(beaconState <a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconState">BeaconState</a>, bal *<a href="../epoch/precompute/index.html">precompute</a>.<a href="../epoch/precompute/index.html#Balance">Balance</a>, vals []*<a href="../epoch/precompute/index.html">precompute</a>.<a href="../epoch/precompute/index.html#Validator">Validator</a>) (rewards, penalties []<a href="../../../../../../builtin/index.html#uint64">uint64</a>, err <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>AttestationsDelta computes and returns the rewards and penalties differences for individual validators based on the
voting records.

			
			

		
			
			
			<h2 id="BaseReward">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/reward.go?s=1025:1113#L16">BaseReward</a>
				<a class="permalink" href="index.html#BaseReward">&#xb6;</a>
				
				
			</h2>
			<pre>func BaseReward(s <a href="../../state/index.html">state</a>.<a href="../../state/index.html#ReadOnlyBeaconState">ReadOnlyBeaconState</a>, index <a href="../../../../eth2-types/index.html">types</a>.<a href="../../../../eth2-types/index.html#ValidatorIndex">ValidatorIndex</a>) (<a href="../../../../../../builtin/index.html#uint64">uint64</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>BaseReward takes state and validator index and calculate
individual validator&apos;s base reward.
<p>Spec code:
<pre>def get_base_reward(state: BeaconState, index: ValidatorIndex) -&gt; Gwei:
  &quot;&quot;&quot;
  Return the base reward for the validator defined by ``index`` with respect to the current ``state``.

  Note: An optimally performing validator can earn one base reward per epoch over a long time horizon.
  This takes into account both per-epoch (e.g. attestation) and intermittent duties (e.g. block proposal
  and sync committees).
  &quot;&quot;&quot;
  increments = state.validators[index].effective_balance // EFFECTIVE_BALANCE_INCREMENT
  return Gwei(increments * get_base_reward_per_increment(state))
</pre>

			
			

		
			
			
			<h2 id="BaseRewardPerIncrement">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/reward.go?s=2115:2180#L44">BaseRewardPerIncrement</a>
				<a class="permalink" href="index.html#BaseRewardPerIncrement">&#xb6;</a>
				
				
			</h2>
			<pre>func BaseRewardPerIncrement(activeBalance <a href="../../../../../../builtin/index.html#uint64">uint64</a>) (<a href="../../../../../../builtin/index.html#uint64">uint64</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>BaseRewardPerIncrement of the beacon state
<p>Spec code:
def get_base_reward_per_increment(state: BeaconState) -&gt; Gwei:
<pre>return Gwei(EFFECTIVE_BALANCE_INCREMENT * BASE_REWARD_FACTOR // integer_squareroot(get_total_active_balance(state)))
</pre>

			
			

		
			
			
			<h2 id="BaseRewardWithTotalBalance">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/reward.go?s=1407:1532#L25">BaseRewardWithTotalBalance</a>
				<a class="permalink" href="index.html#BaseRewardWithTotalBalance">&#xb6;</a>
				
				
			</h2>
			<pre>func BaseRewardWithTotalBalance(s <a href="../../state/index.html">state</a>.<a href="../../state/index.html#ReadOnlyBeaconState">ReadOnlyBeaconState</a>, index <a href="../../../../eth2-types/index.html">types</a>.<a href="../../../../eth2-types/index.html#ValidatorIndex">ValidatorIndex</a>, totalBalance <a href="../../../../../../builtin/index.html#uint64">uint64</a>) (<a href="../../../../../../builtin/index.html#uint64">uint64</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>BaseRewardWithTotalBalance calculates the base reward with the provided total balance.

			
			

		
			
			
			<h2 id="EpochParticipation">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/attestation.go?s=6339:6517#L159">EpochParticipation</a>
				<a class="permalink" href="index.html#EpochParticipation">&#xb6;</a>
				
				
			</h2>
			<pre>func EpochParticipation(beaconState <a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconState">BeaconState</a>, indices []<a href="../../../../../../builtin/index.html#uint64">uint64</a>, epochParticipation []<a href="../../../../../../builtin/index.html#byte">byte</a>, participatedFlags map[<a href="../../../../../../builtin/index.html#uint8">uint8</a>]<a href="../../../../../../builtin/index.html#bool">bool</a>, totalBalance <a href="../../../../../../builtin/index.html#uint64">uint64</a>) (<a href="../../../../../../builtin/index.html#uint64">uint64</a>, []<a href="../../../../../../builtin/index.html#byte">byte</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>EpochParticipation sets and returns the proposer reward numerator and epoch participation.
<p>Spec code:
<pre>proposer_reward_numerator = 0
for index in get_attesting_indices(state, data, attestation.aggregation_bits):
    for flag_index, weight in enumerate(PARTICIPATION_FLAG_WEIGHTS):
        if flag_index in participation_flag_indices and not has_flag(epoch_participation[index], flag_index):
            epoch_participation[index] = add_flag(epoch_participation[index], flag_index)
            proposer_reward_numerator += get_base_reward(state, index) * weight
</pre>

			
			

		
			
			
			<h2 id="FilterSyncCommitteeVotes">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/block.go?s=3188:3393#L51">FilterSyncCommitteeVotes</a>
				<a class="permalink" href="index.html#FilterSyncCommitteeVotes">&#xb6;</a>
				
				
			</h2>
			<pre>func FilterSyncCommitteeVotes(s <a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconStateAltair">BeaconStateAltair</a>, sync *<a href="../../../proto/prysm/v1alpha1/index.html">ethpb</a>.<a href="../../../proto/prysm/v1alpha1/index.html#SyncAggregate">SyncAggregate</a>) (
    votedKeys []<a href="../../../crypto/bls/index.html">bls</a>.<a href="../../../crypto/bls/index.html#PublicKey">PublicKey</a>,
    votedIndices []<a href="../../../../eth2-types/index.html">types</a>.<a href="../../../../eth2-types/index.html#ValidatorIndex">ValidatorIndex</a>,
    didntVoteIndices []<a href="../../../../eth2-types/index.html">types</a>.<a href="../../../../eth2-types/index.html#ValidatorIndex">ValidatorIndex</a>,
    err <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>FilterSyncCommitteeVotes filters the validator public keys and indices for the ones that voted and didn&apos;t vote.

			
			

		
			
			
			<h2 id="HasValidatorFlag">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/attestation.go?s=5282:5343#L135">HasValidatorFlag</a>
				<a class="permalink" href="index.html#HasValidatorFlag">&#xb6;</a>
				
				
			</h2>
			<pre>func HasValidatorFlag(flag, flagPosition <a href="../../../../../../builtin/index.html#uint8">uint8</a>) (<a href="../../../../../../builtin/index.html#bool">bool</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>HasValidatorFlag returns true if the flag at position has set.

			
			

		
			
			
			<h2 id="InitializePrecomputeValidators">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/epoch_precompute.go?s=624:771#L8">InitializePrecomputeValidators</a>
				<a class="permalink" href="index.html#InitializePrecomputeValidators">&#xb6;</a>
				
				
			</h2>
			<pre>func InitializePrecomputeValidators(ctx <a href="../../../../../../context/index.html">context</a>.<a href="../../../../../../context/index.html#Context">Context</a>, beaconState <a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconStateAltair">BeaconStateAltair</a>) ([]*<a href="../epoch/precompute/index.html">precompute</a>.<a href="../epoch/precompute/index.html#Validator">Validator</a>, *<a href="../epoch/precompute/index.html">precompute</a>.<a href="../epoch/precompute/index.html#Balance">Balance</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>InitializePrecomputeValidators precomputes individual validator for its attested balances and the total sum of validators attested balances of the epoch.

			
			

		
			
			
			<h2 id="IsSyncCommitteeAggregator">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/sync_committee.go?s=6810:6866#L167">IsSyncCommitteeAggregator</a>
				<a class="permalink" href="index.html#IsSyncCommitteeAggregator">&#xb6;</a>
				
				
			</h2>
			<pre>func IsSyncCommitteeAggregator(sig []<a href="../../../../../../builtin/index.html#byte">byte</a>) (<a href="../../../../../../builtin/index.html#bool">bool</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>IsSyncCommitteeAggregator checks whether the provided signature is for a valid
aggregator.
<p>def is_sync_committee_aggregator(signature: BLSSignature) -&gt; bool:
<pre>modulo = max(1, SYNC_COMMITTEE_SIZE // SYNC_COMMITTEE_SUBNET_COUNT // TARGET_AGGREGATORS_PER_SYNC_SUBCOMMITTEE)
return bytes_to_uint64(hash(signature)[0:8]) % modulo == 0
</pre>

			
			

		
			
			
			<h2 id="MatchingStatus">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/attestation.go?s=12494:12649#L303">MatchingStatus</a>
				<a class="permalink" href="index.html#MatchingStatus">&#xb6;</a>
				
				
			</h2>
			<pre>func MatchingStatus(beaconState <a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconState">BeaconState</a>, data *<a href="../../../proto/prysm/v1alpha1/index.html">ethpb</a>.<a href="../../../proto/prysm/v1alpha1/index.html#AttestationData">AttestationData</a>, cp *<a href="../../../proto/prysm/v1alpha1/index.html">ethpb</a>.<a href="../../../proto/prysm/v1alpha1/index.html#Checkpoint">Checkpoint</a>) (matchedSrc, matchedTgt, matchedHead <a href="../../../../../../builtin/index.html#bool">bool</a>, err <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>MatchingStatus returns the matching statues for attestation data&apos;s source target and head.
<p>Spec code:
<pre>is_matching_source = data.source == justified_checkpoint
is_matching_target = is_matching_source and data.target.root == get_block_root(state, data.target.epoch)
is_matching_head = is_matching_target and data.beacon_block_root == get_block_root_at_slot(state, data.slot)
</pre>

			
			

		
			
			
			<h2 id="NextSyncCommittee">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/sync_committee.go?s=1968:2068#L47">NextSyncCommittee</a>
				<a class="permalink" href="index.html#NextSyncCommittee">&#xb6;</a>
				
				
			</h2>
			<pre>func NextSyncCommittee(ctx <a href="../../../../../../context/index.html">context</a>.<a href="../../../../../../context/index.html#Context">Context</a>, s <a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconStateAltair">BeaconStateAltair</a>) (*<a href="../../../proto/prysm/v1alpha1/index.html">ethpb</a>.<a href="../../../proto/prysm/v1alpha1/index.html#SyncCommittee">SyncCommittee</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>NextSyncCommittee returns the next sync committee for a given state.
<p>Spec code:
def get_next_sync_committee(state: BeaconState) -&gt; SyncCommittee:
<pre>&quot;&quot;&quot;
Return the next sync committee, with possible pubkey duplicates.
&quot;&quot;&quot;
indices = get_next_sync_committee_indices(state)
pubkeys = [state.validators[index].pubkey for index in indices]
aggregate_pubkey = bls.AggregatePKs(pubkeys)
return SyncCommittee(pubkeys=pubkeys, aggregate_pubkey=aggregate_pubkey)
</pre>

			
			

		
			
			
			<h2 id="NextSyncCommitteeIndices">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/sync_committee.go?s=3762:3871#L91">NextSyncCommitteeIndices</a>
				<a class="permalink" href="index.html#NextSyncCommitteeIndices">&#xb6;</a>
				
				
			</h2>
			<pre>func NextSyncCommitteeIndices(ctx <a href="../../../../../../context/index.html">context</a>.<a href="../../../../../../context/index.html#Context">Context</a>, s <a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconStateAltair">BeaconStateAltair</a>) ([]<a href="../../../../eth2-types/index.html">types</a>.<a href="../../../../eth2-types/index.html#ValidatorIndex">ValidatorIndex</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>NextSyncCommitteeIndices returns the next sync committee indices for a given state.
<p>Spec code:
def get_next_sync_committee_indices(state: BeaconState) -&gt; Sequence[ValidatorIndex]:
<pre>&quot;&quot;&quot;
Return the sync committee indices, with possible duplicates, for the next sync committee.
&quot;&quot;&quot;
epoch = Epoch(get_current_epoch(state) + 1)

MAX_RANDOM_BYTE = 2**8 - 1
active_validator_indices = get_active_validator_indices(state, epoch)
active_validator_count = uint64(len(active_validator_indices))
seed = get_seed(state, epoch, DOMAIN_SYNC_COMMITTEE)
i = 0
sync_committee_indices: List[ValidatorIndex] = []
while len(sync_committee_indices) &lt; SYNC_COMMITTEE_SIZE:
    shuffled_index = compute_shuffled_index(uint64(i % active_validator_count), active_validator_count, seed)
    candidate_index = active_validator_indices[shuffled_index]
    random_byte = hash(seed + uint_to_bytes(uint64(i // 32)))[i % 32]
    effective_balance = state.validators[candidate_index].effective_balance
    if effective_balance * MAX_RANDOM_BYTE &gt;= MAX_EFFECTIVE_BALANCE * random_byte:
        sync_committee_indices.append(candidate_index)
    i += 1
return sync_committee_indices
</pre>

			
			

		
			
			
			<h2 id="ProcessAttestationNoVerifySignature">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/attestation.go?s=1698:1881#L37">ProcessAttestationNoVerifySignature</a>
				<a class="permalink" href="index.html#ProcessAttestationNoVerifySignature">&#xb6;</a>
				
				
			</h2>
			<pre>func ProcessAttestationNoVerifySignature(
    ctx <a href="../../../../../../context/index.html">context</a>.<a href="../../../../../../context/index.html#Context">Context</a>,
    beaconState <a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconStateAltair">BeaconStateAltair</a>,
    att *<a href="../../../proto/prysm/v1alpha1/index.html">ethpb</a>.<a href="../../../proto/prysm/v1alpha1/index.html#Attestation">Attestation</a>,
    totalBalance <a href="../../../../../../builtin/index.html#uint64">uint64</a>,
) (<a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconStateAltair">BeaconStateAltair</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>ProcessAttestationNoVerifySignature processes the attestation without verifying the attestation signature. This
method is used to validate attestations whose signatures have already been verified or will be verified later.

			
			

		
			
			
			<h2 id="ProcessAttestationsNoVerifySignature">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/attestation.go?s=814:967#L13">ProcessAttestationsNoVerifySignature</a>
				<a class="permalink" href="index.html#ProcessAttestationsNoVerifySignature">&#xb6;</a>
				
				
			</h2>
			<pre>func ProcessAttestationsNoVerifySignature(
    ctx <a href="../../../../../../context/index.html">context</a>.<a href="../../../../../../context/index.html#Context">Context</a>,
    beaconState <a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconState">BeaconState</a>,
    b <a href="../../../proto/prysm/v1alpha1/block/index.html">block</a>.<a href="../../../proto/prysm/v1alpha1/block/index.html#SignedBeaconBlock">SignedBeaconBlock</a>,
) (<a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconState">BeaconState</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>ProcessAttestationsNoVerifySignature applies processing operations to a block&apos;s inner attestation
records. The only difference would be that the attestation signature would not be verified.

			
			

		
			
			
			<h2 id="ProcessDeposit">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/deposit.go?s=1080:1236#L27">ProcessDeposit</a>
				<a class="permalink" href="index.html#ProcessDeposit">&#xb6;</a>
				
				
			</h2>
			<pre>func ProcessDeposit(ctx <a href="../../../../../../context/index.html">context</a>.<a href="../../../../../../context/index.html#Context">Context</a>, beaconState <a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconStateAltair">BeaconStateAltair</a>, deposit *<a href="../../../proto/prysm/v1alpha1/index.html">ethpb</a>.<a href="../../../proto/prysm/v1alpha1/index.html#Deposit">Deposit</a>, verifySignature <a href="../../../../../../builtin/index.html#bool">bool</a>) (<a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconStateAltair">BeaconStateAltair</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>ProcessDeposit processes validator deposit for beacon state Altair.

			
			

		
			
			
			<h2 id="ProcessDeposits">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/deposit.go?s=364:508#L4">ProcessDeposits</a>
				<a class="permalink" href="index.html#ProcessDeposits">&#xb6;</a>
				
				
			</h2>
			<pre>func ProcessDeposits(
    ctx <a href="../../../../../../context/index.html">context</a>.<a href="../../../../../../context/index.html#Context">Context</a>,
    beaconState <a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconStateAltair">BeaconStateAltair</a>,
    deposits []*<a href="../../../proto/prysm/v1alpha1/index.html">ethpb</a>.<a href="../../../proto/prysm/v1alpha1/index.html#Deposit">Deposit</a>,
) (<a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconStateAltair">BeaconStateAltair</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>ProcessDeposits processes validator deposits for beacon state Altair.

			
			

		
			
			
			<h2 id="ProcessEpoch">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/transition.go?s=1262:1358#L22">ProcessEpoch</a>
				<a class="permalink" href="index.html#ProcessEpoch">&#xb6;</a>
				
				
			</h2>
			<pre>func ProcessEpoch(ctx <a href="../../../../../../context/index.html">context</a>.<a href="../../../../../../context/index.html#Context">Context</a>, state <a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconState">BeaconState</a>) (<a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconStateAltair">BeaconStateAltair</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>ProcessEpoch describes the per epoch operations that are performed on the beacon state.
It&apos;s optimized by pre computing validator attested info and epoch total/attested balances upfront.
<p>Spec code:
def process_epoch(state: BeaconState) -&gt; None:
<pre>process_justification_and_finalization(state)  # [Modified in Altair]
process_inactivity_updates(state)  # [New in Altair]
process_rewards_and_penalties(state)  # [Modified in Altair]
process_registry_updates(state)
process_slashings(state)  # [Modified in Altair]
process_eth1_data_reset(state)
process_effective_balance_updates(state)
process_slashings_reset(state)
process_randao_mixes_reset(state)
process_historical_roots_update(state)
process_participation_flag_updates(state)  # [New in Altair]
process_sync_committee_updates(state)  # [New in Altair]
</pre>

			
			

		
			
			
			<h2 id="ProcessEpochParticipation">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/epoch_precompute.go?s=5602:5800#L132">ProcessEpochParticipation</a>
				<a class="permalink" href="index.html#ProcessEpochParticipation">&#xb6;</a>
				
				
			</h2>
			<pre>func ProcessEpochParticipation(
    ctx <a href="../../../../../../context/index.html">context</a>.<a href="../../../../../../context/index.html#Context">Context</a>,
    beaconState <a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconState">BeaconState</a>,
    bal *<a href="../epoch/precompute/index.html">precompute</a>.<a href="../epoch/precompute/index.html#Balance">Balance</a>,
    vals []*<a href="../epoch/precompute/index.html">precompute</a>.<a href="../epoch/precompute/index.html#Validator">Validator</a>,
) ([]*<a href="../epoch/precompute/index.html">precompute</a>.<a href="../epoch/precompute/index.html#Validator">Validator</a>, *<a href="../epoch/precompute/index.html">precompute</a>.<a href="../epoch/precompute/index.html#Balance">Balance</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>ProcessEpochParticipation processes the epoch participation in state and updates individual validator&apos;s pre computes,
it also tracks and updates epoch attesting balances.
Spec code:
if epoch == get_current_epoch(state):
<pre>    epoch_participation = state.current_epoch_participation
else:
    epoch_participation = state.previous_epoch_participation
active_validator_indices = get_active_validator_indices(state, epoch)
participating_indices = [i for i in active_validator_indices if has_flag(epoch_participation[i], flag_index)]
return set(filter(lambda index: not state.validators[index].slashed, participating_indices))
</pre>

			
			

		
			
			
			<h2 id="ProcessInactivityScores">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/epoch_precompute.go?s=3471:3639#L65">ProcessInactivityScores</a>
				<a class="permalink" href="index.html#ProcessInactivityScores">&#xb6;</a>
				
				
			</h2>
			<pre>func ProcessInactivityScores(
    ctx <a href="../../../../../../context/index.html">context</a>.<a href="../../../../../../context/index.html#Context">Context</a>,
    beaconState <a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconState">BeaconState</a>,
    vals []*<a href="../epoch/precompute/index.html">precompute</a>.<a href="../epoch/precompute/index.html#Validator">Validator</a>,
) (<a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconState">BeaconState</a>, []*<a href="../epoch/precompute/index.html">precompute</a>.<a href="../epoch/precompute/index.html#Validator">Validator</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>ProcessInactivityScores of beacon chain. This updates inactivity scores of beacon chain and
updates the precompute validator struct for later processing. The inactivity scores work as following:
For fully inactive validators and perfect active validators, the effect is the same as before Altair.
For a validator is inactive and the chain fails to finalize, the inactivity score increases by a fixed number, the total loss after N epochs is proportional to N**2/2.
For imperfectly active validators. The inactivity score&apos;s behavior is specified by this function:
<pre>If a validator fails to submit an attestation with the correct target, their inactivity score goes up by 4.
If they successfully submit an attestation with the correct source and target, their inactivity score drops by 1
If the chain has recently finalized, each validator&apos;s score drops by 16.
</pre>

			
			

		
			
			
			<h2 id="ProcessParticipationFlagUpdates">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/epoch_spec.go?s=1932:2038#L41">ProcessParticipationFlagUpdates</a>
				<a class="permalink" href="index.html#ProcessParticipationFlagUpdates">&#xb6;</a>
				
				
			</h2>
			<pre>func ProcessParticipationFlagUpdates(beaconState <a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconStateAltair">BeaconStateAltair</a>) (<a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconStateAltair">BeaconStateAltair</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>ProcessParticipationFlagUpdates processes participation flag updates by rotating current to previous.
<p>Spec code:
def process_participation_flag_updates(state: BeaconState) -&gt; None:
<pre>state.previous_epoch_participation = state.current_epoch_participation
state.current_epoch_participation = [ParticipationFlags(0b0000_0000) for _ in range(len(state.validators))]
</pre>

			
			

		
			
			
			<h2 id="ProcessRewardsAndPenaltiesPrecompute">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/epoch_precompute.go?s=7602:7774#L201">ProcessRewardsAndPenaltiesPrecompute</a>
				<a class="permalink" href="index.html#ProcessRewardsAndPenaltiesPrecompute">&#xb6;</a>
				
				
			</h2>
			<pre>func ProcessRewardsAndPenaltiesPrecompute(
    beaconState <a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconStateAltair">BeaconStateAltair</a>,
    bal *<a href="../epoch/precompute/index.html">precompute</a>.<a href="../epoch/precompute/index.html#Balance">Balance</a>,
    vals []*<a href="../epoch/precompute/index.html">precompute</a>.<a href="../epoch/precompute/index.html#Validator">Validator</a>,
) (<a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconStateAltair">BeaconStateAltair</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>ProcessRewardsAndPenaltiesPrecompute processes the rewards and penalties of individual validator.
This is an optimized version by passing in precomputed validator attesting records and and total epoch balances.

			
			

		
			
			
			<h2 id="ProcessSyncAggregate">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/block.go?s=2623:2756#L37">ProcessSyncAggregate</a>
				<a class="permalink" href="index.html#ProcessSyncAggregate">&#xb6;</a>
				
				
			</h2>
			<pre>func ProcessSyncAggregate(ctx <a href="../../../../../../context/index.html">context</a>.<a href="../../../../../../context/index.html#Context">Context</a>, s <a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconStateAltair">BeaconStateAltair</a>, sync *<a href="../../../proto/prysm/v1alpha1/index.html">ethpb</a>.<a href="../../../proto/prysm/v1alpha1/index.html#SyncAggregate">SyncAggregate</a>) (<a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconStateAltair">BeaconStateAltair</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>ProcessSyncAggregate verifies sync committee aggregate signature signing over the previous slot block root.
<p>Spec code:
def process_sync_aggregate(state: BeaconState, sync_aggregate: SyncAggregate) -&gt; None:
<pre># Verify sync committee aggregate signature signing over the previous slot block root
committee_pubkeys = state.current_sync_committee.pubkeys
participant_pubkeys = [pubkey for pubkey, bit in zip(committee_pubkeys, sync_aggregate.sync_committee_bits) if bit]
previous_slot = max(state.slot, Slot(1)) - Slot(1)
domain = get_domain(state, DOMAIN_SYNC_COMMITTEE, compute_epoch_at_slot(previous_slot))
signing_root = compute_signing_root(get_block_root_at_slot(state, previous_slot), domain)
assert eth2_fast_aggregate_verify(participant_pubkeys, signing_root, sync_aggregate.sync_committee_signature)

# Compute participant and proposer rewards
total_active_increments = get_total_active_balance(state) // EFFECTIVE_BALANCE_INCREMENT
total_base_rewards = Gwei(get_base_reward_per_increment(state) * total_active_increments)
max_participant_rewards = Gwei(total_base_rewards * SYNC_REWARD_WEIGHT // WEIGHT_DENOMINATOR // SLOTS_PER_EPOCH)
participant_reward = Gwei(max_participant_rewards // SYNC_COMMITTEE_SIZE)
proposer_reward = Gwei(participant_reward * PROPOSER_WEIGHT // (WEIGHT_DENOMINATOR - PROPOSER_WEIGHT))

# Apply participant and proposer rewards
all_pubkeys = [v.pubkey for v in state.validators]
committee_indices = [ValidatorIndex(all_pubkeys.index(pubkey)) for pubkey in state.current_sync_committee.pubkeys]
for participant_index, participation_bit in zip(committee_indices, sync_aggregate.sync_committee_bits):
    if participation_bit:
        increase_balance(state, participant_index, participant_reward)
        increase_balance(state, get_beacon_proposer_index(state), proposer_reward)
    else:
        decrease_balance(state, participant_index, participant_reward)
</pre>

			
			

		
			
			
			<h2 id="ProcessSyncCommitteeUpdates">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/epoch_spec.go?s=722:845#L11">ProcessSyncCommitteeUpdates</a>
				<a class="permalink" href="index.html#ProcessSyncCommitteeUpdates">&#xb6;</a>
				
				
			</h2>
			<pre>func ProcessSyncCommitteeUpdates(ctx <a href="../../../../../../context/index.html">context</a>.<a href="../../../../../../context/index.html#Context">Context</a>, beaconState <a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconStateAltair">BeaconStateAltair</a>) (<a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconStateAltair">BeaconStateAltair</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>ProcessSyncCommitteeUpdates  processes sync client committee updates for the beacon state.
<p>Spec code:
def process_sync_committee_updates(state: BeaconState) -&gt; None:
<pre>next_epoch = get_current_epoch(state) + Epoch(1)
if next_epoch % EPOCHS_PER_SYNC_COMMITTEE_PERIOD == 0:
    state.current_sync_committee = state.next_sync_committee
    state.next_sync_committee = get_next_sync_committee(state)
</pre>

			
			

		
			
			
			<h2 id="RewardProposer">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/attestation.go?s=8662:8771#L217">RewardProposer</a>
				<a class="permalink" href="index.html#RewardProposer">&#xb6;</a>
				
				
			</h2>
			<pre>func RewardProposer(ctx <a href="../../../../../../context/index.html">context</a>.<a href="../../../../../../context/index.html#Context">Context</a>, beaconState <a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconState">BeaconState</a>, proposerRewardNumerator <a href="../../../../../../builtin/index.html#uint64">uint64</a>) <a href="../../../../../../builtin/index.html#error">error</a></pre>
			<p>RewardProposer rewards proposer by increasing proposer&apos;s balance with input reward numerator and calculated reward denominator.
<p>Spec code:
<pre>proposer_reward_denominator = (WEIGHT_DENOMINATOR - PROPOSER_WEIGHT) * WEIGHT_DENOMINATOR // PROPOSER_WEIGHT
proposer_reward = Gwei(proposer_reward_numerator // proposer_reward_denominator)
increase_balance(state, get_beacon_proposer_index(state), proposer_reward)
</pre>

			
			

		
			
			
			<h2 id="SetParticipationAndRewardProposer">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/attestation.go?s=4045:4266#L91">SetParticipationAndRewardProposer</a>
				<a class="permalink" href="index.html#SetParticipationAndRewardProposer">&#xb6;</a>
				
				
			</h2>
			<pre>func SetParticipationAndRewardProposer(
    ctx <a href="../../../../../../context/index.html">context</a>.<a href="../../../../../../context/index.html#Context">Context</a>,
    beaconState <a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconState">BeaconState</a>,
    targetEpoch <a href="../../../../eth2-types/index.html">types</a>.<a href="../../../../eth2-types/index.html#Epoch">Epoch</a>,
    indices []<a href="../../../../../../builtin/index.html#uint64">uint64</a>,
    participatedFlags map[<a href="../../../../../../builtin/index.html#uint8">uint8</a>]<a href="../../../../../../builtin/index.html#bool">bool</a>, totalBalance <a href="../../../../../../builtin/index.html#uint64">uint64</a>) (<a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconState">BeaconState</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>SetParticipationAndRewardProposer retrieves and sets the epoch participation bits in state. Based on the epoch participation, it rewards
the proposer in state.
<p>Spec code:
<pre> # Update epoch participation flags
if data.target.epoch == get_current_epoch(state):
    epoch_participation = state.current_epoch_participation
else:
    epoch_participation = state.previous_epoch_participation

proposer_reward_numerator = 0
for index in get_attesting_indices(state, data, attestation.aggregation_bits):
    for flag_index, weight in enumerate(PARTICIPATION_FLAG_WEIGHTS):
        if flag_index in participation_flag_indices and not has_flag(epoch_participation[index], flag_index):
            epoch_participation[index] = add_flag(epoch_participation[index], flag_index)
            proposer_reward_numerator += get_base_reward(state, index) * weight

# Reward proposer
proposer_reward_denominator = (WEIGHT_DENOMINATOR - PROPOSER_WEIGHT) * WEIGHT_DENOMINATOR // PROPOSER_WEIGHT
proposer_reward = Gwei(proposer_reward_numerator // proposer_reward_denominator)
increase_balance(state, get_beacon_proposer_index(state), proposer_reward)
</pre>

			
			

		
			
			
			<h2 id="SyncRewards">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/block.go?s=6698:6790#L156">SyncRewards</a>
				<a class="permalink" href="index.html#SyncRewards">&#xb6;</a>
				
				
			</h2>
			<pre>func SyncRewards(activeBalance <a href="../../../../../../builtin/index.html#uint64">uint64</a>) (proposerReward, participantReward <a href="../../../../../../builtin/index.html#uint64">uint64</a>, err <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>SyncRewards returns the proposer reward and the sync participant reward given the total active balance in state.

			
			

		
			
			
			<h2 id="SyncSubCommitteePubkeys">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/sync_committee.go?s=5934:6048#L149">SyncSubCommitteePubkeys</a>
				<a class="permalink" href="index.html#SyncSubCommitteePubkeys">&#xb6;</a>
				
				
			</h2>
			<pre>func SyncSubCommitteePubkeys(syncCommittee *<a href="../../../proto/prysm/v1alpha1/index.html">ethpb</a>.<a href="../../../proto/prysm/v1alpha1/index.html#SyncCommittee">SyncCommittee</a>, subComIdx <a href="../../../../eth2-types/index.html">types</a>.<a href="../../../../eth2-types/index.html#CommitteeIndex">CommitteeIndex</a>) ([][]<a href="../../../../../../builtin/index.html#byte">byte</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>SyncSubCommitteePubkeys returns the pubkeys participating in a sync subcommittee.
<p>def get_sync_subcommittee_pubkeys(state: BeaconState, subcommittee_index: uint64) -&gt; Sequence[BLSPubkey]:
<pre># Committees assigned to `slot` sign for `slot - 1`
# This creates the exceptional logic below when transitioning between sync committee periods
next_slot_epoch = compute_epoch_at_slot(Slot(state.slot + 1))
if compute_sync_committee_period(get_current_epoch(state)) == compute_sync_committee_period(next_slot_epoch):
    sync_committee = state.current_sync_committee
else:
    sync_committee = state.next_sync_committee

# Return pubkeys for the subcommittee index
sync_subcommittee_size = SYNC_COMMITTEE_SIZE // SYNC_COMMITTEE_SUBNET_COUNT
i = subcommittee_index * sync_subcommittee_size
return sync_committee.pubkeys[i:i + sync_subcommittee_size]
</pre>

			
			

		
			
			
			<h2 id="TranslateParticipation">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/upgrade.go?s=5832:5980#L130">TranslateParticipation</a>
				<a class="permalink" href="index.html#TranslateParticipation">&#xb6;</a>
				
				
			</h2>
			<pre>func TranslateParticipation(ctx <a href="../../../../../../context/index.html">context</a>.<a href="../../../../../../context/index.html#Context">Context</a>, state *<a href="../../state/v2/index.html">statealtair</a>.<a href="../../state/v2/index.html#BeaconState">BeaconState</a>, atts []*<a href="../../../proto/prysm/v1alpha1/index.html">ethpb</a>.<a href="../../../proto/prysm/v1alpha1/index.html#PendingAttestation">PendingAttestation</a>) (*<a href="../../state/v2/index.html">statealtair</a>.<a href="../../state/v2/index.html#BeaconState">BeaconState</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>TranslateParticipation translates pending attestations into participation bits, then inserts the bits into beacon state.
This is helper function to convert phase 0 beacon state(pending_attestations) to Altair beacon state(participation_bits).
<p>Spec code:
def translate_participation(state: BeaconState, pending_attestations: Sequence[phase0.PendingAttestation]) -&gt; None:
<pre>for attestation in pending_attestations:
    data = attestation.data
    inclusion_delay = attestation.inclusion_delay
    # Translate attestation inclusion info to flag indices
    participation_flag_indices = get_attestation_participation_flag_indices(state, data, inclusion_delay)

    # Apply flags to all attesting validators
    epoch_participation = state.previous_epoch_participation
    for index in get_attesting_indices(state, data, attestation.aggregation_bits):
        for flag_index in participation_flag_indices:
            epoch_participation[index] = add_flag(epoch_participation[index], flag_index)
</pre>

			
			

		
			
			
			<h2 id="UpgradeToAltair">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/upgrade.go?s=2643:2742#L55">UpgradeToAltair</a>
				<a class="permalink" href="index.html#UpgradeToAltair">&#xb6;</a>
				
				
			</h2>
			<pre>func UpgradeToAltair(ctx <a href="../../../../../../context/index.html">context</a>.<a href="../../../../../../context/index.html#Context">Context</a>, state <a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconState">BeaconState</a>) (<a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconStateAltair">BeaconStateAltair</a>, <a href="../../../../../../builtin/index.html#error">error</a>)</pre>
			<p>UpgradeToAltair updates input state to return the version Altair state.
<p>Spec code:
def upgrade_to_altair(pre: phase0.BeaconState) -&gt; BeaconState:
<pre>epoch = phase0.get_current_epoch(pre)
post = BeaconState(
    # Versioning
    genesis_time=pre.genesis_time,
    genesis_validators_root=pre.genesis_validators_root,
    slot=pre.slot,
    fork=Fork(
        previous_version=pre.fork.current_version,
        current_version=ALTAIR_FORK_VERSION,
        epoch=epoch,
    ),
    # History
    latest_block_header=pre.latest_block_header,
    block_roots=pre.block_roots,
    state_roots=pre.state_roots,
    historical_roots=pre.historical_roots,
    # Eth1
    eth1_data=pre.eth1_data,
    eth1_data_votes=pre.eth1_data_votes,
    eth1_deposit_index=pre.eth1_deposit_index,
    # Registry
    validators=pre.validators,
    balances=pre.balances,
    # Randomness
    randao_mixes=pre.randao_mixes,
    # Slashings
    slashings=pre.slashings,
    # Participation
    previous_epoch_participation=[ParticipationFlags(0b0000_0000) for _ in range(len(pre.validators))],
    current_epoch_participation=[ParticipationFlags(0b0000_0000) for _ in range(len(pre.validators))],
    # Finality
    justification_bits=pre.justification_bits,
    previous_justified_checkpoint=pre.previous_justified_checkpoint,
    current_justified_checkpoint=pre.current_justified_checkpoint,
    finalized_checkpoint=pre.finalized_checkpoint,
    # Inactivity
    inactivity_scores=[uint64(0) for _ in range(len(pre.validators))],
)
# Fill in previous epoch participation from the pre state&apos;s pending attestations
translate_participation(post, pre.previous_epoch_attestations)

# Fill in sync committees
# Note: A duplicate committee is assigned for the current and next committee at the fork boundary
post.current_sync_committee = get_next_sync_committee(post)
post.next_sync_committee = get_next_sync_committee(post)
return post
</pre>

			
			

		
			
			
			<h2 id="ValidateNilSyncContribution">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/sync_committee.go?s=1001:1076#L20">ValidateNilSyncContribution</a>
				<a class="permalink" href="index.html#ValidateNilSyncContribution">&#xb6;</a>
				
				
			</h2>
			<pre>func ValidateNilSyncContribution(s *<a href="../../../proto/prysm/v1alpha1/index.html">ethpb</a>.<a href="../../../proto/prysm/v1alpha1/index.html#SignedContributionAndProof">SignedContributionAndProof</a>) <a href="../../../../../../builtin/index.html#error">error</a></pre>
			<p>ValidateNilSyncContribution validates the following fields are not nil:
-the contribution and proof itself
-the message within contribution and proof
-the contribution within contribution and proof
-the aggregation bits within contribution

			
			

		
			
			
			<h2 id="ValidateSyncMessageTime">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/sync_committee.go?s=7305:7409#L179">ValidateSyncMessageTime</a>
				<a class="permalink" href="index.html#ValidateSyncMessageTime">&#xb6;</a>
				
				
			</h2>
			<pre>func ValidateSyncMessageTime(slot <a href="../../../../eth2-types/index.html">types</a>.<a href="../../../../eth2-types/index.html#Slot">Slot</a>, genesisTime <a href="../../../../../../time/index.html">time</a>.<a href="../../../../../../time/index.html#Time">Time</a>, clockDisparity <a href="../../../../../../time/index.html">time</a>.<a href="../../../../../../time/index.html#Duration">Duration</a>) <a href="../../../../../../builtin/index.html#error">error</a></pre>
			<p>ValidateSyncMessageTime validates sync message to ensure that the provided slot is valid.

			
			

		
			
			
			<h2 id="VerifySyncCommitteeSig">func <a href="http://localhost:6060/src/github.com/prysmaticlabs/prysm/beacon-chain/core/altair/block.go?s=4727:4829#L93">VerifySyncCommitteeSig</a>
				<a class="permalink" href="index.html#VerifySyncCommitteeSig">&#xb6;</a>
				
				
			</h2>
			<pre>func VerifySyncCommitteeSig(s <a href="../../state/index.html">state</a>.<a href="../../state/index.html#BeaconStateAltair">BeaconStateAltair</a>, syncKeys []<a href="../../../crypto/bls/index.html">bls</a>.<a href="../../../crypto/bls/index.html#PublicKey">PublicKey</a>, syncSig []<a href="../../../../../../builtin/index.html#byte">byte</a>) <a href="../../../../../../builtin/index.html#error">error</a></pre>
			<p>VerifySyncCommitteeSig verifies sync committee signature `syncSig` is valid with respect to public keys `syncKeys`.

			
			

		
		
	

	







<div id="footer">
Build version go1.19.10.<br>
Except as <a href="https://developers.google.com/site-policies#restrictions">noted</a>,
the content of this page is licensed under the
Creative Commons Attribution 3.0 License,
and code is licensed under a <a href="http://localhost:6060/LICENSE">BSD license</a>.<br>
<a href="https://golang.org/doc/tos.html">Terms of Service</a> |
<a href="https://www.google.com/intl/en/policies/privacy/">Privacy Policy</a>
</div>

</div><!-- .container -->
</div><!-- #page -->
</body>
</html>
