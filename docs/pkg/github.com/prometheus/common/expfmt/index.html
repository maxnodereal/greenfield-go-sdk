<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#375EAB">

  <title>expfmt - Go Documentation Server</title>

<link type="text/css" rel="stylesheet" href="../../../../../lib/godoc/style.css">

<script>window.initFuncs = [];</script>
<script src="../../../../../lib/godoc/jquery.js" defer></script>



<script>var goVersion = "go1.19.10";</script>
<script src="../../../../../lib/godoc/godocs.js" defer></script>
</head>
<body>

<div id='lowframe' style="position: fixed; bottom: 0; left: 0; height: 0; width: 100%; border-top: thin solid grey; background-color: white; overflow: auto;">
...
</div><!-- #lowframe -->

<div id="topbar" class="wide"><div class="container">
<div class="top-heading" id="heading-wide"><a href="http://localhost:6060/pkg/">Go Documentation Server</a></div>
<div class="top-heading" id="heading-narrow"><a href="http://localhost:6060/pkg/">GoDoc</a></div>
<a href="index.html#" id="menu-button"><span id="menu-button-arrow">&#9661;</span></a>
<form method="GET" action="http://localhost:6060/search">
<div id="menu">

<span class="search-box"><input type="search" id="search" name="q" placeholder="Search" aria-label="Search" required><button type="submit"><span><!-- magnifying glass: --><svg width="24" height="24" viewBox="0 0 24 24"><title>submit search</title><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/><path d="M0 0h24v24H0z" fill="none"/></svg></span></button></span>
</div>
</form>

</div></div>



<div id="page" class="wide">
<div class="container">


  <h1>
    Package expfmt
    <span class="text-muted"></span>
  </h1>







<div id="nav"></div>


<!--
	Copyright 2009 The Go Authors. All rights reserved.
	Use of this source code is governed by a BSD-style
	license that can be found in the LICENSE file.
-->
<!--
	Note: Static (i.e., not template-generated) href and id
	attributes start with "pkg-" to make it impossible for
	them to conflict with generated attributes (some of which
	correspond to Go identifiers).
-->

	<script>
	document.ANALYSIS_DATA = null;
	document.CALLGRAPH = null;
	</script>

	
		
		<div id="short-nav">
			<dl>
			<dd><code>import "github.com/prometheus/common/expfmt"</code></dd>
			</dl>
			<dl>
			<dd><a href="index.html#pkg-overview" class="overviewLink">Overview</a></dd>
			<dd><a href="index.html#pkg-index" class="indexLink">Index</a></dd>
			
			
			</dl>
		</div>
		<!-- The package's Name is printed as title by the top-level template -->
		<div id="pkg-overview" class="toggleVisible">
			<div class="collapsed">
				<h2 class="toggleButton" title="Click to show Overview section">Overview ▹</h2>
			</div>
			<div class="expanded">
				<h2 class="toggleButton" title="Click to hide Overview section">Overview ▾</h2>
				<p>Package expfmt contains tools for reading and writing Prometheus metrics.

				
			</div>
		</div>

		<div id="pkg-index" class="toggleVisible">
		<div class="collapsed">
			<h2 class="toggleButton" title="Click to show Index section">Index ▹</h2>
		</div>
		<div class="expanded">
			<h2 class="toggleButton" title="Click to hide Index section">Index ▾</h2>

		<!-- Table of contents for API; must be named manual-nav to turn off auto nav. -->
			<div id="manual-nav">
			<dl>
			
				<dd><a href="index.html#pkg-constants">Constants</a></dd>
			
			
			
				
				<dd><a href="index.html#ExtractSamples">func ExtractSamples(o *DecodeOptions, fams ...*dto.MetricFamily) (model.Vector, error)</a></dd>
			
				
				<dd><a href="index.html#FinalizeOpenMetrics">func FinalizeOpenMetrics(w io.Writer) (written int, err error)</a></dd>
			
				
				<dd><a href="index.html#MetricFamilyToOpenMetrics">func MetricFamilyToOpenMetrics(out io.Writer, in *dto.MetricFamily) (written int, err error)</a></dd>
			
				
				<dd><a href="index.html#MetricFamilyToText">func MetricFamilyToText(out io.Writer, in *dto.MetricFamily) (written int, err error)</a></dd>
			
			
				
				<dd><a href="index.html#Closer">type Closer</a></dd>
				
				
			
				
				<dd><a href="index.html#DecodeOptions">type DecodeOptions</a></dd>
				
				
			
				
				<dd><a href="index.html#Decoder">type Decoder</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#NewDecoder">func NewDecoder(r io.Reader, format Format) Decoder</a></dd>
				
				
			
				
				<dd><a href="index.html#Encoder">type Encoder</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#NewEncoder">func NewEncoder(w io.Writer, format Format) Encoder</a></dd>
				
				
			
				
				<dd><a href="index.html#Format">type Format</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Negotiate">func Negotiate(h http.Header) Format</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#NegotiateIncludingOpenMetrics">func NegotiateIncludingOpenMetrics(h http.Header) Format</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#ResponseFormat">func ResponseFormat(h http.Header) Format</a></dd>
				
				
			
				
				<dd><a href="index.html#ParseError">type ParseError</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#ParseError.Error">func (e ParseError) Error() string</a></dd>
				
			
				
				<dd><a href="index.html#SampleDecoder">type SampleDecoder</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#SampleDecoder.Decode">func (sd *SampleDecoder) Decode(s *model.Vector) error</a></dd>
				
			
				
				<dd><a href="index.html#TextParser">type TextParser</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#TextParser.TextToMetricFamilies">func (p *TextParser) TextToMetricFamilies(in io.Reader) (map[string]*dto.MetricFamily, error)</a></dd>
				
			
			
				
				<dd><a href="index.html#pkg-note-BUG">Bugs</a></dd>
				
			
			</dl>
			</div><!-- #manual-nav -->

		

		
			<h3>Package files</h3>
			<p>
			<span style="font-size:90%">
			
				<a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/decode.go">decode.go</a>
			
				<a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/encode.go">encode.go</a>
			
				<a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/expfmt.go">expfmt.go</a>
			
				<a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/openmetrics_create.go">openmetrics_create.go</a>
			
				<a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/text_create.go">text_create.go</a>
			
				<a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/text_parse.go">text_parse.go</a>
			
			</span>
			</p>
		
		</div><!-- .expanded -->
		</div><!-- #pkg-index -->

		

		
			<h2 id="pkg-constants">Constants</h2>
			
				<p>Constants to assemble the Content-Type values for the different wire protocols.

				<pre>const (
    <span id="TextVersion">TextVersion</span>        = &#34;0.0.4&#34;
    <span id="ProtoType">ProtoType</span>          = `application/vnd.google.protobuf`
    <span id="ProtoProtocol">ProtoProtocol</span>      = `io.prometheus.client.MetricFamily`
    <span id="ProtoFmt">ProtoFmt</span>           = <a href="index.html#ProtoType">ProtoType</a> + &#34;; proto=&#34; + <a href="index.html#ProtoProtocol">ProtoProtocol</a> + &#34;;&#34;
    <span id="OpenMetricsType">OpenMetricsType</span>    = `application/openmetrics-text`
    <span id="OpenMetricsVersion">OpenMetricsVersion</span> = &#34;0.0.1&#34;

    <span class="comment">// The Content-Type values for the different wire protocols.</span>
    <span id="FmtUnknown">FmtUnknown</span>      <a href="index.html#Format">Format</a> = `&lt;unknown&gt;`
    <span id="FmtText">FmtText</span>         <a href="index.html#Format">Format</a> = `text/plain; version=` + <a href="index.html#TextVersion">TextVersion</a> + `; charset=utf-8`
    <span id="FmtProtoDelim">FmtProtoDelim</span>   <a href="index.html#Format">Format</a> = <a href="index.html#ProtoFmt">ProtoFmt</a> + ` encoding=delimited`
    <span id="FmtProtoText">FmtProtoText</span>    <a href="index.html#Format">Format</a> = <a href="index.html#ProtoFmt">ProtoFmt</a> + ` encoding=text`
    <span id="FmtProtoCompact">FmtProtoCompact</span> <a href="index.html#Format">Format</a> = <a href="index.html#ProtoFmt">ProtoFmt</a> + ` encoding=compact-text`
    <span id="FmtOpenMetrics">FmtOpenMetrics</span>  <a href="index.html#Format">Format</a> = <a href="index.html#OpenMetricsType">OpenMetricsType</a> + `; version=` + <a href="index.html#OpenMetricsVersion">OpenMetricsVersion</a> + `; charset=utf-8`
)</pre>
			
		
		
		
			
			
			<h2 id="ExtractSamples">func <a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/decode.go?s=4399:4485#L156">ExtractSamples</a>
				<a class="permalink" href="index.html#ExtractSamples">&#xb6;</a>
				
				
			</h2>
			<pre>func ExtractSamples(o *<a href="index.html#DecodeOptions">DecodeOptions</a>, fams ...*<a href="../../client_model/go/index.html">dto</a>.<a href="../../client_model/go/index.html#MetricFamily">MetricFamily</a>) (<a href="../model/index.html">model</a>.<a href="../model/index.html#Vector">Vector</a>, <a href="../../../../builtin/index.html#error">error</a>)</pre>
			<p>ExtractSamples builds a slice of samples from the provided metric
families. If an error occurs during sample extraction, it continues to
extract from the remaining metric families. The returned error is the last
error that has occurred.

			
			

		
			
			
			<h2 id="FinalizeOpenMetrics">func <a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/openmetrics_create.go?s=7766:7828#L278">FinalizeOpenMetrics</a>
				<a class="permalink" href="index.html#FinalizeOpenMetrics">&#xb6;</a>
				
				
			</h2>
			<pre>func FinalizeOpenMetrics(w <a href="../../../../io/index.html">io</a>.<a href="../../../../io/index.html#Writer">Writer</a>) (written <a href="../../../../builtin/index.html#int">int</a>, err <a href="../../../../builtin/index.html#error">error</a>)</pre>
			<p>FinalizeOpenMetrics writes the final `# EOF\n` line required by OpenMetrics.

			
			

		
			
			
			<h2 id="MetricFamilyToOpenMetrics">func <a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/openmetrics_create.go?s=2638:2730#L53">MetricFamilyToOpenMetrics</a>
				<a class="permalink" href="index.html#MetricFamilyToOpenMetrics">&#xb6;</a>
				
				
			</h2>
			<pre>func MetricFamilyToOpenMetrics(out <a href="../../../../io/index.html">io</a>.<a href="../../../../io/index.html#Writer">Writer</a>, in *<a href="../../client_model/go/index.html">dto</a>.<a href="../../client_model/go/index.html#MetricFamily">MetricFamily</a>) (written <a href="../../../../builtin/index.html#int">int</a>, err <a href="../../../../builtin/index.html#error">error</a>)</pre>
			<p>MetricFamilyToOpenMetrics converts a MetricFamily proto message into the
OpenMetrics text format and writes the resulting lines to &apos;out&apos;. It returns
the number of bytes written and any error encountered. The output will have
the same order as the input, no further sorting is performed. Furthermore,
this function assumes the input is already sanitized and does not perform any
sanity checks. If the input contains duplicate metrics or invalid metric or
label names, the conversion will result in invalid text format output.
<p>This function fulfills the type &apos;expfmt.encoder&apos;.
<p>Note that OpenMetrics requires a final `# EOF` line. Since this function acts
on individual metric families, it is the responsibility of the caller to
append this line to &apos;out&apos; once all metric families have been written.
Conveniently, this can be done by calling FinalizeOpenMetrics.
<p>The output should be fully OpenMetrics compliant. However, there are a few
missing features and peculiarities to avoid complications when switching from
Prometheus to OpenMetrics or vice versa:
<ul>
<li><p>Counters are expected to have the `_total` suffix in their metric name. In
the output, the suffix will be truncated from the `# TYPE` and `# HELP`
line. A counter with a missing `_total` suffix is not an error. However,
its type will be set to `unknown` in that case to avoid invalid OpenMetrics
output.
<li><p>No support for the following (optional) features: `# UNIT` line, `_created`
line, info type, stateset type, gaugehistogram type.
<li><p>The size of exemplar labels is not checked (i.e. it&apos;s possible to create
exemplars that are larger than allowed by the OpenMetrics specification).
<li><p>The value of Counters is not checked. (OpenMetrics doesn&apos;t allow counters
with a `NaN` value.)
</ul>

			
			

		
			
			
			<h2 id="MetricFamilyToText">func <a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/text_create.go?s=1854:1939#L56">MetricFamilyToText</a>
				<a class="permalink" href="index.html#MetricFamilyToText">&#xb6;</a>
				
				
			</h2>
			<pre>func MetricFamilyToText(out <a href="../../../../io/index.html">io</a>.<a href="../../../../io/index.html#Writer">Writer</a>, in *<a href="../../client_model/go/index.html">dto</a>.<a href="../../client_model/go/index.html#MetricFamily">MetricFamily</a>) (written <a href="../../../../builtin/index.html#int">int</a>, err <a href="../../../../builtin/index.html#error">error</a>)</pre>
			<p>MetricFamilyToText converts a MetricFamily proto message into text format and
writes the resulting lines to &apos;out&apos;. It returns the number of bytes written
and any error encountered. The output will have the same order as the input,
no further sorting is performed. Furthermore, this function assumes the input
is already sanitized and does not perform any sanity checks. If the input
contains duplicate metrics or invalid metric or label names, the conversion
will result in invalid text format output.
<p>This method fulfills the type &apos;prometheus.encoder&apos;.

			
			

		
		
			
			
			<h2 id="Closer">type <a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/encode.go?s=1493:1533#L30">Closer</a>
				<a class="permalink" href="index.html#Closer">&#xb6;</a>
				
				
			</h2>
			<p>Closer is implemented by Encoders that need to be closed to finalize
encoding. (For example, OpenMetrics needs a final `# EOF` line.)
<p>Note that all Encoder implementations returned from this package implement
Closer, too, even if the Close call is a no-op. This happens in preparation
for adding a Close method to the Encoder interface directly in a (mildly
breaking) release in the future.

			<pre>type Closer interface {
    Close() <a href="../../../../builtin/index.html#error">error</a>
}</pre>

			

			

			
			
			

			

			
		
			
			
			<h2 id="DecodeOptions">type <a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/decode.go?s=1009:1149#L25">DecodeOptions</a>
				<a class="permalink" href="index.html#DecodeOptions">&#xb6;</a>
				
				
			</h2>
			<p>DecodeOptions contains options used by the Decoder and in sample extraction.

			<pre>type DecodeOptions struct {
<span id="DecodeOptions.Timestamp"></span>    <span class="comment">// Timestamp is added to each value from the stream that has no explicit timestamp set.</span>
    Timestamp <a href="../model/index.html">model</a>.<a href="../model/index.html#Time">Time</a>
}
</pre>

			

			

			
			
			

			

			
		
			
			
			<h2 id="Decoder">type <a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/decode.go?s=868:927#L20">Decoder</a>
				<a class="permalink" href="index.html#Decoder">&#xb6;</a>
				
				
			</h2>
			<p>Decoder types decode an input stream into metric families.

			<pre>type Decoder interface {
    Decode(*<a href="../../client_model/go/index.html">dto</a>.<a href="../../client_model/go/index.html#MetricFamily">MetricFamily</a>) <a href="../../../../builtin/index.html#error">error</a>
}</pre>

			

			

			
			
			

			
				
				<h3 id="NewDecoder">func <a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/decode.go?s=2012:2063#L64">NewDecoder</a>
					<a class="permalink" href="index.html#NewDecoder">&#xb6;</a>
					
					
				</h3>
				<pre>func NewDecoder(r <a href="../../../../io/index.html">io</a>.<a href="../../../../io/index.html#Reader">Reader</a>, format <a href="index.html#Format">Format</a>) <a href="index.html#Decoder">Decoder</a></pre>
				<p>NewDecoder returns a new decoder based on the given input format.
If the input format does not imply otherwise, a text format decoder is returned.

				
				
			

			
		
			
			
			<h2 id="Encoder">type <a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/encode.go?s=1020:1079#L19">Encoder</a>
				<a class="permalink" href="index.html#Encoder">&#xb6;</a>
				
				
			</h2>
			<p>Encoder types encode metric families into an underlying wire protocol.

			<pre>type Encoder interface {
    Encode(*<a href="../../client_model/go/index.html">dto</a>.<a href="../../client_model/go/index.html#MetricFamily">MetricFamily</a>) <a href="../../../../builtin/index.html#error">error</a>
}</pre>

			

			

			
			
			

			
				
				<h3 id="NewEncoder">func <a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/encode.go?s=4025:4076#L105">NewEncoder</a>
					<a class="permalink" href="index.html#NewEncoder">&#xb6;</a>
					
					
				</h3>
				<pre>func NewEncoder(w <a href="../../../../io/index.html">io</a>.<a href="../../../../io/index.html#Writer">Writer</a>, format <a href="index.html#Format">Format</a>) <a href="index.html#Encoder">Encoder</a></pre>
				<p>NewEncoder returns a new encoder based on content type negotiation. All
Encoder implementations returned by NewEncoder also implement Closer, and
callers should always call the Close method. It is currently only required
for FmtOpenMetrics, but a future (breaking) release will add the Close method
to the Encoder interface directly. The current version of the Encoder
interface is kept for backwards compatibility.

				
				
			

			
		
			
			
			<h2 id="Format">type <a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/expfmt.go?s=761:779#L8">Format</a>
				<a class="permalink" href="index.html#Format">&#xb6;</a>
				
				
			</h2>
			<p>Format specifies the HTTP content type of the different wire protocols.

			<pre>type Format <a href="../../../../builtin/index.html#string">string</a></pre>

			

			

			
			
			

			
				
				<h3 id="Negotiate">func <a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/encode.go?s=2122:2158#L52">Negotiate</a>
					<a class="permalink" href="index.html#Negotiate">&#xb6;</a>
					
					
				</h3>
				<pre>func Negotiate(h <a href="../../../../net/http/index.html">http</a>.<a href="../../../../net/http/index.html#Header">Header</a>) <a href="index.html#Format">Format</a></pre>
				<p>Negotiate returns the Content-Type based on the given Accept header. If no
appropriate accepted type is found, FmtText is returned (which is the
Prometheus text format). This function will never negotiate FmtOpenMetrics,
as the support is still experimental. To include the option to negotiate
FmtOpenMetrics, use NegotiateOpenMetrics.

				
				
			
				
				<h3 id="NegotiateIncludingOpenMetrics">func <a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/encode.go?s=2925:2981#L76">NegotiateIncludingOpenMetrics</a>
					<a class="permalink" href="index.html#NegotiateIncludingOpenMetrics">&#xb6;</a>
					
					
				</h3>
				<pre>func NegotiateIncludingOpenMetrics(h <a href="../../../../net/http/index.html">http</a>.<a href="../../../../net/http/index.html#Header">Header</a>) <a href="index.html#Format">Format</a></pre>
				<p>NegotiateIncludingOpenMetrics works like Negotiate but includes
FmtOpenMetrics as an option for the result. Note that this function is
temporary and will disappear once FmtOpenMetrics is fully supported and as
such may be negotiated by the normal Negotiate function.

				
				
			
				
				<h3 id="ResponseFormat">func <a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/decode.go?s=1291:1332#L32">ResponseFormat</a>
					<a class="permalink" href="index.html#ResponseFormat">&#xb6;</a>
					
					
				</h3>
				<pre>func ResponseFormat(h <a href="../../../../net/http/index.html">http</a>.<a href="../../../../net/http/index.html#Header">Header</a>) <a href="index.html#Format">Format</a></pre>
				<p>ResponseFormat extracts the correct format from a HTTP response header.
If no matching format can be found FormatUnknown is returned.

				
				
			

			
		
			
			
			<h2 id="ParseError">type <a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/text_parse.go?s=1262:1311#L29">ParseError</a>
				<a class="permalink" href="index.html#ParseError">&#xb6;</a>
				
				
			</h2>
			<p>ParseError signals errors while parsing the simple and flat text-based
exchange format.

			<pre>type ParseError struct {
<span id="ParseError.Line"></span>    Line <a href="../../../../builtin/index.html#int">int</a>
<span id="ParseError.Msg"></span>    Msg  <a href="../../../../builtin/index.html#string">string</a>
}
</pre>

			

			

			
			
			

			

			
				
				<h3 id="ParseError.Error">func (ParseError) <a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/text_parse.go?s=1354:1388#L35">Error</a>
					<a class="permalink" href="index.html#ParseError.Error">&#xb6;</a>
					
					
				</h3>
				<pre>func (e <a href="index.html#ParseError">ParseError</a>) Error() <a href="../../../../builtin/index.html#string">string</a></pre>
				<p>Error implements the error interface.

				
				
				
			
		
			
			
			<h2 id="SampleDecoder">type <a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/decode.go?s=3735:3820#L134">SampleDecoder</a>
				<a class="permalink" href="index.html#SampleDecoder">&#xb6;</a>
				
				
			</h2>
			<p>SampleDecoder wraps a Decoder to extract samples from the metric families
decoded by the wrapped Decoder.

			<pre>type SampleDecoder struct {
<span id="SampleDecoder.Dec"></span>    Dec  <a href="index.html#Decoder">Decoder</a>
<span id="SampleDecoder.Opts"></span>    Opts *<a href="index.html#DecodeOptions">DecodeOptions</a>
    <span class="comment">// contains filtered or unexported fields</span>
}
</pre>

			

			

			
			
			

			

			
				
				<h3 id="SampleDecoder.Decode">func (*SampleDecoder) <a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/decode.go?s=3974:4028#L143">Decode</a>
					<a class="permalink" href="index.html#SampleDecoder.Decode">&#xb6;</a>
					
					
				</h3>
				<pre>func (sd *<a href="index.html#SampleDecoder">SampleDecoder</a>) Decode(s *<a href="../model/index.html">model</a>.<a href="../model/index.html#Vector">Vector</a>) <a href="../../../../builtin/index.html#error">error</a></pre>
				<p>Decode calls the Decode method of the wrapped Decoder and then extracts the
samples from the decoded MetricFamily into the provided model.Vector.

				
				
				
			
		
			
			
			<h2 id="TextParser">type <a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/text_parse.go?s=1587:2898#L41">TextParser</a>
				<a class="permalink" href="index.html#TextParser">&#xb6;</a>
				
				
			</h2>
			<p>TextParser is used to parse the simple and flat text-based exchange format. Its
zero value is ready to use.

			<pre>type TextParser struct {
    <span class="comment">// contains filtered or unexported fields</span>
}
</pre>

			

			

			
			
			

			

			
				
				<h3 id="TextParser.TextToMetricFamilies">func (*TextParser) <a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/text_parse.go?s=4336:4429#L90">TextToMetricFamilies</a>
					<a class="permalink" href="index.html#TextParser.TextToMetricFamilies">&#xb6;</a>
					
					
				</h3>
				<pre>func (p *<a href="index.html#TextParser">TextParser</a>) TextToMetricFamilies(in <a href="../../../../io/index.html">io</a>.<a href="../../../../io/index.html#Reader">Reader</a>) (map[<a href="../../../../builtin/index.html#string">string</a>]*<a href="../../client_model/go/index.html">dto</a>.<a href="../../client_model/go/index.html#MetricFamily">MetricFamily</a>, <a href="../../../../builtin/index.html#error">error</a>)</pre>
				<p>TextToMetricFamilies reads &apos;in&apos; as the simple and flat text-based exchange
format and creates MetricFamily proto messages. It returns the MetricFamily
proto messages in a map where the metric names are the keys, along with any
error encountered.
<p>If the input contains duplicate metrics (i.e. lines with the same metric name
and exactly the same label set), the resulting MetricFamily will contain
duplicate Metric proto messages. Similar is true for duplicate label
names. Checks for duplicates have to be performed separately, if required.
Also note that neither the metrics within each MetricFamily are sorted nor
the label pairs within each Metric. Sorting is not required for the most
frequent use of this method, which is sample ingestion in the Prometheus
server. However, for presentation purposes, you might want to sort the
metrics, and in some cases, you must sort the labels, e.g. for consumption by
the metric family injection hook of the Prometheus registry.
<p>Summaries and histograms are rather special beasts. You would probably not
use them in the simple text format anyway. This method can deal with
summaries and histograms if they are presented in exactly the way the
text.Create function creates them.
<p>This method must not be called concurrently. If you want to parse different
input concurrently, instantiate a separate Parser for each goroutine.

				
				
				
			
		
	

	
		
			<h2 id="pkg-note-BUG">Bugs</h2>
			<ul style="list-style: none; padding: 0;">
			
			<li><a href="http://localhost:6060/src/github.com/prometheus/common/expfmt/decode.go?s=7923:7970#L299" style="float: left;">&#x261e;</a> <p>Update other names to &quot;quantile&quot;.
</li>
			
			</ul>
		
	







<div id="footer">
Build version go1.19.10.<br>
Except as <a href="https://developers.google.com/site-policies#restrictions">noted</a>,
the content of this page is licensed under the
Creative Commons Attribution 3.0 License,
and code is licensed under a <a href="http://localhost:6060/LICENSE">BSD license</a>.<br>
<a href="https://golang.org/doc/tos.html">Terms of Service</a> |
<a href="https://www.google.com/intl/en/policies/privacy/">Privacy Policy</a>
</div>

</div><!-- .container -->
</div><!-- #page -->
</body>
</html>
