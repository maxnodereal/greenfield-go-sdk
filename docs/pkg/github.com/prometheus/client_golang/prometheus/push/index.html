<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#375EAB">

  <title>push - Go Documentation Server</title>

<link type="text/css" rel="stylesheet" href="../../../../../../lib/godoc/style.css">

<script>window.initFuncs = [];</script>
<script src="../../../../../../lib/godoc/jquery.js" defer></script>



<script>var goVersion = "go1.19.10";</script>
<script src="../../../../../../lib/godoc/godocs.js" defer></script>
</head>
<body>

<div id='lowframe' style="position: fixed; bottom: 0; left: 0; height: 0; width: 100%; border-top: thin solid grey; background-color: white; overflow: auto;">
...
</div><!-- #lowframe -->

<div id="topbar" class="wide"><div class="container">
<div class="top-heading" id="heading-wide"><a href="http://localhost:6060/pkg/">Go Documentation Server</a></div>
<div class="top-heading" id="heading-narrow"><a href="http://localhost:6060/pkg/">GoDoc</a></div>
<a href="index.html#" id="menu-button"><span id="menu-button-arrow">&#9661;</span></a>
<form method="GET" action="http://localhost:6060/search">
<div id="menu">

<span class="search-box"><input type="search" id="search" name="q" placeholder="Search" aria-label="Search" required><button type="submit"><span><!-- magnifying glass: --><svg width="24" height="24" viewBox="0 0 24 24"><title>submit search</title><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/><path d="M0 0h24v24H0z" fill="none"/></svg></span></button></span>
</div>
</form>

</div></div>



<div id="page" class="wide">
<div class="container">


  <h1>
    Package push
    <span class="text-muted"></span>
  </h1>







<div id="nav"></div>


<!--
	Copyright 2009 The Go Authors. All rights reserved.
	Use of this source code is governed by a BSD-style
	license that can be found in the LICENSE file.
-->
<!--
	Note: Static (i.e., not template-generated) href and id
	attributes start with "pkg-" to make it impossible for
	them to conflict with generated attributes (some of which
	correspond to Go identifiers).
-->

	<script>
	document.ANALYSIS_DATA = null;
	document.CALLGRAPH = null;
	</script>

	
		
		<div id="short-nav">
			<dl>
			<dd><code>import "github.com/prometheus/client_golang/prometheus/push"</code></dd>
			</dl>
			<dl>
			<dd><a href="index.html#pkg-overview" class="overviewLink">Overview</a></dd>
			<dd><a href="index.html#pkg-index" class="indexLink">Index</a></dd>
			
				<dd><a href="index.html#pkg-examples" class="examplesLink">Examples</a></dd>
			
			
			</dl>
		</div>
		<!-- The package's Name is printed as title by the top-level template -->
		<div id="pkg-overview" class="toggleVisible">
			<div class="collapsed">
				<h2 class="toggleButton" title="Click to show Overview section">Overview ▹</h2>
			</div>
			<div class="expanded">
				<h2 class="toggleButton" title="Click to hide Overview section">Overview ▾</h2>
				<p>Package push provides functions to push metrics to a Pushgateway. It uses a
builder approach. Create a Pusher with New and then add the various options
by using its methods, finally calling Add or Push, like this:
<pre>// Easy case:
push.New(&quot;http://example.org/metrics&quot;, &quot;my_job&quot;).Gatherer(myRegistry).Push()

// Complex case:
push.New(&quot;http://example.org/metrics&quot;, &quot;my_job&quot;).
    Collector(myCollector1).
    Collector(myCollector2).
    Grouping(&quot;zone&quot;, &quot;xy&quot;).
    Client(&amp;myHTTPClient).
    BasicAuth(&quot;top&quot;, &quot;secret&quot;).
    Add()
</pre>
<p>See the examples section for more detailed examples.
<p>See the documentation of the Pushgateway to understand the meaning of
the grouping key and the differences between Push and Add:
<a href="https://github.com/prometheus/pushgateway">https://github.com/prometheus/pushgateway</a>

				
			</div>
		</div>

		<div id="pkg-index" class="toggleVisible">
		<div class="collapsed">
			<h2 class="toggleButton" title="Click to show Index section">Index ▹</h2>
		</div>
		<div class="expanded">
			<h2 class="toggleButton" title="Click to hide Index section">Index ▾</h2>

		<!-- Table of contents for API; must be named manual-nav to turn off auto nav. -->
			<div id="manual-nav">
			<dl>
			
			
			
			
				
				<dd><a href="index.html#HTTPDoer">type HTTPDoer</a></dd>
				
				
			
				
				<dd><a href="index.html#Pusher">type Pusher</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#New">func New(url, job string) *Pusher</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Pusher.Add">func (p *Pusher) Add() error</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Pusher.AddContext">func (p *Pusher) AddContext(ctx context.Context) error</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Pusher.BasicAuth">func (p *Pusher) BasicAuth(username, password string) *Pusher</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Pusher.Client">func (p *Pusher) Client(c HTTPDoer) *Pusher</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Pusher.Collector">func (p *Pusher) Collector(c prometheus.Collector) *Pusher</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Pusher.Delete">func (p *Pusher) Delete() error</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Pusher.Error">func (p *Pusher) Error() error</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Pusher.Format">func (p *Pusher) Format(format expfmt.Format) *Pusher</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Pusher.Gatherer">func (p *Pusher) Gatherer(g prometheus.Gatherer) *Pusher</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Pusher.Grouping">func (p *Pusher) Grouping(name, value string) *Pusher</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Pusher.Header">func (p *Pusher) Header(header http.Header) *Pusher</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Pusher.Push">func (p *Pusher) Push() error</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Pusher.PushContext">func (p *Pusher) PushContext(ctx context.Context) error</a></dd>
				
			
			
			</dl>
			</div><!-- #manual-nav -->

		
		<div id="pkg-examples">
			<h3>Examples</h3>
			<div class="js-expandAll expandAll collapsed">(Expand All)</div>
			<dl>
			
			<dd><a class="exampleLink" href="index.html#example_Pusher_Add">Pusher.Add</a></dd>
			
			<dd><a class="exampleLink" href="index.html#example_Pusher_Push">Pusher.Push</a></dd>
			
			</dl>
		</div>
		

		
			<h3>Package files</h3>
			<p>
			<span style="font-size:90%">
			
				<a href="http://localhost:6060/src/github.com/prometheus/client_golang/prometheus/push/push.go">push.go</a>
			
			</span>
			</p>
		
		</div><!-- .expanded -->
		</div><!-- #pkg-index -->

		

		
		
		
		
			
			
			<h2 id="HTTPDoer">type <a href="http://localhost:6060/src/github.com/prometheus/client_golang/prometheus/push/push.go?s=1993:2063#L54">HTTPDoer</a>
				<a class="permalink" href="index.html#HTTPDoer">&#xb6;</a>
				
				
			</h2>
			<p>HTTPDoer is an interface for the one method of http.Client that is used by Pusher

			<pre>type HTTPDoer interface {
    Do(*<a href="../../../../../net/http/index.html">http</a>.<a href="../../../../../net/http/index.html#Request">Request</a>) (*<a href="../../../../../net/http/index.html">http</a>.<a href="../../../../../net/http/index.html#Response">Response</a>, <a href="../../../../../builtin/index.html#error">error</a>)
}</pre>

			

			

			
			
			

			

			
		
			
			
			<h2 id="Pusher">type <a href="http://localhost:6060/src/github.com/prometheus/client_golang/prometheus/push/push.go?s=2215:2501#L60">Pusher</a>
				<a class="permalink" href="index.html#Pusher">&#xb6;</a>
				
				
			</h2>
			<p>Pusher manages a push to the Pushgateway. Use New to create one, configure it
with its methods, and finally use the Add or Push method to push.

			<pre>type Pusher struct {
    <span class="comment">// contains filtered or unexported fields</span>
}
</pre>

			

			

			
			
			

			
				
				<h3 id="New">func <a href="http://localhost:6060/src/github.com/prometheus/client_golang/prometheus/push/push.go?s=2824:2857#L81">New</a>
					<a class="permalink" href="index.html#New">&#xb6;</a>
					
					
				</h3>
				<pre>func New(url, job <a href="../../../../../builtin/index.html#string">string</a>) *<a href="index.html#Pusher">Pusher</a></pre>
				<p>New creates a new Pusher to push to the provided URL with the provided job
name (which must not be empty). You can use just host:port or ip:port as url,
in which case “http://” is added automatically. Alternatively, include the
schema in the URL. However, do not include the “/metrics/jobs/…” part.

				
				
			

			
				
				<h3 id="Pusher.Add">func (*Pusher) <a href="http://localhost:6060/src/github.com/prometheus/client_golang/prometheus/push/push.go?s=4398:4426#L129">Add</a>
					<a class="permalink" href="index.html#Pusher.Add">&#xb6;</a>
					
					
				</h3>
				<pre>func (p *<a href="index.html#Pusher">Pusher</a>) Add() <a href="../../../../../builtin/index.html#error">error</a></pre>
				<p>Add works like push, but only previously pushed metrics with the same name
(and the same job and other grouping labels) will be replaced. (It uses HTTP
method “POST” to push to the Pushgateway.)

				
				<div id="example_Pusher_Add" class="toggle">
	<div class="collapsed">
		<p class="exampleHeading toggleButton">▹ <span class="text">Example</span></p>
	</div>
	<div class="expanded">
		<p class="exampleHeading toggleButton">▾ <span class="text">Example</span></p>
		
		
		
			<p>Code:</p>
			<pre class="code">package push_test

import (
    &#34;fmt&#34;
    &#34;time&#34;

    &#34;github.com/prometheus/client_golang/prometheus&#34;
    &#34;github.com/prometheus/client_golang/prometheus/push&#34;
)

var (
    completionTime = prometheus.NewGauge(prometheus.GaugeOpts{
        Name: &#34;db_backup_last_completion_timestamp_seconds&#34;,
        Help: &#34;The timestamp of the last completion of a DB backup, successful or not.&#34;,
    })
    successTime = prometheus.NewGauge(prometheus.GaugeOpts{
        Name: &#34;db_backup_last_success_timestamp_seconds&#34;,
        Help: &#34;The timestamp of the last successful completion of a DB backup.&#34;,
    })
    duration = prometheus.NewGauge(prometheus.GaugeOpts{
        Name: &#34;db_backup_duration_seconds&#34;,
        Help: &#34;The duration of the last DB backup in seconds.&#34;,
    })
    records = prometheus.NewGauge(prometheus.GaugeOpts{
        Name: &#34;db_backup_records_processed&#34;,
        Help: &#34;The number of records processed in the last DB backup.&#34;,
    })
)

func performBackup() (int, error) {
    <span class="comment">// Perform the backup and return the number of backed up records and any</span>
    <span class="comment">// applicable error.</span>
    <span class="comment">// ...</span>
    return 42, nil
}

func ExamplePusher_Add() {
    <span class="comment">// We use a registry here to benefit from the consistency checks that</span>
    <span class="comment">// happen during registration.</span>
    registry := prometheus.NewRegistry()
    registry.MustRegister(completionTime, duration, records)
    <span class="comment">// Note that successTime is not registered.</span>

    pusher := push.New(&#34;http://pushgateway:9091&#34;, &#34;db_backup&#34;).Gatherer(registry)

    start := time.Now()
    n, err := performBackup()
    records.Set(float64(n))
    <span class="comment">// Note that time.Since only uses a monotonic clock in Go1.9+.</span>
    duration.Set(time.Since(start).Seconds())
    completionTime.SetToCurrentTime()
    if err != nil {
        fmt.Println(&#34;DB backup failed:&#34;, err)
    } else {
        <span class="comment">// Add successTime to pusher only in case of success.</span>
        <span class="comment">// We could as well register it with the registry.</span>
        <span class="comment">// This example, however, demonstrates that you can</span>
        <span class="comment">// mix Gatherers and Collectors when handling a Pusher.</span>
        pusher.Collector(successTime)
        successTime.SetToCurrentTime()
    }
    <span class="comment">// Add is used here rather than Push to not delete a previously pushed</span>
    <span class="comment">// success timestamp in case of a failure of this backup.</span>
    if err := pusher.Add(); err != nil {
        fmt.Println(&#34;Could not push to Pushgateway:&#34;, err)
    }
}
</pre>
			
		
	</div>
</div>

				
			
				
				<h3 id="Pusher.AddContext">func (*Pusher) <a href="http://localhost:6060/src/github.com/prometheus/client_golang/prometheus/push/push.go?s=4620:4674#L136">AddContext</a>
					<a class="permalink" href="index.html#Pusher.AddContext">&#xb6;</a>
					
					
				</h3>
				<pre>func (p *<a href="index.html#Pusher">Pusher</a>) AddContext(ctx <a href="../../../../../context/index.html">context</a>.<a href="../../../../../context/index.html#Context">Context</a>) <a href="../../../../../builtin/index.html#error">error</a></pre>
				<p>AddContext is like Add but includes a context.
<p>If the context expires before HTTP request is complete, an error is returned.

				
				
				
			
				
				<h3 id="Pusher.BasicAuth">func (*Pusher) <a href="http://localhost:6060/src/github.com/prometheus/client_golang/prometheus/push/push.go?s=7064:7125#L205">BasicAuth</a>
					<a class="permalink" href="index.html#Pusher.BasicAuth">&#xb6;</a>
					
					
				</h3>
				<pre>func (p *<a href="index.html#Pusher">Pusher</a>) BasicAuth(username, password <a href="../../../../../builtin/index.html#string">string</a>) *<a href="index.html#Pusher">Pusher</a></pre>
				<p>BasicAuth configures the Pusher to use HTTP Basic Authentication with the
provided username and password. For convenience, this method returns a
pointer to the Pusher itself.

				
				
				
			
				
				<h3 id="Pusher.Client">func (*Pusher) <a href="http://localhost:6060/src/github.com/prometheus/client_golang/prometheus/push/push.go?s=6588:6631#L190">Client</a>
					<a class="permalink" href="index.html#Pusher.Client">&#xb6;</a>
					
					
				</h3>
				<pre>func (p *<a href="index.html#Pusher">Pusher</a>) Client(c <a href="index.html#HTTPDoer">HTTPDoer</a>) *<a href="index.html#Pusher">Pusher</a></pre>
				<p>Client sets a custom HTTP client for the Pusher. For convenience, this method
returns a pointer to the Pusher itself.
Pusher only needs one method of the custom HTTP client: Do(*http.Request).
Thus, rather than requiring a fully fledged http.Client,
the provided client only needs to implement the HTTPDoer interface.
Since *http.Client naturally implements that interface, it can still be used normally.

				
				
				
			
				
				<h3 id="Pusher.Collector">func (*Pusher) <a href="http://localhost:6060/src/github.com/prometheus/client_golang/prometheus/push/push.go?s=5345:5403#L155">Collector</a>
					<a class="permalink" href="index.html#Pusher.Collector">&#xb6;</a>
					
					
				</h3>
				<pre>func (p *<a href="index.html#Pusher">Pusher</a>) Collector(c <a href="../index.html">prometheus</a>.<a href="../index.html#Collector">Collector</a>) *<a href="index.html#Pusher">Pusher</a></pre>
				<p>Collector adds a Collector to the Pusher, from which metrics will be
collected to push them to the Pushgateway. The collected metrics must not
contain a job label of their own.
<p>For convenience, this method returns a pointer to the Pusher itself.

				
				
				
			
				
				<h3 id="Pusher.Delete">func (*Pusher) <a href="http://localhost:6060/src/github.com/prometheus/client_golang/prometheus/push/push.go?s=8022:8053#L229">Delete</a>
					<a class="permalink" href="index.html#Pusher.Delete">&#xb6;</a>
					
					
				</h3>
				<pre>func (p *<a href="index.html#Pusher">Pusher</a>) Delete() <a href="../../../../../builtin/index.html#error">error</a></pre>
				<p>Delete sends a “DELETE” request to the Pushgateway configured while creating
this Pusher, using the configured job name and any added grouping labels as
grouping key. Any added Gatherers and Collectors added to this Pusher are
ignored by this method.
<p>Delete returns the first error encountered by any method call (including this
one) in the lifetime of the Pusher.

				
				
				
			
				
				<h3 id="Pusher.Error">func (*Pusher) <a href="http://localhost:6060/src/github.com/prometheus/client_golang/prometheus/push/push.go?s=5529:5559#L163">Error</a>
					<a class="permalink" href="index.html#Pusher.Error">&#xb6;</a>
					
					
				</h3>
				<pre>func (p *<a href="index.html#Pusher">Pusher</a>) Error() <a href="../../../../../builtin/index.html#error">error</a></pre>
				<p>Error returns the error that was encountered.

				
				
				
			
				
				<h3 id="Pusher.Format">func (*Pusher) <a href="http://localhost:6060/src/github.com/prometheus/client_golang/prometheus/push/push.go?s=7544:7597#L217">Format</a>
					<a class="permalink" href="index.html#Pusher.Format">&#xb6;</a>
					
					
				</h3>
				<pre>func (p *<a href="index.html#Pusher">Pusher</a>) Format(format <a href="../../../common/expfmt/index.html">expfmt</a>.<a href="../../../common/expfmt/index.html#Format">Format</a>) *<a href="index.html#Pusher">Pusher</a></pre>
				<p>Format configures the Pusher to use an encoding format given by the
provided expfmt.Format. The default format is expfmt.FmtProtoDelim and
should be used with the standard Prometheus Pushgateway. Custom
implementations may require different formats. For convenience, this
method returns a pointer to the Pusher itself.

				
				
				
			
				
				<h3 id="Pusher.Gatherer">func (*Pusher) <a href="http://localhost:6060/src/github.com/prometheus/client_golang/prometheus/push/push.go?s=4974:5030#L145">Gatherer</a>
					<a class="permalink" href="index.html#Pusher.Gatherer">&#xb6;</a>
					
					
				</h3>
				<pre>func (p *<a href="index.html#Pusher">Pusher</a>) Gatherer(g <a href="../index.html">prometheus</a>.<a href="../index.html#Gatherer">Gatherer</a>) *<a href="index.html#Pusher">Pusher</a></pre>
				<p>Gatherer adds a Gatherer to the Pusher, from which metrics will be gathered
to push them to the Pushgateway. The gathered metrics must not contain a job
label of their own.
<p>For convenience, this method returns a pointer to the Pusher itself.

				
				
				
			
				
				<h3 id="Pusher.Grouping">func (*Pusher) <a href="http://localhost:6060/src/github.com/prometheus/client_golang/prometheus/push/push.go?s=5920:5973#L173">Grouping</a>
					<a class="permalink" href="index.html#Pusher.Grouping">&#xb6;</a>
					
					
				</h3>
				<pre>func (p *<a href="index.html#Pusher">Pusher</a>) Grouping(name, value <a href="../../../../../builtin/index.html#string">string</a>) *<a href="index.html#Pusher">Pusher</a></pre>
				<p>Grouping adds a label pair to the grouping key of the Pusher, replacing any
previously added label pair with the same label name. Note that setting any
labels in the grouping key that are already contained in the metrics to push
will lead to an error.
<p>For convenience, this method returns a pointer to the Pusher itself.

				
				
				
			
				
				<h3 id="Pusher.Header">func (*Pusher) <a href="http://localhost:6060/src/github.com/prometheus/client_golang/prometheus/push/push.go?s=6794:6845#L197">Header</a>
					<a class="permalink" href="index.html#Pusher.Header">&#xb6;</a>
					
					
				</h3>
				<pre>func (p *<a href="index.html#Pusher">Pusher</a>) Header(header <a href="../../../../../net/http/index.html">http</a>.<a href="../../../../../net/http/index.html#Header">Header</a>) *<a href="index.html#Pusher">Pusher</a></pre>
				<p>Header sets a custom HTTP header for the Pusher&apos;s client. For convenience, this method
returns a pointer to the Pusher itself.

				
				
				
			
				
				<h3 id="Pusher.Push">func (*Pusher) <a href="http://localhost:6060/src/github.com/prometheus/client_golang/prometheus/push/push.go?s=3869:3898#L115">Push</a>
					<a class="permalink" href="index.html#Pusher.Push">&#xb6;</a>
					
					
				</h3>
				<pre>func (p *<a href="index.html#Pusher">Pusher</a>) Push() <a href="../../../../../builtin/index.html#error">error</a></pre>
				<p>Push collects/gathers all metrics from all Collectors and Gatherers added to
this Pusher. Then, it pushes them to the Pushgateway configured while
creating this Pusher, using the configured job name and any added grouping
labels as grouping key. All previously pushed metrics with the same job and
other grouping labels will be replaced with the metrics pushed by this
call. (It uses HTTP method “PUT” to push to the Pushgateway.)
<p>Push returns the first error encountered by any method call (including this
one) in the lifetime of the Pusher.

				
				<div id="example_Pusher_Push" class="toggle">
	<div class="collapsed">
		<p class="exampleHeading toggleButton">▹ <span class="text">Example</span></p>
	</div>
	<div class="expanded">
		<p class="exampleHeading toggleButton">▾ <span class="text">Example</span></p>
		
		
		
			<p>Code:</p>
			<pre class="code">
completionTime := prometheus.NewGauge(prometheus.GaugeOpts{
    Name: &#34;db_backup_last_completion_timestamp_seconds&#34;,
    Help: &#34;The timestamp of the last successful completion of a DB backup.&#34;,
})
completionTime.SetToCurrentTime()
if err := push.New(&#34;http://pushgateway:9091&#34;, &#34;db_backup&#34;).
    Collector(completionTime).
    Grouping(&#34;db&#34;, &#34;customers&#34;).
    Push(); err != nil {
    fmt.Println(&#34;Could not push completion time to Pushgateway:&#34;, err)
}
</pre>
			
		
	</div>
</div>

				
			
				
				<h3 id="Pusher.PushContext">func (*Pusher) <a href="http://localhost:6060/src/github.com/prometheus/client_golang/prometheus/push/push.go?s=4093:4148#L122">PushContext</a>
					<a class="permalink" href="index.html#Pusher.PushContext">&#xb6;</a>
					
					
				</h3>
				<pre>func (p *<a href="index.html#Pusher">Pusher</a>) PushContext(ctx <a href="../../../../../context/index.html">context</a>.<a href="../../../../../context/index.html#Context">Context</a>) <a href="../../../../../builtin/index.html#error">error</a></pre>
				<p>PushContext is like Push but includes a context.
<p>If the context expires before HTTP request is complete, an error is returned.

				
				
				
			
		
	

	







<div id="footer">
Build version go1.19.10.<br>
Except as <a href="https://developers.google.com/site-policies#restrictions">noted</a>,
the content of this page is licensed under the
Creative Commons Attribution 3.0 License,
and code is licensed under a <a href="http://localhost:6060/LICENSE">BSD license</a>.<br>
<a href="https://golang.org/doc/tos.html">Terms of Service</a> |
<a href="https://www.google.com/intl/en/policies/privacy/">Privacy Policy</a>
</div>

</div><!-- .container -->
</div><!-- #page -->
</body>
</html>
