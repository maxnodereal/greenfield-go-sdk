<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#375EAB">

  <title>pruning - Go Documentation Server</title>

<link type="text/css" rel="stylesheet" href="../../../../../../lib/godoc/style.css">

<script>window.initFuncs = [];</script>
<script src="../../../../../../lib/godoc/jquery.js" defer></script>



<script>var goVersion = "go1.19.10";</script>
<script src="../../../../../../lib/godoc/godocs.js" defer></script>
</head>
<body>

<div id='lowframe' style="position: fixed; bottom: 0; left: 0; height: 0; width: 100%; border-top: thin solid grey; background-color: white; overflow: auto;">
...
</div><!-- #lowframe -->

<div id="topbar" class="wide"><div class="container">
<div class="top-heading" id="heading-wide"><a href="http://localhost:6060/pkg/">Go Documentation Server</a></div>
<div class="top-heading" id="heading-narrow"><a href="http://localhost:6060/pkg/">GoDoc</a></div>
<a href="index.html#" id="menu-button"><span id="menu-button-arrow">&#9661;</span></a>
<form method="GET" action="http://localhost:6060/search">
<div id="menu">

<span class="search-box"><input type="search" id="search" name="q" placeholder="Search" aria-label="Search" required><button type="submit"><span><!-- magnifying glass: --><svg width="24" height="24" viewBox="0 0 24 24"><title>submit search</title><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/><path d="M0 0h24v24H0z" fill="none"/></svg></span></button></span>
</div>
</form>

</div></div>



<div id="page" class="wide">
<div class="container">


  <h1>
    Package pruning
    <span class="text-muted"></span>
  </h1>







<div id="nav"></div>


<!--
	Copyright 2009 The Go Authors. All rights reserved.
	Use of this source code is governed by a BSD-style
	license that can be found in the LICENSE file.
-->
<!--
	Note: Static (i.e., not template-generated) href and id
	attributes start with "pkg-" to make it impossible for
	them to conflict with generated attributes (some of which
	correspond to Go identifiers).
-->

	<script>
	document.ANALYSIS_DATA = null;
	document.CALLGRAPH = null;
	</script>

	
		
		<div id="short-nav">
			<dl>
			<dd><code>import "github.com/cosmos/cosmos-sdk/store/pruning"</code></dd>
			</dl>
			<dl>
			<dd><a href="index.html#pkg-overview" class="overviewLink">Overview</a></dd>
			<dd><a href="index.html#pkg-index" class="indexLink">Index</a></dd>
			
			
				<dd><a href="index.html#pkg-subdirectories">Subdirectories</a></dd>
			
			</dl>
		</div>
		<!-- The package's Name is printed as title by the top-level template -->
		<div id="pkg-overview" class="toggleVisible">
			<div class="collapsed">
				<h2 class="toggleButton" title="Click to show Overview section">Overview ▹</h2>
			</div>
			<div class="expanded">
				<h2 class="toggleButton" title="Click to hide Overview section">Overview ▾</h2>
				
				
			</div>
		</div>

		<div id="pkg-index" class="toggleVisible">
		<div class="collapsed">
			<h2 class="toggleButton" title="Click to show Index section">Index ▹</h2>
		</div>
		<div class="expanded">
			<h2 class="toggleButton" title="Click to hide Index section">Index ▾</h2>

		<!-- Table of contents for API; must be named manual-nav to turn off auto nav. -->
			<div id="manual-nav">
			<dl>
			
			
			
			
				
				<dd><a href="index.html#Manager">type Manager</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#NewManager">func NewManager(db dbm.DB, logger log.Logger) *Manager</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Manager.GetFlushAndResetPruningHeights">func (m *Manager) GetFlushAndResetPruningHeights() ([]int64, error)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Manager.GetOptions">func (m *Manager) GetOptions() types.PruningOptions</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Manager.HandleHeight">func (m *Manager) HandleHeight(previousHeight int64) int64</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Manager.HandleHeightSnapshot">func (m *Manager) HandleHeightSnapshot(height int64)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Manager.LoadPruningHeights">func (m *Manager) LoadPruningHeights(db dbm.DB) error</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Manager.SetOptions">func (m *Manager) SetOptions(opts types.PruningOptions)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Manager.SetSnapshotInterval">func (m *Manager) SetSnapshotInterval(snapshotInterval uint64)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Manager.ShouldPruneAtHeight">func (m *Manager) ShouldPruneAtHeight(height int64) bool</a></dd>
				
			
				
				<dd><a href="index.html#NegativeHeightsError">type NegativeHeightsError</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#NegativeHeightsError.Error">func (e *NegativeHeightsError) Error() string</a></dd>
				
			
			
			</dl>
			</div><!-- #manual-nav -->

		

		
			<h3>Package files</h3>
			<p>
			<span style="font-size:90%">
			
				<a href="http://localhost:6060/src/github.com/cosmos/cosmos-sdk/store/pruning/manager.go">manager.go</a>
			
			</span>
			</p>
		
		</div><!-- .expanded -->
		</div><!-- #pkg-index -->

		

		
		
		
		
			
			
			<h2 id="Manager">type <a href="http://localhost:6060/src/github.com/cosmos/cosmos-sdk/store/pruning/manager.go?s=388:1223#L8">Manager</a>
				<a class="permalink" href="index.html#Manager">&#xb6;</a>
				
				
			</h2>
			<p>Manager is an abstraction to handle the logic needed for
determining when to prune old heights of the store
based on the strategy described by the pruning options.

			<pre>type Manager struct {
    <span class="comment">// contains filtered or unexported fields</span>
}
</pre>

			

			

			
			
			

			
				
				<h3 id="NewManager">func <a href="http://localhost:6060/src/github.com/cosmos/cosmos-sdk/store/pruning/manager.go?s=1866:1920#L46">NewManager</a>
					<a class="permalink" href="index.html#NewManager">&#xb6;</a>
					
					
				</h3>
				<pre>func NewManager(db <a href="../../../../cometbft/cometbft-db/index.html">dbm</a>.<a href="../../../../cometbft/cometbft-db/index.html#DB">DB</a>, logger <a href="../../../../cometbft/cometbft/libs/log/index.html">log</a>.<a href="../../../../cometbft/cometbft/libs/log/index.html#Logger">Logger</a>) *<a href="index.html#Manager">Manager</a></pre>
				<p>NewManager returns a new Manager with the given db and logger.
The retuned manager uses a pruning strategy of &quot;nothing&quot; which
keeps all heights. Users of the Manager may change the strategy
by calling SetOptions.

				
				
			

			
				
				<h3 id="Manager.GetFlushAndResetPruningHeights">func (*Manager) <a href="http://localhost:6060/src/github.com/cosmos/cosmos-sdk/store/pruning/manager.go?s=2565:2632#L68">GetFlushAndResetPruningHeights</a>
					<a class="permalink" href="index.html#Manager.GetFlushAndResetPruningHeights">&#xb6;</a>
					
					
				</h3>
				<pre>func (m *<a href="index.html#Manager">Manager</a>) GetFlushAndResetPruningHeights() ([]<a href="../../../../../builtin/index.html#int64">int64</a>, <a href="../../../../../builtin/index.html#error">error</a>)</pre>
				<p>GetFlushAndResetPruningHeights returns all heights to be pruned during the next call to Prune().
It also flushes and resets the pruning heights.

				
				
				
			
				
				<h3 id="Manager.GetOptions">func (*Manager) <a href="http://localhost:6060/src/github.com/cosmos/cosmos-sdk/store/pruning/manager.go?s=2342:2393#L62">GetOptions</a>
					<a class="permalink" href="index.html#Manager.GetOptions">&#xb6;</a>
					
					
				</h3>
				<pre>func (m *<a href="index.html#Manager">Manager</a>) GetOptions() <a href="types/index.html">types</a>.<a href="types/index.html#PruningOptions">PruningOptions</a></pre>
				<p>GetOptions fetches the pruning strategy from the manager.

				
				
				
			
				
				<h3 id="Manager.HandleHeight">func (*Manager) <a href="http://localhost:6060/src/github.com/cosmos/cosmos-sdk/store/pruning/manager.go?s=3653:3711#L92">HandleHeight</a>
					<a class="permalink" href="index.html#Manager.HandleHeight">&#xb6;</a>
					
					
				</h3>
				<pre>func (m *<a href="index.html#Manager">Manager</a>) HandleHeight(previousHeight <a href="../../../../../builtin/index.html#int64">int64</a>) <a href="../../../../../builtin/index.html#int64">int64</a></pre>
				<p>HandleHeight determines if previousHeight height needs to be kept for pruning at the right interval prescribed by
the pruning strategy. Returns previousHeight, if it was kept to be pruned at the next call to Prune(), 0 otherwise.
previousHeight must be greater than 0 for the handling to take effect since valid heights start at 1 and 0 represents
the latest height. The latest height cannot be pruned. As a result, if previousHeight is less than or equal to 0, 0 is returned.

				
				
				
			
				
				<h3 id="Manager.HandleHeightSnapshot">func (*Manager) <a href="http://localhost:6060/src/github.com/cosmos/cosmos-sdk/store/pruning/manager.go?s=5628:5680#L148">HandleHeightSnapshot</a>
					<a class="permalink" href="index.html#Manager.HandleHeightSnapshot">&#xb6;</a>
					
					
				</h3>
				<pre>func (m *<a href="index.html#Manager">Manager</a>) HandleHeightSnapshot(height <a href="../../../../../builtin/index.html#int64">int64</a>)</pre>
				<p>HandleHeightSnapshot persists the snapshot height to be pruned at the next appropriate
height defined by the pruning strategy. Flushes the update to disk and panics if the flush fails
The input height must be greater than 0 and pruning strategy any but pruning nothing.
If one of these conditions is not met, this function does nothing.

				
				
				
			
				
				<h3 id="Manager.LoadPruningHeights">func (*Manager) <a href="http://localhost:6060/src/github.com/cosmos/cosmos-sdk/store/pruning/manager.go?s=6678:6731#L176">LoadPruningHeights</a>
					<a class="permalink" href="index.html#Manager.LoadPruningHeights">&#xb6;</a>
					
					
				</h3>
				<pre>func (m *<a href="index.html#Manager">Manager</a>) LoadPruningHeights(db <a href="../../../../cometbft/cometbft-db/index.html">dbm</a>.<a href="../../../../cometbft/cometbft-db/index.html#DB">DB</a>) <a href="../../../../../builtin/index.html#error">error</a></pre>
				<p>LoadPruningHeights loads the pruning heights from the database as a crash recovery.

				
				
				
			
				
				<h3 id="Manager.SetOptions">func (*Manager) <a href="http://localhost:6060/src/github.com/cosmos/cosmos-sdk/store/pruning/manager.go?s=2205:2260#L57">SetOptions</a>
					<a class="permalink" href="index.html#Manager.SetOptions">&#xb6;</a>
					
					
				</h3>
				<pre>func (m *<a href="index.html#Manager">Manager</a>) SetOptions(opts <a href="types/index.html">types</a>.<a href="types/index.html#PruningOptions">PruningOptions</a>)</pre>
				<p>SetOptions sets the pruning strategy on the manager.

				
				
				
			
				
				<h3 id="Manager.SetSnapshotInterval">func (*Manager) <a href="http://localhost:6060/src/github.com/cosmos/cosmos-sdk/store/pruning/manager.go?s=6212:6274#L166">SetSnapshotInterval</a>
					<a class="permalink" href="index.html#Manager.SetSnapshotInterval">&#xb6;</a>
					
					
				</h3>
				<pre>func (m *<a href="index.html#Manager">Manager</a>) SetSnapshotInterval(snapshotInterval <a href="../../../../../builtin/index.html#uint64">uint64</a>)</pre>
				<p>SetSnapshotInterval sets the interval at which the snapshots are taken.

				
				
				
			
				
				<h3 id="Manager.ShouldPruneAtHeight">func (*Manager) <a href="http://localhost:6060/src/github.com/cosmos/cosmos-sdk/store/pruning/manager.go?s=6408:6464#L171">ShouldPruneAtHeight</a>
					<a class="permalink" href="index.html#Manager.ShouldPruneAtHeight">&#xb6;</a>
					
					
				</h3>
				<pre>func (m *<a href="index.html#Manager">Manager</a>) ShouldPruneAtHeight(height <a href="../../../../../builtin/index.html#int64">int64</a>) <a href="../../../../../builtin/index.html#bool">bool</a></pre>
				<p>ShouldPruneAtHeight return true if the given height should be pruned, false otherwise

				
				
				
			
		
			
			
			<h2 id="NegativeHeightsError">type <a href="http://localhost:6060/src/github.com/cosmos/cosmos-sdk/store/pruning/manager.go?s=1312:1362#L27">NegativeHeightsError</a>
				<a class="permalink" href="index.html#NegativeHeightsError">&#xb6;</a>
				
				
			</h2>
			<p>NegativeHeightsError is returned when a negative height is provided to the manager.

			<pre>type NegativeHeightsError struct {
<span id="NegativeHeightsError.Height"></span>    Height <a href="../../../../../builtin/index.html#int64">int64</a>
}
</pre>

			

			

			
			
			

			

			
				
				<h3 id="NegativeHeightsError.Error">func (*NegativeHeightsError) <a href="http://localhost:6060/src/github.com/cosmos/cosmos-sdk/store/pruning/manager.go?s=1403:1448#L33">Error</a>
					<a class="permalink" href="index.html#NegativeHeightsError.Error">&#xb6;</a>
					
					
				</h3>
				<pre>func (e *<a href="index.html#NegativeHeightsError">NegativeHeightsError</a>) Error() <a href="../../../../../builtin/index.html#string">string</a></pre>
				
				
				
				
			
		
	

	





	
	
		<h2 id="pkg-subdirectories">Subdirectories</h2>
	
	<div class="pkg-dir">
		<table>
			<tr>
				<th class="pkg-name">Name</th>
				<th class="pkg-synopsis">Synopsis</th>
			</tr>

			
			<tr>
				<td colspan="2"><a href="../index.html">..</a></td>
			</tr>
			

			
				<tr>
				
					<td class="pkg-name" style="padding-left: 0px;">
						<a href="mock/index.html">mock</a>
					</td>
				
					<td class="pkg-synopsis">
						Package mock_db is a generated GoMock package.
					</td>
				</tr>
			
				<tr>
				
					<td class="pkg-name" style="padding-left: 0px;">
						<a href="types/index.html">types</a>
					</td>
				
					<td class="pkg-synopsis">
						
					</td>
				</tr>
			
		</table>
	</div>



<div id="footer">
Build version go1.19.10.<br>
Except as <a href="https://developers.google.com/site-policies#restrictions">noted</a>,
the content of this page is licensed under the
Creative Commons Attribution 3.0 License,
and code is licensed under a <a href="http://localhost:6060/LICENSE">BSD license</a>.<br>
<a href="https://golang.org/doc/tos.html">Terms of Service</a> |
<a href="https://www.google.com/intl/en/policies/privacy/">Privacy Policy</a>
</div>

</div><!-- .container -->
</div><!-- #page -->
</body>
</html>
