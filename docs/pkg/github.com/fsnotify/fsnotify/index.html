<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#375EAB">

  <title>fsnotify - Go Documentation Server</title>

<link type="text/css" rel="stylesheet" href="../../../../lib/godoc/style.css">

<script>window.initFuncs = [];</script>
<script src="../../../../lib/godoc/jquery.js" defer></script>



<script>var goVersion = "go1.19.10";</script>
<script src="../../../../lib/godoc/godocs.js" defer></script>
</head>
<body>

<div id='lowframe' style="position: fixed; bottom: 0; left: 0; height: 0; width: 100%; border-top: thin solid grey; background-color: white; overflow: auto;">
...
</div><!-- #lowframe -->

<div id="topbar" class="wide"><div class="container">
<div class="top-heading" id="heading-wide"><a href="http://localhost:6060/pkg/">Go Documentation Server</a></div>
<div class="top-heading" id="heading-narrow"><a href="http://localhost:6060/pkg/">GoDoc</a></div>
<a href="index.html#" id="menu-button"><span id="menu-button-arrow">&#9661;</span></a>
<form method="GET" action="http://localhost:6060/search">
<div id="menu">

<span class="search-box"><input type="search" id="search" name="q" placeholder="Search" aria-label="Search" required><button type="submit"><span><!-- magnifying glass: --><svg width="24" height="24" viewBox="0 0 24 24"><title>submit search</title><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/><path d="M0 0h24v24H0z" fill="none"/></svg></span></button></span>
</div>
</form>

</div></div>



<div id="page" class="wide">
<div class="container">


  <h1>
    Package fsnotify
    <span class="text-muted"></span>
  </h1>







<div id="nav"></div>


<!--
	Copyright 2009 The Go Authors. All rights reserved.
	Use of this source code is governed by a BSD-style
	license that can be found in the LICENSE file.
-->
<!--
	Note: Static (i.e., not template-generated) href and id
	attributes start with "pkg-" to make it impossible for
	them to conflict with generated attributes (some of which
	correspond to Go identifiers).
-->

	<script>
	document.ANALYSIS_DATA = null;
	document.CALLGRAPH = null;
	</script>

	
		
		<div id="short-nav">
			<dl>
			<dd><code>import "github.com/fsnotify/fsnotify"</code></dd>
			</dl>
			<dl>
			<dd><a href="index.html#pkg-overview" class="overviewLink">Overview</a></dd>
			<dd><a href="index.html#pkg-index" class="indexLink">Index</a></dd>
			
			
				<dd><a href="index.html#pkg-subdirectories">Subdirectories</a></dd>
			
			</dl>
		</div>
		<!-- The package's Name is printed as title by the top-level template -->
		<div id="pkg-overview" class="toggleVisible">
			<div class="collapsed">
				<h2 class="toggleButton" title="Click to show Overview section">Overview ▹</h2>
			</div>
			<div class="expanded">
				<h2 class="toggleButton" title="Click to hide Overview section">Overview ▾</h2>
				<p>Package fsnotify provides a cross-platform interface for file system
notifications.

				
			</div>
		</div>

		<div id="pkg-index" class="toggleVisible">
		<div class="collapsed">
			<h2 class="toggleButton" title="Click to show Index section">Index ▹</h2>
		</div>
		<div class="expanded">
			<h2 class="toggleButton" title="Click to hide Index section">Index ▾</h2>

		<!-- Table of contents for API; must be named manual-nav to turn off auto nav. -->
			<div id="manual-nav">
			<dl>
			
			
				<dd><a href="index.html#pkg-variables">Variables</a></dd>
			
			
			
				
				<dd><a href="index.html#Event">type Event</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Event.Has">func (e Event) Has(op Op) bool</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Event.String">func (e Event) String() string</a></dd>
				
			
				
				<dd><a href="index.html#Op">type Op</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Op.Has">func (o Op) Has(h Op) bool</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Op.String">func (op Op) String() string</a></dd>
				
			
				
				<dd><a href="index.html#Watcher">type Watcher</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#NewWatcher">func NewWatcher() (*Watcher, error)</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Watcher.Add">func (w *Watcher) Add(name string) error</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Watcher.Close">func (w *Watcher) Close() error</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Watcher.Remove">func (w *Watcher) Remove(name string) error</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Watcher.WatchList">func (w *Watcher) WatchList() []string</a></dd>
				
			
			
			</dl>
			</div><!-- #manual-nav -->

		

		
			<h3>Package files</h3>
			<p>
			<span style="font-size:90%">
			
				<a href="http://localhost:6060/src/github.com/fsnotify/fsnotify/backend_kqueue.go">backend_kqueue.go</a>
			
				<a href="http://localhost:6060/src/github.com/fsnotify/fsnotify/fsnotify.go">fsnotify.go</a>
			
				<a href="http://localhost:6060/src/github.com/fsnotify/fsnotify/system_darwin.go">system_darwin.go</a>
			
			</span>
			</p>
		
		</div><!-- .expanded -->
		</div><!-- #pkg-index -->

		

		
		
			<h2 id="pkg-variables">Variables</h2>
			
				<p>Common errors that can be reported by a watcher

				<pre>var (
    <span id="ErrNonExistentWatch">ErrNonExistentWatch</span> = <a href="../../../errors/index.html">errors</a>.<a href="../../../errors/index.html#New">New</a>(&#34;can&#39;t remove non-existent watcher&#34;)
    <span id="ErrEventOverflow">ErrEventOverflow</span>    = <a href="../../../errors/index.html">errors</a>.<a href="../../../errors/index.html#New">New</a>(&#34;fsnotify queue overflow&#34;)
)</pre>
			
		
		
		
			
			
			<h2 id="Event">type <a href="http://localhost:6060/src/github.com/fsnotify/fsnotify/fsnotify.go?s=232:700#L5">Event</a>
				<a class="permalink" href="index.html#Event">&#xb6;</a>
				
				
			</h2>
			<p>Event represents a file system notification.

			<pre>type Event struct {
    <span class="comment">// Path to the file or directory.</span>
    <span class="comment">//</span>
    <span class="comment">// Paths are relative to the input; for example with Add(&#34;dir&#34;) the Name</span>
    <span class="comment">// will be set to &#34;dir/file&#34; if you create that file, but if you use</span>
    <span class="comment">// Add(&#34;/path/to/dir&#34;) it will be &#34;/path/to/dir/file&#34;.</span>
<span id="Event.Name"></span>    Name <a href="../../../builtin/index.html#string">string</a>

    <span class="comment">// File operation that triggered the event.</span>
    <span class="comment">//</span>
    <span class="comment">// This is a bitmask and some systems may send multiple operations at once.</span>
    <span class="comment">// Use the Event.Has() method instead of comparing with ==.</span>
<span id="Event.Op"></span>    Op <a href="index.html#Op">Op</a>
}
</pre>

			

			

			
			
			

			

			
				
				<h3 id="Event.Has">func (Event) <a href="http://localhost:6060/src/github.com/fsnotify/fsnotify/fsnotify.go?s=1687:1717#L66">Has</a>
					<a class="permalink" href="index.html#Event.Has">&#xb6;</a>
					
					
				</h3>
				<pre>func (e <a href="index.html#Event">Event</a>) Has(op <a href="index.html#Op">Op</a>) <a href="../../../builtin/index.html#bool">bool</a></pre>
				<p>Has reports if this event has the given operation.

				
				
				
			
				
				<h3 id="Event.String">func (Event) <a href="http://localhost:6060/src/github.com/fsnotify/fsnotify/fsnotify.go?s=1815:1845#L69">String</a>
					<a class="permalink" href="index.html#Event.String">&#xb6;</a>
					
					
				</h3>
				<pre>func (e <a href="index.html#Event">Event</a>) String() <a href="../../../builtin/index.html#string">string</a></pre>
				<p>String returns a string representation of the event with their path.

				
				
				
			
		
			
			
			<h2 id="Op">type <a href="http://localhost:6060/src/github.com/fsnotify/fsnotify/fsnotify.go?s=744:758#L21">Op</a>
				<a class="permalink" href="index.html#Op">&#xb6;</a>
				
				
			</h2>
			<p>Op describes a set of file operations.

			<pre>type Op <a href="../../../builtin/index.html#uint32">uint32</a></pre>

			
				<p>The operations fsnotify can trigger; see the documentation on <a href="index.html#Watcher">Watcher</a> for a
full description, and check them with <a href="index.html#Event.Has">Event.Has</a>.

				<pre>const (
    <span id="Create">Create</span> <a href="index.html#Op">Op</a> = 1 &lt;&lt; <a href="../../../builtin/index.html#iota">iota</a>
    <span id="Write">Write</span>
    <span id="Remove">Remove</span>
    <span id="Rename">Rename</span>
    <span id="Chmod">Chmod</span>
)</pre>
			

			

			
			
			

			

			
				
				<h3 id="Op.Has">func (Op) <a href="http://localhost:6060/src/github.com/fsnotify/fsnotify/fsnotify.go?s=1585:1611#L63">Has</a>
					<a class="permalink" href="index.html#Op.Has">&#xb6;</a>
					
					
				</h3>
				<pre>func (o <a href="index.html#Op">Op</a>) Has(h <a href="index.html#Op">Op</a>) <a href="../../../builtin/index.html#bool">bool</a></pre>
				<p>Has reports if this operation has the given operation.

				
				
				
			
				
				<h3 id="Op.String">func (Op) <a href="http://localhost:6060/src/github.com/fsnotify/fsnotify/fsnotify.go?s=1151:1179#L39">String</a>
					<a class="permalink" href="index.html#Op.String">&#xb6;</a>
					
					
				</h3>
				<pre>func (op <a href="index.html#Op">Op</a>) String() <a href="../../../builtin/index.html#string">string</a></pre>
				
				
				
				
			
		
			
			
			<h2 id="Watcher">type <a href="http://localhost:6060/src/github.com/fsnotify/fsnotify/backend_kqueue.go?s=2619:5629#L66">Watcher</a>
				<a class="permalink" href="index.html#Watcher">&#xb6;</a>
				
				
			</h2>
			<p>Watcher watches a set of paths, delivering events on a channel.
<p>A watcher should not be copied (e.g. pass it by pointer, rather than by
value).
<h3 id="hdr-Linux_notes">Linux notes</h3>
<p>When a file is removed a Remove event won&apos;t be emitted until all file
descriptors are closed, and deletes will always emit a Chmod. For example:
<pre>fp := os.Open(&quot;file&quot;)
os.Remove(&quot;file&quot;)        // Triggers Chmod
fp.Close()               // Triggers Remove
</pre>
<p>This is the event that inotify sends, so not much can be changed about this.
<p>The fs.inotify.max_user_watches sysctl variable specifies the upper limit
for the number of watches per user, and fs.inotify.max_user_instances
specifies the maximum number of inotify instances per user. Every Watcher you
create is an &quot;instance&quot;, and every path you add is a &quot;watch&quot;.
<p>These are also exposed in /proc as /proc/sys/fs/inotify/max_user_watches and
/proc/sys/fs/inotify/max_user_instances
<p>To increase them you can use sysctl or write the value to the /proc file:
<pre># Default values on Linux 5.18
sysctl fs.inotify.max_user_watches=124983
sysctl fs.inotify.max_user_instances=128
</pre>
<p>To make the changes persist on reboot edit /etc/sysctl.conf or
/usr/lib/sysctl.d/50-default.conf (details differ per Linux distro; check
your distro&apos;s documentation):
<pre>fs.inotify.max_user_watches=124983
fs.inotify.max_user_instances=128
</pre>
<p>Reaching the limit will result in a &quot;no space left on device&quot; or &quot;too many open
files&quot; error.
<h3 id="hdr-kqueue_notes__macOS__BSD_">kqueue notes (macOS, BSD)</h3>
<p>kqueue requires opening a file descriptor for every file that&apos;s being watched;
so if you&apos;re watching a directory with five files then that&apos;s six file
descriptors. You will run in to your system&apos;s &quot;max open files&quot; limit faster on
these platforms.
<p>The sysctl variables kern.maxfiles and kern.maxfilesperproc can be used to
control the maximum number of open files, as well as /etc/login.conf on BSD
systems.
<h3 id="hdr-macOS_notes">macOS notes</h3>
<p>Spotlight indexing on macOS can result in multiple events (see <a href="https://github.com/fsnotify/fsnotify/issues/15">#15</a>). A
temporary workaround is to add your folder(s) to the &quot;Spotlight Privacy
Settings&quot; until we have a native FSEvents implementation (see <a href="https://github.com/fsnotify/fsnotify/issues/11">#11</a>).

			<pre>type Watcher struct {
<span id="Watcher.Events"></span>    <span class="comment">// Events sends the filesystem change events.</span>
    <span class="comment">//</span>
    <span class="comment">// fsnotify can send the following events; a &#34;path&#34; here can refer to a</span>
    <span class="comment">// file, directory, symbolic link, or special file like a FIFO.</span>
    <span class="comment">//</span>
    <span class="comment">//   fsnotify.Create    A new path was created; this may be followed by one</span>
    <span class="comment">//                      or more Write events if data also gets written to a</span>
    <span class="comment">//                      file.</span>
    <span class="comment">//</span>
    <span class="comment">//   fsnotify.Remove    A path was removed.</span>
    <span class="comment">//</span>
    <span class="comment">//   fsnotify.Rename    A path was renamed. A rename is always sent with the</span>
    <span class="comment">//                      old path as Event.Name, and a Create event will be</span>
    <span class="comment">//                      sent with the new name. Renames are only sent for</span>
    <span class="comment">//                      paths that are currently watched; e.g. moving an</span>
    <span class="comment">//                      unmonitored file into a monitored directory will</span>
    <span class="comment">//                      show up as just a Create. Similarly, renaming a file</span>
    <span class="comment">//                      to outside a monitored directory will show up as</span>
    <span class="comment">//                      only a Rename.</span>
    <span class="comment">//</span>
    <span class="comment">//   fsnotify.Write     A file or named pipe was written to. A Truncate will</span>
    <span class="comment">//                      also trigger a Write. A single &#34;write action&#34;</span>
    <span class="comment">//                      initiated by the user may show up as one or multiple</span>
    <span class="comment">//                      writes, depending on when the system syncs things to</span>
    <span class="comment">//                      disk. For example when compiling a large Go program</span>
    <span class="comment">//                      you may get hundreds of Write events, so you</span>
    <span class="comment">//                      probably want to wait until you&#39;ve stopped receiving</span>
    <span class="comment">//                      them (see the dedup example in cmd/fsnotify).</span>
    <span class="comment">//</span>
    <span class="comment">//   fsnotify.Chmod     Attributes were changed. On Linux this is also sent</span>
    <span class="comment">//                      when a file is removed (or more accurately, when a</span>
    <span class="comment">//                      link to an inode is removed). On kqueue it&#39;s sent</span>
    <span class="comment">//                      and on kqueue when a file is truncated. On Windows</span>
    <span class="comment">//                      it&#39;s never sent.</span>
    Events chan <a href="index.html#Event">Event</a>

<span id="Watcher.Errors"></span>    <span class="comment">// Errors sends any errors.</span>
    Errors chan <a href="../../../builtin/index.html#error">error</a>
    <span class="comment">// contains filtered or unexported fields</span>
}
</pre>

			

			

			
			
			

			
				
				<h3 id="NewWatcher">func <a href="http://localhost:6060/src/github.com/fsnotify/fsnotify/backend_kqueue.go?s=5720:5755#L125">NewWatcher</a>
					<a class="permalink" href="index.html#NewWatcher">&#xb6;</a>
					
					
				</h3>
				<pre>func NewWatcher() (*<a href="index.html#Watcher">Watcher</a>, <a href="../../../builtin/index.html#error">error</a>)</pre>
				<p>NewWatcher creates a new Watcher.

				
				
			

			
				
				<h3 id="Watcher.Add">func (*Watcher) <a href="http://localhost:6060/src/github.com/fsnotify/fsnotify/backend_kqueue.go?s=9715:9755#L260">Add</a>
					<a class="permalink" href="index.html#Watcher.Add">&#xb6;</a>
					
					
				</h3>
				<pre>func (w *<a href="index.html#Watcher">Watcher</a>) Add(name <a href="../../../builtin/index.html#string">string</a>) <a href="../../../builtin/index.html#error">error</a></pre>
				<p>Add starts monitoring the path for changes.
<p>A path can only be watched once; attempting to watch it more than once will
return an error. Paths that do not yet exist on the filesystem cannot be
added. A watch will be automatically removed if the path is deleted.
<p>A path will remain watched if it gets renamed to somewhere else on the same
filesystem, but the monitor will get removed if the path gets deleted and
re-created, or if it&apos;s moved to a different filesystem.
<p>Notifications on network filesystems (NFS, SMB, FUSE, etc.) or special
filesystems (/proc, /sys, etc.) generally don&apos;t work.
<h3 id="hdr-Watching_directories">Watching directories</h3>
<p>All files in a directory are monitored, including new files that are created
after the watcher is started. Subdirectories are not watched (i.e. it&apos;s
non-recursive).
<h3 id="hdr-Watching_files">Watching files</h3>
<p>Watching individual files (rather than directories) is generally not
recommended as many tools update files atomically. Instead of &quot;just&quot; writing
to the file a temporary file will be written to first, and if successful the
temporary file is moved to to destination removing the original, or some
variant thereof. The watcher on the original file is now lost, as it no
longer exists.
<p>Instead, watch the parent directory and use Event.Name to filter out files
you&apos;re not interested in. There is an example of this in <a href="http://localhost:6060/cmd/fsnotify/file.go">cmd/fsnotify/file.go</a>.

				
				
				
			
				
				<h3 id="Watcher.Close">func (*Watcher) <a href="http://localhost:6060/src/github.com/fsnotify/fsnotify/backend_kqueue.go?s=7770:7801#L205">Close</a>
					<a class="permalink" href="index.html#Watcher.Close">&#xb6;</a>
					
					
				</h3>
				<pre>func (w *<a href="index.html#Watcher">Watcher</a>) Close() <a href="../../../builtin/index.html#error">error</a></pre>
				<p>Close removes all watches and closes the events channel.

				
				
				
			
				
				<h3 id="Watcher.Remove">func (*Watcher) <a href="http://localhost:6060/src/github.com/fsnotify/fsnotify/backend_kqueue.go?s=10155:10198#L274">Remove</a>
					<a class="permalink" href="index.html#Watcher.Remove">&#xb6;</a>
					
					
				</h3>
				<pre>func (w *<a href="index.html#Watcher">Watcher</a>) Remove(name <a href="../../../builtin/index.html#string">string</a>) <a href="../../../builtin/index.html#error">error</a></pre>
				<p>Remove stops monitoring the path for changes.
<p>Directories are always removed non-recursively. For example, if you added
/tmp/dir and /tmp/dir/subdir then you will need to remove both.
<p>Removing a path that has not yet been added returns <a href="index.html#ErrNonExistentWatch">ErrNonExistentWatch</a>.

				
				
				
			
				
				<h3 id="Watcher.WatchList">func (*Watcher) <a href="http://localhost:6060/src/github.com/fsnotify/fsnotify/backend_kqueue.go?s=11501:11539#L330">WatchList</a>
					<a class="permalink" href="index.html#Watcher.WatchList">&#xb6;</a>
					
					
				</h3>
				<pre>func (w *<a href="index.html#Watcher">Watcher</a>) WatchList() []<a href="../../../builtin/index.html#string">string</a></pre>
				<p>WatchList returns all paths added with [Add] (and are not yet removed).

				
				
				
			
		
	

	





	
	
		<h2 id="pkg-subdirectories">Subdirectories</h2>
	
	<div class="pkg-dir">
		<table>
			<tr>
				<th class="pkg-name">Name</th>
				<th class="pkg-synopsis">Synopsis</th>
			</tr>

			
			<tr>
				<td colspan="2"><a href="http://localhost:6060/pkg/github.com/fsnotify/">..</a></td>
			</tr>
			

			
				<tr>
				
					<td class="pkg-name" style="padding-left: 0px;">
						<a href="cmd/index.html">cmd</a>
					</td>
				
					<td class="pkg-synopsis">
						
					</td>
				</tr>
			
				<tr>
				
					<td class="pkg-name" style="padding-left: 20px;">
						<a href="cmd/fsnotify/index.html">fsnotify</a>
					</td>
				
					<td class="pkg-synopsis">
						Command fsnotify provides example usage of the fsnotify library.
					</td>
				</tr>
			
		</table>
	</div>



<div id="footer">
Build version go1.19.10.<br>
Except as <a href="https://developers.google.com/site-policies#restrictions">noted</a>,
the content of this page is licensed under the
Creative Commons Attribution 3.0 License,
and code is licensed under a <a href="http://localhost:6060/LICENSE">BSD license</a>.<br>
<a href="https://golang.org/doc/tos.html">Terms of Service</a> |
<a href="https://www.google.com/intl/en/policies/privacy/">Privacy Policy</a>
</div>

</div><!-- .container -->
</div><!-- #page -->
</body>
</html>
