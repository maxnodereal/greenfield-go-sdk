<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#375EAB">

  <title>utils - Go Documentation Server</title>

<link type="text/css" rel="stylesheet" href="../../../../../../lib/godoc/style.css">

<script>window.initFuncs = [];</script>
<script src="../../../../../../lib/godoc/jquery.js" defer></script>



<script>var goVersion = "go1.19.10";</script>
<script src="../../../../../../lib/godoc/godocs.js" defer></script>
</head>
<body>

<div id='lowframe' style="position: fixed; bottom: 0; left: 0; height: 0; width: 100%; border-top: thin solid grey; background-color: white; overflow: auto;">
...
</div><!-- #lowframe -->

<div id="topbar" class="wide"><div class="container">
<div class="top-heading" id="heading-wide"><a href="http://localhost:6060/pkg/">Go Documentation Server</a></div>
<div class="top-heading" id="heading-narrow"><a href="http://localhost:6060/pkg/">GoDoc</a></div>
<a href="index.html#" id="menu-button"><span id="menu-button-arrow">&#9661;</span></a>
<form method="GET" action="http://localhost:6060/search">
<div id="menu">

<span class="search-box"><input type="search" id="search" name="q" placeholder="Search" aria-label="Search" required><button type="submit"><span><!-- magnifying glass: --><svg width="24" height="24" viewBox="0 0 24 24"><title>submit search</title><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/><path d="M0 0h24v24H0z" fill="none"/></svg></span></button></span>
</div>
</form>

</div></div>



<div id="page" class="wide">
<div class="container">


  <h1>
    Package utils
    <span class="text-muted"></span>
  </h1>







<div id="nav"></div>


<!--
	Copyright 2009 The Go Authors. All rights reserved.
	Use of this source code is governed by a BSD-style
	license that can be found in the LICENSE file.
-->
<!--
	Note: Static (i.e., not template-generated) href and id
	attributes start with "pkg-" to make it impossible for
	them to conflict with generated attributes (some of which
	correspond to Go identifiers).
-->

	<script>
	document.ANALYSIS_DATA = null;
	document.CALLGRAPH = null;
	</script>

	
		
		<div id="short-nav">
			<dl>
			<dd><code>import "github.com/ethereum/go-ethereum/les/utils"</code></dd>
			</dl>
			<dl>
			<dd><a href="index.html#pkg-overview" class="overviewLink">Overview</a></dd>
			<dd><a href="index.html#pkg-index" class="indexLink">Index</a></dd>
			
			
			</dl>
		</div>
		<!-- The package's Name is printed as title by the top-level template -->
		<div id="pkg-overview" class="toggleVisible">
			<div class="collapsed">
				<h2 class="toggleButton" title="Click to show Overview section">Overview ▹</h2>
			</div>
			<div class="expanded">
				<h2 class="toggleButton" title="Click to hide Overview section">Overview ▾</h2>
				
				
			</div>
		</div>

		<div id="pkg-index" class="toggleVisible">
		<div class="collapsed">
			<h2 class="toggleButton" title="Click to show Index section">Index ▹</h2>
		</div>
		<div class="expanded">
			<h2 class="toggleButton" title="Click to hide Index section">Index ▾</h2>

		<!-- Table of contents for API; must be named manual-nav to turn off auto nav. -->
			<div id="manual-nav">
			<dl>
			
			
			
			
				
				<dd><a href="index.html#ExecQueue">type ExecQueue</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#NewExecQueue">func NewExecQueue(capacity int) *ExecQueue</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#ExecQueue.CanQueue">func (q *ExecQueue) CanQueue() bool</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#ExecQueue.Clear">func (q *ExecQueue) Clear()</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#ExecQueue.Queue">func (q *ExecQueue) Queue(f func()) bool</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#ExecQueue.Quit">func (q *ExecQueue) Quit()</a></dd>
				
			
				
				<dd><a href="index.html#ExpirationFactor">type ExpirationFactor</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#ExpFactor">func ExpFactor(logOffset Fixed64) ExpirationFactor</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#ExpirationFactor.Value">func (e ExpirationFactor) Value(base float64, exp uint64) float64</a></dd>
				
			
				
				<dd><a href="index.html#ExpiredValue">type ExpiredValue</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#ExpiredValue.Add">func (e *ExpiredValue) Add(amount int64, logOffset Fixed64) int64</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#ExpiredValue.AddExp">func (e *ExpiredValue) AddExp(a ExpiredValue)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#ExpiredValue.IsZero">func (e *ExpiredValue) IsZero() bool</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#ExpiredValue.SubExp">func (e *ExpiredValue) SubExp(a ExpiredValue)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#ExpiredValue.Value">func (e ExpiredValue) Value(logOffset Fixed64) uint64</a></dd>
				
			
				
				<dd><a href="index.html#Expirer">type Expirer</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Expirer.LogOffset">func (e *Expirer) LogOffset(now mclock.AbsTime) Fixed64</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Expirer.SetLogOffset">func (e *Expirer) SetLogOffset(now mclock.AbsTime, logOffset Fixed64)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Expirer.SetRate">func (e *Expirer) SetRate(now mclock.AbsTime, rate float64)</a></dd>
				
			
				
				<dd><a href="index.html#Fixed64">type Fixed64</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Float64ToFixed64">func Float64ToFixed64(f float64) Fixed64</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Uint64ToFixed64">func Uint64ToFixed64(f uint64) Fixed64</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Fixed64.Fraction">func (f64 Fixed64) Fraction() Fixed64</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Fixed64.Pow2">func (f64 Fixed64) Pow2() float64</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Fixed64.ToUint64">func (f64 Fixed64) ToUint64() uint64</a></dd>
				
			
				
				<dd><a href="index.html#Limiter">type Limiter</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#NewLimiter">func NewLimiter(sumCostLimit uint) *Limiter</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Limiter.Add">func (l *Limiter) Add(id enode.ID, address string, value float64, reqCost uint) chan chan struct{}</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Limiter.Stop">func (l *Limiter) Stop()</a></dd>
				
			
				
				<dd><a href="index.html#LinearExpiredValue">type LinearExpiredValue</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#LinearExpiredValue.Add">func (e *LinearExpiredValue) Add(amount int64, now mclock.AbsTime) uint64</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#LinearExpiredValue.Value">func (e LinearExpiredValue) Value(now mclock.AbsTime) uint64</a></dd>
				
			
				
				<dd><a href="index.html#UpdateTimer">type UpdateTimer</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#NewUpdateTimer">func NewUpdateTimer(clock mclock.Clock, threshold time.Duration) *UpdateTimer</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#UpdateTimer.Update">func (t *UpdateTimer) Update(callback func(diff time.Duration) bool) bool</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#UpdateTimer.UpdateAt">func (t *UpdateTimer) UpdateAt(at mclock.AbsTime, callback func(diff time.Duration) bool) bool</a></dd>
				
			
				
				<dd><a href="index.html#ValueExpirer">type ValueExpirer</a></dd>
				
				
			
				
				<dd><a href="index.html#WeightFn">type WeightFn</a></dd>
				
				
			
				
				<dd><a href="index.html#WeightedRandomSelect">type WeightedRandomSelect</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#NewWeightedRandomSelect">func NewWeightedRandomSelect(wfn WeightFn) *WeightedRandomSelect</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#WeightedRandomSelect.Choose">func (w *WeightedRandomSelect) Choose() WrsItem</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#WeightedRandomSelect.IsEmpty">func (w *WeightedRandomSelect) IsEmpty() bool</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#WeightedRandomSelect.Remove">func (w *WeightedRandomSelect) Remove(item WrsItem)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#WeightedRandomSelect.Update">func (w *WeightedRandomSelect) Update(item WrsItem)</a></dd>
				
			
				
				<dd><a href="index.html#WrsItem">type WrsItem</a></dd>
				
				
			
			
			</dl>
			</div><!-- #manual-nav -->

		

		
			<h3>Package files</h3>
			<p>
			<span style="font-size:90%">
			
				<a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/exec_queue.go">exec_queue.go</a>
			
				<a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/expiredvalue.go">expiredvalue.go</a>
			
				<a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/limiter.go">limiter.go</a>
			
				<a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/timeutils.go">timeutils.go</a>
			
				<a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/weighted_select.go">weighted_select.go</a>
			
			</span>
			</p>
		
		</div><!-- .expanded -->
		</div><!-- #pkg-index -->

		

		
		
		
		
			
			
			<h2 id="ExecQueue">type <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/exec_queue.go?s=951:1065#L13">ExecQueue</a>
				<a class="permalink" href="index.html#ExecQueue">&#xb6;</a>
				
				
			</h2>
			<p>ExecQueue implements a queue that executes function calls in a single thread,
in the same order as they have been queued.

			<pre>type ExecQueue struct {
    <span class="comment">// contains filtered or unexported fields</span>
}
</pre>

			

			

			
			
			

			
				
				<h3 id="NewExecQueue">func <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/exec_queue.go?s=1114:1156#L21">NewExecQueue</a>
					<a class="permalink" href="index.html#NewExecQueue">&#xb6;</a>
					
					
				</h3>
				<pre>func NewExecQueue(capacity <a href="../../../../../builtin/index.html#int">int</a>) *<a href="index.html#ExecQueue">ExecQueue</a></pre>
				<p>NewExecQueue creates a new execution Queue.

				
				
			

			
				
				<h3 id="ExecQueue.CanQueue">func (*ExecQueue) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/exec_queue.go?s=1962:1997#L58">CanQueue</a>
					<a class="permalink" href="index.html#ExecQueue.CanQueue">&#xb6;</a>
					
					
				</h3>
				<pre>func (q *<a href="index.html#ExecQueue">ExecQueue</a>) CanQueue() <a href="../../../../../builtin/index.html#bool">bool</a></pre>
				<p>CanQueue returns true if more function calls can be added to the execution Queue.

				
				
				
			
				
				<h3 id="ExecQueue.Clear">func (*ExecQueue) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/exec_queue.go?s=2411:2438#L78">Clear</a>
					<a class="permalink" href="index.html#ExecQueue.Clear">&#xb6;</a>
					
					
				</h3>
				<pre>func (q *<a href="index.html#ExecQueue">ExecQueue</a>) Clear()</pre>
				<p>Clear drops all queued functions.

				
				
				
			
				
				<h3 id="ExecQueue.Queue">func (*ExecQueue) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/exec_queue.go?s=2176:2216#L66">Queue</a>
					<a class="permalink" href="index.html#ExecQueue.Queue">&#xb6;</a>
					
					
				</h3>
				<pre>func (q *<a href="index.html#ExecQueue">ExecQueue</a>) Queue(f func()) <a href="../../../../../builtin/index.html#bool">bool</a></pre>
				<p>Queue adds a function call to the execution Queue. Returns true if successful.

				
				
				
			
				
				<h3 id="ExecQueue.Quit">func (*ExecQueue) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/exec_queue.go?s=2596:2622#L87">Quit</a>
					<a class="permalink" href="index.html#ExecQueue.Quit">&#xb6;</a>
					
					
				</h3>
				<pre>func (q *<a href="index.html#ExecQueue">ExecQueue</a>) Quit()</pre>
				<p>Quit stops the exec Queue.
<p>Quit waits for the current execution to finish before returning.

				
				
				
			
		
			
			
			<h2 id="ExpirationFactor">type <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/expiredvalue.go?s=2400:2463#L44">ExpirationFactor</a>
				<a class="permalink" href="index.html#ExpirationFactor">&#xb6;</a>
				
				
			</h2>
			<p>ExpirationFactor is calculated from logOffset. 1 &lt;= Factor &lt; 2 and Factor*2^Exp
describes the multiplier applicable for additions and the divider for readouts.
If logOffset changes slowly then it saves some expensive operations to not calculate
them for each addition and readout but cache this intermediate form for some time.
It is also useful for structures where multiple values are expired with the same
Expirer.

			<pre>type ExpirationFactor struct {
<span id="ExpirationFactor.Exp"></span>    Exp    <a href="../../../../../builtin/index.html#uint64">uint64</a>
<span id="ExpirationFactor.Factor"></span>    Factor <a href="../../../../../builtin/index.html#float64">float64</a>
}
</pre>

			

			

			
			
			

			
				
				<h3 id="ExpFactor">func <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/expiredvalue.go?s=2525:2575#L50">ExpFactor</a>
					<a class="permalink" href="index.html#ExpFactor">&#xb6;</a>
					
					
				</h3>
				<pre>func ExpFactor(logOffset <a href="index.html#Fixed64">Fixed64</a>) <a href="index.html#ExpirationFactor">ExpirationFactor</a></pre>
				<p>ExpFactor calculates ExpirationFactor based on logOffset

				
				
			

			
				
				<h3 id="ExpirationFactor.Value">func (ExpirationFactor) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/expiredvalue.go?s=2839:2904#L56">Value</a>
					<a class="permalink" href="index.html#ExpirationFactor.Value">&#xb6;</a>
					
					
				</h3>
				<pre>func (e <a href="index.html#ExpirationFactor">ExpirationFactor</a>) Value(base <a href="../../../../../builtin/index.html#float64">float64</a>, exp <a href="../../../../../builtin/index.html#uint64">uint64</a>) <a href="../../../../../builtin/index.html#float64">float64</a></pre>
				<p>Value calculates the expired value based on a floating point base and integer
power-of-2 exponent. This function should be used by multi-value expired structures.

				
				
				
			
		
			
			
			<h2 id="ExpiredValue">type <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/expiredvalue.go?s=1883:1962#L34">ExpiredValue</a>
				<a class="permalink" href="index.html#ExpiredValue">&#xb6;</a>
				
				
			</h2>
			<p>ExpiredValue is a scalar value that is continuously expired (decreased
exponentially) based on the provided logarithmic expiration offset value.
<p>The formula for value calculation is: base*2^(exp-logOffset). In order to
simplify the calculation of ExpiredValue, its value is expressed in the form
of an exponent with a base of 2.
<p>Also here is a trick to reduce a lot of calculations. In theory, when a value X
decays over time and then a new value Y is added, the final result should be
X*2^(exp-logOffset)+Y. However it&apos;s very hard to represent in memory.
So the trick is using the idea of inflation instead of exponential decay. At this
moment the temporary value becomes: X*2^exp+Y*2^logOffset_1, apply the exponential
decay when we actually want to calculate the value.
<p>e.g.
t0: V = 100
t1: add 30, inflationary value is: 100 + 30/0.3, 0.3 is the decay coefficient
t2: get value, decay coefficient is 0.2 now, final result is: 200*0.2 = 40

			<pre>type ExpiredValue struct {
<span id="ExpiredValue.Base"></span>    Base, Exp <a href="../../../../../builtin/index.html#uint64">uint64</a> <span class="comment">// rlp encoding works by default</span>
}
</pre>

			

			

			
			
			

			

			
				
				<h3 id="ExpiredValue.Add">func (*ExpiredValue) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/expiredvalue.go?s=3226:3291#L67">Add</a>
					<a class="permalink" href="index.html#ExpiredValue.Add">&#xb6;</a>
					
					
				</h3>
				<pre>func (e *<a href="index.html#ExpiredValue">ExpiredValue</a>) Add(amount <a href="../../../../../builtin/index.html#int64">int64</a>, logOffset <a href="index.html#Fixed64">Fixed64</a>) <a href="../../../../../builtin/index.html#int64">int64</a></pre>
				<p>add adds a signed value at the given moment

				
				
				
			
				
				<h3 id="ExpiredValue.AddExp">func (*ExpiredValue) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/expiredvalue.go?s=3987:4032#L96">AddExp</a>
					<a class="permalink" href="index.html#ExpiredValue.AddExp">&#xb6;</a>
					
					
				</h3>
				<pre>func (e *<a href="index.html#ExpiredValue">ExpiredValue</a>) AddExp(a <a href="index.html#ExpiredValue">ExpiredValue</a>)</pre>
				<p>addExp adds another ExpiredValue

				
				
				
			
				
				<h3 id="ExpiredValue.IsZero">func (*ExpiredValue) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/expiredvalue.go?s=4499:4535#L124">IsZero</a>
					<a class="permalink" href="index.html#ExpiredValue.IsZero">&#xb6;</a>
					
					
				</h3>
				<pre>func (e *<a href="index.html#ExpiredValue">ExpiredValue</a>) IsZero() <a href="../../../../../builtin/index.html#bool">bool</a></pre>
				<p>IsZero returns true if the value is zero

				
				
				
			
				
				<h3 id="ExpiredValue.SubExp">func (*ExpiredValue) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/expiredvalue.go?s=4217:4262#L108">SubExp</a>
					<a class="permalink" href="index.html#ExpiredValue.SubExp">&#xb6;</a>
					
					
				</h3>
				<pre>func (e *<a href="index.html#ExpiredValue">ExpiredValue</a>) SubExp(a <a href="index.html#ExpiredValue">ExpiredValue</a>)</pre>
				<p>subExp subtracts another ExpiredValue

				
				
				
			
				
				<h3 id="ExpiredValue.Value">func (ExpiredValue) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/expiredvalue.go?s=3026:3079#L61">Value</a>
					<a class="permalink" href="index.html#ExpiredValue.Value">&#xb6;</a>
					
					
				</h3>
				<pre>func (e <a href="index.html#ExpiredValue">ExpiredValue</a>) Value(logOffset <a href="index.html#Fixed64">Fixed64</a>) <a href="../../../../../builtin/index.html#uint64">uint64</a></pre>
				<p>value calculates the value at the given moment.

				
				
				
			
		
			
			
			<h2 id="Expirer">type <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/expiredvalue.go?s=6416:6531#L184">Expirer</a>
				<a class="permalink" href="index.html#Expirer">&#xb6;</a>
				
				
			</h2>
			<p>Expirer changes logOffset with a linear rate which can be changed during operation.
It is not thread safe, if access by multiple goroutines is needed then it should be
encapsulated into a locked structure.
Note that if neither SetRate nor SetLogOffset are used during operation then LogOffset
is thread safe.

			<pre>type Expirer struct {
    <span class="comment">// contains filtered or unexported fields</span>
}
</pre>

			

			

			
			
			

			

			
				
				<h3 id="Expirer.LogOffset">func (*Expirer) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/expiredvalue.go?s=7134:7189#L215">LogOffset</a>
					<a class="permalink" href="index.html#Expirer.LogOffset">&#xb6;</a>
					
					
				</h3>
				<pre>func (e *<a href="index.html#Expirer">Expirer</a>) LogOffset(now <a href="../../common/mclock/index.html">mclock</a>.<a href="../../common/mclock/index.html#AbsTime">AbsTime</a>) <a href="index.html#Fixed64">Fixed64</a></pre>
				<p>LogOffset returns the current logarithmic offset.

				
				
				
			
				
				<h3 id="Expirer.SetLogOffset">func (*Expirer) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/expiredvalue.go?s=6922:6991#L206">SetLogOffset</a>
					<a class="permalink" href="index.html#Expirer.SetLogOffset">&#xb6;</a>
					
					
				</h3>
				<pre>func (e *<a href="index.html#Expirer">Expirer</a>) SetLogOffset(now <a href="../../common/mclock/index.html">mclock</a>.<a href="../../common/mclock/index.html#AbsTime">AbsTime</a>, logOffset <a href="index.html#Fixed64">Fixed64</a>)</pre>
				<p>SetLogOffset sets logOffset instantly.

				
				
				
			
				
				<h3 id="Expirer.SetRate">func (*Expirer) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/expiredvalue.go?s=6633:6692#L193">SetRate</a>
					<a class="permalink" href="index.html#Expirer.SetRate">&#xb6;</a>
					
					
				</h3>
				<pre>func (e *<a href="index.html#Expirer">Expirer</a>) SetRate(now <a href="../../common/mclock/index.html">mclock</a>.<a href="../../common/mclock/index.html#AbsTime">AbsTime</a>, rate <a href="../../../../../builtin/index.html#float64">float64</a>)</pre>
				<p>SetRate changes the expiration rate which is the inverse of the time constant in
nanoseconds.

				
				
				
			
		
			
			
			<h2 id="Fixed64">type <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/expiredvalue.go?s=7530:7548#L230">Fixed64</a>
				<a class="permalink" href="index.html#Fixed64">&#xb6;</a>
				
				
			</h2>
			<p>Fixed64 implements 64-bit fixed point arithmetic functions.

			<pre>type Fixed64 <a href="../../../../../builtin/index.html#int64">int64</a></pre>

			

			

			
			
			

			
				
				<h3 id="Float64ToFixed64">func <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/expiredvalue.go?s=7745:7785#L238">Float64ToFixed64</a>
					<a class="permalink" href="index.html#Float64ToFixed64">&#xb6;</a>
					
					
				</h3>
				<pre>func Float64ToFixed64(f <a href="../../../../../builtin/index.html#float64">float64</a>) <a href="index.html#Fixed64">Fixed64</a></pre>
				<p>float64ToFixed64 converts float64 to Fixed64 format.

				
				
			
				
				<h3 id="Uint64ToFixed64">func <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/expiredvalue.go?s=7612:7650#L233">Uint64ToFixed64</a>
					<a class="permalink" href="index.html#Uint64ToFixed64">&#xb6;</a>
					
					
				</h3>
				<pre>func Uint64ToFixed64(f <a href="../../../../../builtin/index.html#uint64">uint64</a>) <a href="index.html#Fixed64">Fixed64</a></pre>
				<p>Uint64ToFixed64 converts uint64 integer to Fixed64 format.

				
				
			

			
				
				<h3 id="Fixed64.Fraction">func (Fixed64) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/expiredvalue.go?s=8007:8044#L248">Fraction</a>
					<a class="permalink" href="index.html#Fixed64.Fraction">&#xb6;</a>
					
					
				</h3>
				<pre>func (f64 <a href="index.html#Fixed64">Fixed64</a>) Fraction() <a href="index.html#Fixed64">Fixed64</a></pre>
				<p>fraction returns the fractional part of a Fixed64 value.

				
				
				
			
				
				<h3 id="Fixed64.Pow2">func (Fixed64) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/expiredvalue.go?s=8259:8292#L258">Pow2</a>
					<a class="permalink" href="index.html#Fixed64.Pow2">&#xb6;</a>
					
					
				</h3>
				<pre>func (f64 <a href="index.html#Fixed64">Fixed64</a>) Pow2() <a href="../../../../../builtin/index.html#float64">float64</a></pre>
				<p>pow2Fixed returns the base 2 power of the fixed point value.

				
				
				
			
				
				<h3 id="Fixed64.ToUint64">func (Fixed64) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/expiredvalue.go?s=7871:7907#L243">ToUint64</a>
					<a class="permalink" href="index.html#Fixed64.ToUint64">&#xb6;</a>
					
					
				</h3>
				<pre>func (f64 <a href="index.html#Fixed64">Fixed64</a>) ToUint64() <a href="../../../../../builtin/index.html#uint64">uint64</a></pre>
				<p>toUint64 converts Fixed64 format to uint64.

				
				
				
			
		
			
			
			<h2 id="Limiter">type <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/limiter.go?s=1246:1596#L21">Limiter</a>
				<a class="permalink" href="index.html#Limiter">&#xb6;</a>
				
				
			</h2>
			<p>Limiter protects a network request serving mechanism from denial-of-service attacks.
It limits the total amount of resources used for serving requests while ensuring that
the most valuable connections always have a reasonable chance of being served.

			<pre>type Limiter struct {
    <span class="comment">// contains filtered or unexported fields</span>
}
</pre>

			

			

			
			
			

			
				
				<h3 id="NewLimiter">func <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/limiter.go?s=4704:4747#L120">NewLimiter</a>
					<a class="permalink" href="index.html#NewLimiter">&#xb6;</a>
					
					
				</h3>
				<pre>func NewLimiter(sumCostLimit <a href="../../../../../builtin/index.html#uint">uint</a>) *<a href="index.html#Limiter">Limiter</a></pre>
				<p>NewLimiter creates a new Limiter

				
				
			

			
				
				<h3 id="Limiter.Add">func (*Limiter) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/limiter.go?s=6290:6388#L167">Add</a>
					<a class="permalink" href="index.html#Limiter.Add">&#xb6;</a>
					
					
				</h3>
				<pre>func (l *<a href="index.html#Limiter">Limiter</a>) Add(id <a href="../../p2p/enode/index.html">enode</a>.<a href="../../p2p/enode/index.html#ID">ID</a>, address <a href="../../../../../builtin/index.html#string">string</a>, value <a href="../../../../../builtin/index.html#float64">float64</a>, reqCost <a href="../../../../../builtin/index.html#uint">uint</a>) chan chan struct{}</pre>
				<p>Add adds a new request to the node queue belonging to the given id. Value belongs
to the requesting node. A higher value gives the request a higher chance of being
served quickly in case of heavy load or a DDoS attack. Cost is a rough estimate
of the serving cost of the request. A lower cost also gives the request a
better chance.

				
				
				
			
				
				<h3 id="Limiter.Stop">func (*Limiter) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/limiter.go?s=10038:10062#L325">Stop</a>
					<a class="permalink" href="index.html#Limiter.Stop">&#xb6;</a>
					
					
				</h3>
				<pre>func (l *<a href="index.html#Limiter">Limiter</a>) Stop()</pre>
				<p>Stop stops the processing loop. All queued and future requests are rejected.

				
				
				
			
		
			
			
			<h2 id="LinearExpiredValue">type <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/expiredvalue.go?s=4716:4956#L130">LinearExpiredValue</a>
				<a class="permalink" href="index.html#LinearExpiredValue">&#xb6;</a>
				
				
			</h2>
			<p>LinearExpiredValue is very similar with the expiredValue which the value
will continuously expired. But the different part is it&apos;s expired linearly.

			<pre>type LinearExpiredValue struct {
<span id="LinearExpiredValue.Offset"></span>    Offset <a href="../../../../../builtin/index.html#uint64">uint64</a>         <span class="comment">// The latest time offset</span>
<span id="LinearExpiredValue.Val"></span>    Val    <a href="../../../../../builtin/index.html#uint64">uint64</a>         <span class="comment">// The remaining value, can never be negative</span>
<span id="LinearExpiredValue.Rate"></span>    Rate   <a href="../../common/mclock/index.html">mclock</a>.<a href="../../common/mclock/index.html#AbsTime">AbsTime</a> `rlp:&#34;-&#34;` <span class="comment">// Expiration rate(by nanosecond), will ignored by RLP</span>
}
</pre>

			

			

			
			
			

			

			
				
				<h3 id="LinearExpiredValue.Add">func (*LinearExpiredValue) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/expiredvalue.go?s=5502:5575#L153">Add</a>
					<a class="permalink" href="index.html#LinearExpiredValue.Add">&#xb6;</a>
					
					
				</h3>
				<pre>func (e *<a href="index.html#LinearExpiredValue">LinearExpiredValue</a>) Add(amount <a href="../../../../../builtin/index.html#int64">int64</a>, now <a href="../../common/mclock/index.html">mclock</a>.<a href="../../common/mclock/index.html#AbsTime">AbsTime</a>) <a href="../../../../../builtin/index.html#uint64">uint64</a></pre>
				<p>add adds a signed value at the given moment. This function always has the
assumption that the given timestamp shouldn&apos;t less than the recorded one.

				
				
				
			
				
				<h3 id="LinearExpiredValue.Value">func (LinearExpiredValue) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/expiredvalue.go?s=5115:5175#L138">Value</a>
					<a class="permalink" href="index.html#LinearExpiredValue.Value">&#xb6;</a>
					
					
				</h3>
				<pre>func (e <a href="index.html#LinearExpiredValue">LinearExpiredValue</a>) Value(now <a href="../../common/mclock/index.html">mclock</a>.<a href="../../common/mclock/index.html#AbsTime">AbsTime</a>) <a href="../../../../../builtin/index.html#uint64">uint64</a></pre>
				<p>value calculates the value at the given moment. This function always has the
assumption that the given timestamp shouldn&apos;t less than the recorded one.

				
				
				
			
		
			
			
			<h2 id="UpdateTimer">type <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/timeutils.go?s=886:1010#L16">UpdateTimer</a>
				<a class="permalink" href="index.html#UpdateTimer">&#xb6;</a>
				
				
			</h2>
			
			<pre>type UpdateTimer struct {
    <span class="comment">// contains filtered or unexported fields</span>
}
</pre>

			

			

			
			
			

			
				
				<h3 id="NewUpdateTimer">func <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/timeutils.go?s=1012:1089#L23">NewUpdateTimer</a>
					<a class="permalink" href="index.html#NewUpdateTimer">&#xb6;</a>
					
					
				</h3>
				<pre>func NewUpdateTimer(clock <a href="../../common/mclock/index.html">mclock</a>.<a href="../../common/mclock/index.html#Clock">Clock</a>, threshold <a href="../../../../../time/index.html">time</a>.<a href="../../../../../time/index.html#Duration">Duration</a>) *<a href="index.html#UpdateTimer">UpdateTimer</a></pre>
				
				
				
			

			
				
				<h3 id="UpdateTimer.Update">func (*UpdateTimer) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/timeutils.go?s=1359:1432#L39">Update</a>
					<a class="permalink" href="index.html#UpdateTimer.Update">&#xb6;</a>
					
					
				</h3>
				<pre>func (t *<a href="index.html#UpdateTimer">UpdateTimer</a>) Update(callback func(diff <a href="../../../../../time/index.html">time</a>.<a href="../../../../../time/index.html#Duration">Duration</a>) <a href="../../../../../builtin/index.html#bool">bool</a>) <a href="../../../../../builtin/index.html#bool">bool</a></pre>
				
				
				
				
			
				
				<h3 id="UpdateTimer.UpdateAt">func (*UpdateTimer) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/timeutils.go?s=1482:1576#L43">UpdateAt</a>
					<a class="permalink" href="index.html#UpdateTimer.UpdateAt">&#xb6;</a>
					
					
				</h3>
				<pre>func (t *<a href="index.html#UpdateTimer">UpdateTimer</a>) UpdateAt(at <a href="../../common/mclock/index.html">mclock</a>.<a href="../../common/mclock/index.html#AbsTime">AbsTime</a>, callback func(diff <a href="../../../../../time/index.html">time</a>.<a href="../../../../../time/index.html#Duration">Duration</a>) <a href="../../../../../builtin/index.html#bool">bool</a>) <a href="../../../../../builtin/index.html#bool">bool</a></pre>
				
				
				
				
			
		
			
			
			<h2 id="ValueExpirer">type <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/expiredvalue.go?s=5924:6090#L173">ValueExpirer</a>
				<a class="permalink" href="index.html#ValueExpirer">&#xb6;</a>
				
				
			</h2>
			<p>ValueExpirer controls value expiration rate

			<pre>type ValueExpirer interface {
    SetRate(now <a href="../../common/mclock/index.html">mclock</a>.<a href="../../common/mclock/index.html#AbsTime">AbsTime</a>, rate <a href="../../../../../builtin/index.html#float64">float64</a>)
    SetLogOffset(now <a href="../../common/mclock/index.html">mclock</a>.<a href="../../common/mclock/index.html#AbsTime">AbsTime</a>, logOffset <a href="index.html#Fixed64">Fixed64</a>)
    LogOffset(now <a href="../../common/mclock/index.html">mclock</a>.<a href="../../common/mclock/index.html#AbsTime">AbsTime</a>) <a href="index.html#Fixed64">Fixed64</a>
}</pre>

			

			

			
			
			

			

			
		
			
			
			<h2 id="WeightFn">type <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/weighted_select.go?s=1085:1118#L24">WeightFn</a>
				<a class="permalink" href="index.html#WeightFn">&#xb6;</a>
				
				
			</h2>
			
			<pre>type WeightFn func(interface{}) <a href="../../../../../builtin/index.html#uint64">uint64</a></pre>

			

			

			
			
			

			

			
		
			
			
			<h2 id="WeightedRandomSelect">type <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/weighted_select.go?s=974:1061#L18">WeightedRandomSelect</a>
				<a class="permalink" href="index.html#WeightedRandomSelect">&#xb6;</a>
				
				
			</h2>
			<p>WeightedRandomSelect is capable of weighted random selection from a set of items

			<pre>type WeightedRandomSelect struct {
    <span class="comment">// contains filtered or unexported fields</span>
}
</pre>

			

			

			
			
			

			
				
				<h3 id="NewWeightedRandomSelect">func <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/weighted_select.go?s=1194:1258#L28">NewWeightedRandomSelect</a>
					<a class="permalink" href="index.html#NewWeightedRandomSelect">&#xb6;</a>
					
					
				</h3>
				<pre>func NewWeightedRandomSelect(wfn <a href="index.html#WeightFn">WeightFn</a>) *<a href="index.html#WeightedRandomSelect">WeightedRandomSelect</a></pre>
				<p>NewWeightedRandomSelect returns a new WeightedRandomSelect structure

				
				
			

			
				
				<h3 id="WeightedRandomSelect.Choose">func (*WeightedRandomSelect) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/weighted_select.go?s=3145:3192#L82">Choose</a>
					<a class="permalink" href="index.html#WeightedRandomSelect.Choose">&#xb6;</a>
					
					
				</h3>
				<pre>func (w *<a href="index.html#WeightedRandomSelect">WeightedRandomSelect</a>) Choose() <a href="index.html#WrsItem">WrsItem</a></pre>
				<p>Choose randomly selects an item from the set, with a chance proportional to its
current weight. If the weight of the chosen element has been decreased since the
last stored value, returns it with a newWeight/oldWeight chance, otherwise just
updates its weight and selects another one

				
				
				
			
				
				<h3 id="WeightedRandomSelect.IsEmpty">func (*WeightedRandomSelect) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/weighted_select.go?s=1800:1845#L44">IsEmpty</a>
					<a class="permalink" href="index.html#WeightedRandomSelect.IsEmpty">&#xb6;</a>
					
					
				</h3>
				<pre>func (w *<a href="index.html#WeightedRandomSelect">WeightedRandomSelect</a>) IsEmpty() <a href="../../../../../builtin/index.html#bool">bool</a></pre>
				<p>IsEmpty returns true if the set is empty

				
				
				
			
				
				<h3 id="WeightedRandomSelect.Remove">func (*WeightedRandomSelect) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/weighted_select.go?s=1677:1728#L39">Remove</a>
					<a class="permalink" href="index.html#WeightedRandomSelect.Remove">&#xb6;</a>
					
					
				</h3>
				<pre>func (w *<a href="index.html#WeightedRandomSelect">WeightedRandomSelect</a>) Remove(item <a href="index.html#WrsItem">WrsItem</a>)</pre>
				<p>Remove removes an item from the set

				
				
				
			
				
				<h3 id="WeightedRandomSelect.Update">func (*WeightedRandomSelect) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/weighted_select.go?s=1549:1600#L34">Update</a>
					<a class="permalink" href="index.html#WeightedRandomSelect.Update">&#xb6;</a>
					
					
				</h3>
				<pre>func (w *<a href="index.html#WeightedRandomSelect">WeightedRandomSelect</a>) Update(item <a href="index.html#WrsItem">WrsItem</a>)</pre>
				<p>Update updates an item&apos;s weight, adds it if it was non-existent or removes it if
the new weight is zero. Note that explicitly updating decreasing weights is not necessary.

				
				
				
			
		
			
			
			<h2 id="WrsItem">type <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/les/utils/weighted_select.go?s=1063:1083#L23">WrsItem</a>
				<a class="permalink" href="index.html#WrsItem">&#xb6;</a>
				
				
			</h2>
			
			<pre>type WrsItem interface{}</pre>

			

			

			
			
			

			

			
		
	

	







<div id="footer">
Build version go1.19.10.<br>
Except as <a href="https://developers.google.com/site-policies#restrictions">noted</a>,
the content of this page is licensed under the
Creative Commons Attribution 3.0 License,
and code is licensed under a <a href="http://localhost:6060/LICENSE">BSD license</a>.<br>
<a href="https://golang.org/doc/tos.html">Terms of Service</a> |
<a href="https://www.google.com/intl/en/policies/privacy/">Privacy Policy</a>
</div>

</div><!-- .container -->
</div><!-- #page -->
</body>
</html>
