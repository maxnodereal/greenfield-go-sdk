<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#375EAB">

  <title>mclock - Go Documentation Server</title>

<link type="text/css" rel="stylesheet" href="../../../../../../lib/godoc/style.css">

<script>window.initFuncs = [];</script>
<script src="../../../../../../lib/godoc/jquery.js" defer></script>



<script>var goVersion = "go1.19.10";</script>
<script src="../../../../../../lib/godoc/godocs.js" defer></script>
</head>
<body>

<div id='lowframe' style="position: fixed; bottom: 0; left: 0; height: 0; width: 100%; border-top: thin solid grey; background-color: white; overflow: auto;">
...
</div><!-- #lowframe -->

<div id="topbar" class="wide"><div class="container">
<div class="top-heading" id="heading-wide"><a href="http://localhost:6060/pkg/">Go Documentation Server</a></div>
<div class="top-heading" id="heading-narrow"><a href="http://localhost:6060/pkg/">GoDoc</a></div>
<a href="index.html#" id="menu-button"><span id="menu-button-arrow">&#9661;</span></a>
<form method="GET" action="http://localhost:6060/search">
<div id="menu">

<span class="search-box"><input type="search" id="search" name="q" placeholder="Search" aria-label="Search" required><button type="submit"><span><!-- magnifying glass: --><svg width="24" height="24" viewBox="0 0 24 24"><title>submit search</title><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/><path d="M0 0h24v24H0z" fill="none"/></svg></span></button></span>
</div>
</form>

</div></div>



<div id="page" class="wide">
<div class="container">


  <h1>
    Package mclock
    <span class="text-muted"></span>
  </h1>







<div id="nav"></div>


<!--
	Copyright 2009 The Go Authors. All rights reserved.
	Use of this source code is governed by a BSD-style
	license that can be found in the LICENSE file.
-->
<!--
	Note: Static (i.e., not template-generated) href and id
	attributes start with "pkg-" to make it impossible for
	them to conflict with generated attributes (some of which
	correspond to Go identifiers).
-->

	<script>
	document.ANALYSIS_DATA = null;
	document.CALLGRAPH = null;
	</script>

	
		
		<div id="short-nav">
			<dl>
			<dd><code>import "github.com/ethereum/go-ethereum/common/mclock"</code></dd>
			</dl>
			<dl>
			<dd><a href="index.html#pkg-overview" class="overviewLink">Overview</a></dd>
			<dd><a href="index.html#pkg-index" class="indexLink">Index</a></dd>
			
			
			</dl>
		</div>
		<!-- The package's Name is printed as title by the top-level template -->
		<div id="pkg-overview" class="toggleVisible">
			<div class="collapsed">
				<h2 class="toggleButton" title="Click to show Overview section">Overview ▹</h2>
			</div>
			<div class="expanded">
				<h2 class="toggleButton" title="Click to hide Overview section">Overview ▾</h2>
				<p>Package mclock is a wrapper for a monotonic clock source

				
			</div>
		</div>

		<div id="pkg-index" class="toggleVisible">
		<div class="collapsed">
			<h2 class="toggleButton" title="Click to show Index section">Index ▹</h2>
		</div>
		<div class="expanded">
			<h2 class="toggleButton" title="Click to hide Index section">Index ▾</h2>

		<!-- Table of contents for API; must be named manual-nav to turn off auto nav. -->
			<div id="manual-nav">
			<dl>
			
			
			
			
				
				<dd><a href="index.html#AbsTime">type AbsTime</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Now">func Now() AbsTime</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#AbsTime.Add">func (t AbsTime) Add(d time.Duration) AbsTime</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#AbsTime.Sub">func (t AbsTime) Sub(t2 AbsTime) time.Duration</a></dd>
				
			
				
				<dd><a href="index.html#ChanTimer">type ChanTimer</a></dd>
				
				
			
				
				<dd><a href="index.html#Clock">type Clock</a></dd>
				
				
			
				
				<dd><a href="index.html#Simulated">type Simulated</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Simulated.ActiveTimers">func (s *Simulated) ActiveTimers() int</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Simulated.After">func (s *Simulated) After(d time.Duration) &lt;-chan AbsTime</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Simulated.AfterFunc">func (s *Simulated) AfterFunc(d time.Duration, fn func()) Timer</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Simulated.NewTimer">func (s *Simulated) NewTimer(d time.Duration) ChanTimer</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Simulated.Now">func (s *Simulated) Now() AbsTime</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Simulated.Run">func (s *Simulated) Run(d time.Duration)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Simulated.Sleep">func (s *Simulated) Sleep(d time.Duration)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#Simulated.WaitForTimers">func (s *Simulated) WaitForTimers(n int)</a></dd>
				
			
				
				<dd><a href="index.html#System">type System</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#System.After">func (c System) After(d time.Duration) &lt;-chan AbsTime</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#System.AfterFunc">func (c System) AfterFunc(d time.Duration, f func()) Timer</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#System.NewTimer">func (c System) NewTimer(d time.Duration) ChanTimer</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#System.Now">func (c System) Now() AbsTime</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="index.html#System.Sleep">func (c System) Sleep(d time.Duration)</a></dd>
				
			
				
				<dd><a href="index.html#Timer">type Timer</a></dd>
				
				
			
			
			</dl>
			</div><!-- #manual-nav -->

		

		
			<h3>Package files</h3>
			<p>
			<span style="font-size:90%">
			
				<a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/common/mclock/mclock.go">mclock.go</a>
			
				<a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/common/mclock/simclock.go">simclock.go</a>
			
			</span>
			</p>
		
		</div><!-- .expanded -->
		</div><!-- #pkg-index -->

		

		
		
		
		
			
			
			<h2 id="AbsTime">type <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/common/mclock/mclock.go?s=1045:1063#L21">AbsTime</a>
				<a class="permalink" href="index.html#AbsTime">&#xb6;</a>
				
				
			</h2>
			<p>AbsTime represents absolute monotonic time.

			<pre>type AbsTime <a href="../../../../../builtin/index.html#int64">int64</a></pre>

			

			

			
			
			

			
				
				<h3 id="Now">func <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/common/mclock/mclock.go?s=1117:1135#L24">Now</a>
					<a class="permalink" href="index.html#Now">&#xb6;</a>
					
					
				</h3>
				<pre>func Now() <a href="index.html#AbsTime">AbsTime</a></pre>
				<p>Now returns the current absolute monotonic time.

				
				
			

			
				
				<h3 id="AbsTime.Add">func (AbsTime) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/common/mclock/mclock.go?s=1208:1253#L29">Add</a>
					<a class="permalink" href="index.html#AbsTime.Add">&#xb6;</a>
					
					
				</h3>
				<pre>func (t <a href="index.html#AbsTime">AbsTime</a>) Add(d <a href="../../../../../time/index.html">time</a>.<a href="../../../../../time/index.html#Duration">Duration</a>) <a href="index.html#AbsTime">AbsTime</a></pre>
				<p>Add returns t + d as absolute time.

				
				
				
			
				
				<h3 id="AbsTime.Sub">func (AbsTime) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/common/mclock/mclock.go?s=1319:1365#L34">Sub</a>
					<a class="permalink" href="index.html#AbsTime.Sub">&#xb6;</a>
					
					
				</h3>
				<pre>func (t <a href="index.html#AbsTime">AbsTime</a>) Sub(t2 <a href="index.html#AbsTime">AbsTime</a>) <a href="../../../../../time/index.html">time</a>.<a href="../../../../../time/index.html#Duration">Duration</a></pre>
				<p>Sub returns t - t2 as a duration.

				
				
				
			
		
			
			
			<h2 id="ChanTimer">type <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/common/mclock/mclock.go?s=1935:2218#L56">ChanTimer</a>
				<a class="permalink" href="index.html#ChanTimer">&#xb6;</a>
				
				
			</h2>
			<p>ChanTimer is a cancellable event created by NewTimer.

			<pre>type ChanTimer interface {
    <a href="index.html#Timer">Timer</a>

    <span class="comment">// The channel returned by C receives a value when the timer expires.</span>
    C() &lt;-chan <a href="index.html#AbsTime">AbsTime</a>
    <span class="comment">// Reset reschedules the timer with a new timeout.</span>
    <span class="comment">// It should be invoked only on stopped or expired timers with drained channels.</span>
    Reset(<a href="../../../../../time/index.html">time</a>.<a href="../../../../../time/index.html#Duration">Duration</a>)
}</pre>

			

			

			
			
			

			

			
		
			
			
			<h2 id="Clock">type <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/common/mclock/mclock.go?s=1507:1684#L40">Clock</a>
				<a class="permalink" href="index.html#Clock">&#xb6;</a>
				
				
			</h2>
			<p>The Clock interface makes it possible to replace the monotonic system clock with
a simulated clock.

			<pre>type Clock interface {
    Now() <a href="index.html#AbsTime">AbsTime</a>
    Sleep(<a href="../../../../../time/index.html">time</a>.<a href="../../../../../time/index.html#Duration">Duration</a>)
    NewTimer(<a href="../../../../../time/index.html">time</a>.<a href="../../../../../time/index.html#Duration">Duration</a>) <a href="index.html#ChanTimer">ChanTimer</a>
    After(<a href="../../../../../time/index.html">time</a>.<a href="../../../../../time/index.html#Duration">Duration</a>) &lt;-chan <a href="index.html#AbsTime">AbsTime</a>
    AfterFunc(d <a href="../../../../../time/index.html">time</a>.<a href="../../../../../time/index.html#Duration">Duration</a>, f func()) <a href="index.html#Timer">Timer</a>
}</pre>

			

			

			
			
			

			

			
		
			
			
			<h2 id="Simulated">type <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/common/mclock/simclock.go?s=1526:1640#L24">Simulated</a>
				<a class="permalink" href="index.html#Simulated">&#xb6;</a>
				
				
			</h2>
			<p>Simulated implements a virtual Clock for reproducible time-sensitive tests. It
simulates a scheduler on a virtual timescale where actual processing takes zero time.
<p>The virtual clock doesn&apos;t advance on its own, call Run to advance it and execute timers.
Since there is no way to influence the Go scheduler, testing timeout behaviour involving
goroutines needs special care. A good way to test such timeouts is as follows: First
perform the action that is supposed to time out. Ensure that the timer you want to test
is created. Then run the clock until after the timeout. Finally observe the effect of
the timeout using a channel or semaphore.

			<pre>type Simulated struct {
    <span class="comment">// contains filtered or unexported fields</span>
}
</pre>

			

			

			
			
			

			

			
				
				<h3 id="Simulated.ActiveTimers">func (*Simulated) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/common/mclock/simclock.go?s=2369:2407#L66">ActiveTimers</a>
					<a class="permalink" href="index.html#Simulated.ActiveTimers">&#xb6;</a>
					
					
				</h3>
				<pre>func (s *<a href="index.html#Simulated">Simulated</a>) ActiveTimers() <a href="../../../../../builtin/index.html#int">int</a></pre>
				<p>ActiveTimers returns the number of timers that haven&apos;t fired.

				
				
				
			
				
				<h3 id="Simulated.After">func (*Simulated) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/common/mclock/simclock.go?s=3325:3382#L111">After</a>
					<a class="permalink" href="index.html#Simulated.After">&#xb6;</a>
					
					
				</h3>
				<pre>func (s *<a href="index.html#Simulated">Simulated</a>) After(d <a href="../../../../../time/index.html">time</a>.<a href="../../../../../time/index.html#Duration">Duration</a>) &lt;-chan <a href="index.html#AbsTime">AbsTime</a></pre>
				<p>After returns a channel which receives the current time after the clock
has advanced by d.

				
				
				
			
				
				<h3 id="Simulated.AfterFunc">func (*Simulated) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/common/mclock/simclock.go?s=3544:3607#L117">AfterFunc</a>
					<a class="permalink" href="index.html#Simulated.AfterFunc">&#xb6;</a>
					
					
				</h3>
				<pre>func (s *<a href="index.html#Simulated">Simulated</a>) AfterFunc(d <a href="../../../../../time/index.html">time</a>.<a href="../../../../../time/index.html#Duration">Duration</a>, fn func()) <a href="index.html#Timer">Timer</a></pre>
				<p>AfterFunc runs fn after the clock has advanced by d. Unlike with the system
clock, fn runs on the goroutine that calls Run.

				
				
				
			
				
				<h3 id="Simulated.NewTimer">func (*Simulated) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/common/mclock/simclock.go?s=3003:3058#L98">NewTimer</a>
					<a class="permalink" href="index.html#Simulated.NewTimer">&#xb6;</a>
					
					
				</h3>
				<pre>func (s *<a href="index.html#Simulated">Simulated</a>) NewTimer(d <a href="../../../../../time/index.html">time</a>.<a href="../../../../../time/index.html#Duration">Duration</a>) <a href="index.html#ChanTimer">ChanTimer</a></pre>
				<p>NewTimer creates a timer which fires when the clock has advanced by d.

				
				
				
			
				
				<h3 id="Simulated.Now">func (*Simulated) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/common/mclock/simclock.go?s=2726:2759#L85">Now</a>
					<a class="permalink" href="index.html#Simulated.Now">&#xb6;</a>
					
					
				</h3>
				<pre>func (s *<a href="index.html#Simulated">Simulated</a>) Now() <a href="index.html#AbsTime">AbsTime</a></pre>
				<p>Now returns the current virtual time.

				
				
				
			
				
				<h3 id="Simulated.Run">func (*Simulated) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/common/mclock/simclock.go?s=2005:2045#L47">Run</a>
					<a class="permalink" href="index.html#Simulated.Run">&#xb6;</a>
					
					
				</h3>
				<pre>func (s *<a href="index.html#Simulated">Simulated</a>) Run(d <a href="../../../../../time/index.html">time</a>.<a href="../../../../../time/index.html#Duration">Duration</a>)</pre>
				<p>Run moves the clock by the given duration, executing all timers before that duration.

				
				
				
			
				
				<h3 id="Simulated.Sleep">func (*Simulated) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/common/mclock/simclock.go?s=2867:2909#L93">Sleep</a>
					<a class="permalink" href="index.html#Simulated.Sleep">&#xb6;</a>
					
					
				</h3>
				<pre>func (s *<a href="index.html#Simulated">Simulated</a>) Sleep(d <a href="../../../../../time/index.html">time</a>.<a href="../../../../../time/index.html#Duration">Duration</a>)</pre>
				<p>Sleep blocks until the clock has advanced by d.

				
				
				
			
				
				<h3 id="Simulated.WaitForTimers">func (*Simulated) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/common/mclock/simclock.go?s=2547:2587#L74">WaitForTimers</a>
					<a class="permalink" href="index.html#Simulated.WaitForTimers">&#xb6;</a>
					
					
				</h3>
				<pre>func (s *<a href="index.html#Simulated">Simulated</a>) WaitForTimers(n <a href="../../../../../builtin/index.html#int">int</a>)</pre>
				<p>WaitForTimers waits until the clock has at least n scheduled timers.

				
				
				
			
		
			
			
			<h2 id="System">type <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/common/mclock/mclock.go?s=2271:2291#L67">System</a>
				<a class="permalink" href="index.html#System">&#xb6;</a>
				
				
			</h2>
			<p>System implements Clock using the system clock.

			<pre>type System struct{}
</pre>

			

			

			
			
			

			

			
				
				<h3 id="System.After">func (System) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/common/mclock/mclock.go?s=2966:3019#L95">After</a>
					<a class="permalink" href="index.html#System.After">&#xb6;</a>
					
					
				</h3>
				<pre>func (c <a href="index.html#System">System</a>) After(d <a href="../../../../../time/index.html">time</a>.<a href="../../../../../time/index.html#Duration">Duration</a>) &lt;-chan <a href="index.html#AbsTime">AbsTime</a></pre>
				<p>After returns a channel which receives the current time after d has elapsed.

				
				
				
			
				
				<h3 id="System.AfterFunc">func (System) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/common/mclock/mclock.go?s=3181:3239#L102">AfterFunc</a>
					<a class="permalink" href="index.html#System.AfterFunc">&#xb6;</a>
					
					
				</h3>
				<pre>func (c <a href="index.html#System">System</a>) AfterFunc(d <a href="../../../../../time/index.html">time</a>.<a href="../../../../../time/index.html#Duration">Duration</a>, f func()) <a href="index.html#Timer">Timer</a></pre>
				<p>AfterFunc runs f on a new goroutine after the duration has elapsed.

				
				
				
			
				
				<h3 id="System.NewTimer">func (System) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/common/mclock/mclock.go?s=2538:2589#L80">NewTimer</a>
					<a class="permalink" href="index.html#System.NewTimer">&#xb6;</a>
					
					
				</h3>
				<pre>func (c <a href="index.html#System">System</a>) NewTimer(d <a href="../../../../../time/index.html">time</a>.<a href="../../../../../time/index.html#Duration">Duration</a>) <a href="index.html#ChanTimer">ChanTimer</a></pre>
				<p>NewTimer creates a timer which can be rescheduled.

				
				
				
			
				
				<h3 id="System.Now">func (System) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/common/mclock/mclock.go?s=2336:2365#L70">Now</a>
					<a class="permalink" href="index.html#System.Now">&#xb6;</a>
					
					
				</h3>
				<pre>func (c <a href="index.html#System">System</a>) Now() <a href="index.html#AbsTime">AbsTime</a></pre>
				<p>Now returns the current monotonic time.

				
				
				
			
				
				<h3 id="System.Sleep">func (System) <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/common/mclock/mclock.go?s=2425:2463#L75">Sleep</a>
					<a class="permalink" href="index.html#System.Sleep">&#xb6;</a>
					
					
				</h3>
				<pre>func (c <a href="index.html#System">System</a>) Sleep(d <a href="../../../../../time/index.html">time</a>.<a href="../../../../../time/index.html#Duration">Duration</a>)</pre>
				<p>Sleep blocks for the given duration.

				
				
				
			
		
			
			
			<h2 id="Timer">type <a href="http://localhost:6060/src/github.com/ethereum/go-ethereum/common/mclock/mclock.go?s=1740:1876#L49">Timer</a>
				<a class="permalink" href="index.html#Timer">&#xb6;</a>
				
				
			</h2>
			<p>Timer is a cancellable event created by AfterFunc.

			<pre>type Timer interface {
    <span class="comment">// Stop cancels the timer. It returns false if the timer has already</span>
    <span class="comment">// expired or been stopped.</span>
    Stop() <a href="../../../../../builtin/index.html#bool">bool</a>
}</pre>

			

			

			
			
			

			

			
		
	

	







<div id="footer">
Build version go1.19.10.<br>
Except as <a href="https://developers.google.com/site-policies#restrictions">noted</a>,
the content of this page is licensed under the
Creative Commons Attribution 3.0 License,
and code is licensed under a <a href="http://localhost:6060/LICENSE">BSD license</a>.<br>
<a href="https://golang.org/doc/tos.html">Terms of Service</a> |
<a href="https://www.google.com/intl/en/policies/privacy/">Privacy Policy</a>
</div>

</div><!-- .container -->
</div><!-- #page -->
</body>
</html>
